/**
 *
 */
package com.infa.dqcloud.pages.profiling;

import com.infa.dqcloud.util.framework.profiling.*;
import io.restassured.response.Response;
import org.openqa.selenium.*;
import org.openqa.selenium.interactions.Actions;
import org.openqa.selenium.support.FindAll;
import org.openqa.selenium.support.FindBy;
import org.openqa.selenium.support.PageFactory;
import org.openqa.selenium.support.ui.ExpectedConditions;
import org.openqa.selenium.support.ui.WebDriverWait;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.testng.Assert;

import java.io.BufferedReader;
import java.io.File;
import java.io.FileReader;
import java.lang.reflect.InvocationTargetException;
import java.nio.file.Files;
import java.nio.file.Paths;
import java.sql.SQLException;
import java.text.SimpleDateFormat;
import java.util.*;
import java.util.NoSuchElementException;
import java.util.Map.Entry;
import java.util.concurrent.TimeUnit;

public class ProfileResultsPage extends PageObjectBase {

    private WebDriver driver;
    private String sourceMethod;
    private String logMessage;
    ValidateBaseLines validateBaseLines = new ValidateBaseLines();
    private ExploreModuleApiUtils exploreModuleApiUtils = new ExploreModuleApiUtils();
    TestDbDetailUtilities testDbDetailUtilities = new TestDbDetailUtilities();
    private Set<String> set = new HashSet<String>();
    private String username = ProfilingConstants.getUsername();
    private String password = ProfilingConstants.getPassword();
    SortedMap<String, SortedMap<String, String>> res = new TreeMap<>();
    SortedMap<String, SortedMap<String, String>> data = new TreeMap<>();
    public Map<String, List<String>> drillDownDataUI = new HashMap<>();
    public Map<String, List<String>> drillDownBaselineMap = new HashMap<>();
    SortedMap<String, String> vChartData = new TreeMap<>();
    public final Logger logger = LoggerFactory.getLogger(ProfileResultsPage.class);

    @FindBy(css = "div.profile-content div.jqx-splitter-collapse-button-horizontal")
    private WebElement threeDotsButtonOnResultsPage;

    @FindBy(css = "div[data-section='grid-results'] span[data-filter-type='view'] select[class='infaField']")
    private WebElement viewDropDownOnResultsPage;

    @FindBy(css = "span[data-run-info='rules']")
    private WebElement noOfRulesInHeader;

    @FindBy(css = "div.frequency-analysis-container span.cp-rule-output-column")
    private WebElement columnDetail1OnValueFrequencyPage;

    @FindBy(css = "div.frequency-analysis-container span.cp-rule-name a")
    private WebElement columnDetail2OnValueFrequencyPage;

    @FindBy(css = "div.frequency-analysis-container span.cp-rule-input-columns")
    private WebElement columnDetail3OnValueFrequencyPage;

    @FindBy(css = "header[class*='shell__page__title'] img[class*='shell__page__title__icon']")
    private WebElement headerProfileIcon;

    @FindBy(css = "span[class='profile-header'] span[class='page-title']")
    private WebElement headerProfileName;

    @FindBy(css = "[data-object-instance-active='true'] [data-run-info='selected']")
    private WebElement headerProfileRunSelected;

    @FindBy(css = "li[data-id='results']")
    private WebElement resultsPageheader;

    @FindBy(css = "[data-object-instance-active='true'] [data-run-info='columns']")
    private WebElement headerProfileColumns;

    @FindBy(css = "[data-object-instance-active='true'] [data-run-info='rules']")
    private WebElement headerProfileRules;

    @FindBy(css = "[data-object-instance-active='true'] [data-run-info='options']")
    private WebElement headerProfileOptions;

    @FindBy(css = "[data-object-instance-active='true'] [data-run-info='start-time']")
    private WebElement headerProfileStartTime;

    @FindBy(css = "[data-object-instance-active='true'] span.infaListbox[data-filter-type='view'] select")
    private WebElement ResultGridView;

    @FindBy(css = "[data-object-instance-active='true'] span.infaListbox[data-run-key] select")
    private WebElement predefinedFiler;

    @FindBy(css = "input[value*='Statistics']")
    private WebElement predefinedFilerEverything;

    @FindBy(css = "input[value*='100% Null']")
    private WebElement predefinedFiler_100Null;

    @FindBy(css = "input[value*='100% Distinct']")
    private WebElement predefinedFiler_100Distinct;

    @FindBy(css = "input[value*='100% Constant']")
    private WebElement predefinedFiler_100Constant;

    @FindBy(css = "input[value*='Conflicting Data Types']")
    private WebElement predefinedFiler_100ConflictingDatatypes;

    @FindBy(css = "button[class*=button--call-to-action]>span")
    private WebElement runButton;

    @FindAll({@FindBy(css = "[data-object-instance-active='true']  div.column-name-col")})
    private List<WebElement> resultColumnList;

    @FindBy(css = "div[data-section='grid-results'] .jqx-scrollbar-thumb-state-normal + div")
    private WebElement resultGridDownScrollbar;

    @FindBy(css = "div[data-section='grid-results'] .jqx-scrollbar-thumb-state-normal-horizontal + div")
    private WebElement resultGridHorizontalScrollbar;

    @FindBy(css = ".row-details-section")
    private WebElement rowDetailsSection;

    @FindBy(css = "div[role='row']:nth-of-type(2)>div.jqx-grid-group-cell:nth-of-type(3)")
    private WebElement firstRowOnResultsPage;

    @FindAll({@FindBy(css = "div[data-grid-col-name='columnName'] span a:nth-of-type(1)")})
    private List<WebElement> resultsGridCols;

    @FindAll({@FindBy(css = "div[data-grid-col-name='columnName']")})
    private List<WebElement> resultsGridColsForValidation;

    @FindAll({@FindBy(css = ".row-details-section div[class*='section__header__container']")})
    private List<WebElement> detailsHeadersCoLS;

    @FindBy(css = "div.frequency-analysis-container button[class*=button--primary] span")
    private WebElement backToSummary;

    @FindAll(@FindBy(css = "table[data-section='trend']  th nobr"))
    private List<WebElement> trendColCols;

    @FindBy(css = "span[data-label='Details']")
    private WebElement detailsTab;

    // @FindAll (@FindBy (css = "table[data-section='trend'] .table__body__cell
    // .table__body__cell__content nobr")) or
    @FindAll(@FindBy(css = "table[data-section='trend'] span[class*=table__body__cell__content] nobr"))
    private List<WebElement> trendColDataTrendCol1;

    @FindAll(@FindBy(css = "table[data-section='trend'] span[class*=table__body__cell__content] nobr span"))
    private List<WebElement> trendNullDistinctCols;

    // @FindAll(@FindBy (css = "table[data-section='trend'] .table__body__cell
    // .table__body__cell__content circle")) or
    @FindAll(@FindBy(css = "table[data-section='trend'] span[class*=table__body__cell__content] circle"))
    private List<WebElement> trendColDataTrendCol2;

    @FindAll(@FindBy(css = "table[data-section='trend'] td[class*=table__body__cell]:nth-of-type(3) span span"))
    private List<WebElement> trendColDataTrendCol3;

    @FindAll(@FindBy(css = "table[data-section='trend'] span[class*=table__body__cell__content] circle[cx='5']"))
    private List<WebElement> trendRerunFirstDot;

    @FindAll(@FindBy(css = "table[data-section='trend'] span[class*=table__body__cell__content] circle[cx='30']"))
    private List<WebElement> trendRerunSecondDot;

    @FindAll(@FindBy(css = "table[data-section='trend'] span[class*=table__body__cell__content] circle[cx='55']"))
    private List<WebElement> trendRerunThirdDot;

    @FindAll(@FindBy(css = "table[data-section='trend'] span[class*=table__body__cell__content] path"))
    private List<WebElement> trendColDataTrendColsecondRerun;

    @FindAll(@FindBy(css = "div[class='row-details-section'] h1[class*=section__header__container]"))
    private List<WebElement> detailsSectionHeaders;

    @FindAll(@FindBy(css = "div[class*=section__header__container] i[class*=section__header__toggle-expansion-icon--expanded]"))
    private List<WebElement> detailsSectionHeadersExpand;

    @FindAll(@FindBy(css = "[data-section='datatypes'] td span span"))
    private List<WebElement> dataTypeDetailsData;

    /*
     * @FindAll(@FindBy(css
     * ="[data-object-instance-active='true'] [data-section='fa-detail-grid'] table tr.d-table__body__row td span"
     * )) private List<WebElement> valueFrequencyData;
     */

    @FindAll(@FindBy(css = "[data-section='datatypes'] div[style*='width']"))
    private List<WebElement> detailsTabDataTypeBarChart;

    @FindAll(@FindBy(css = "[data-section='patterns'] td span span"))
    private List<WebElement> patternsDetailsData;

    @FindAll(@FindBy(css = "[data-section='patterns'] div[style*='width']"))
    private List<WebElement> detailsTabPatternsBarChart;

    @FindAll(@FindBy(css = "[data-section='most-frequent-values'] td span span"))
    private List<WebElement> mostFreqValuesDetailsData;

    @FindAll(@FindBy(css = "[data-section='most-frequent-values'] td:nth-child(1) span"))
    private List<WebElement> mostFreqOnlyValues;

    @FindAll(@FindBy(css = "div[data-section='fa-detail-grid'] td[class*=table__body__cell]:nth-child(4) span"))
    private List<WebElement> valueFrquenciesOnLeftPane;

    /*
     * @FindAll(@FindBy(css = "[data-section='least-frequent-values'] td span"))
     * private List<WebElement> leastFreqValuesDetailsData;
     */

    @FindAll(@FindBy(css = "[data-section='top'] td span"))
    private List<WebElement> topData;

    @FindAll(@FindBy(css = "[data-section='bottom'] td span"))
    private List<WebElement> bottomData;

    @FindAll(@FindBy(css = "[data-section='numeric-details'] td span span"))
    private List<WebElement> numericColumnDetailsData;

    @FindAll(@FindBy(css = "span[class*=table__body__cell__content] circle"))
    private List<WebElement> trendGraphHoverText;

    @FindAll(@FindBy(css = "table[data-section='datatypes'] td"))
    private List<WebElement> detailsPageDataTypesHoverText;

    @FindAll(@FindBy(css = "table[data-section='patterns'] td"))
    private List<WebElement> detailsPagePatternsHoverText;

    @FindAll(@FindBy(css = "table[data-section='most-frequent-values'] td[class*=table__body__cell]"))
    private List<WebElement> detailsPageMostFreqValuesHoverText;

    @FindAll(@FindBy(css = "table[data-section='least-frequent-values'] td[class*=table__body__cell]"))
    private List<WebElement> detailsPageLeastFreqValuesHoverText;

    @FindAll(@FindBy(css = "[data-section='grid-results'] .infaTableGrid-column-header-content"))
    private List<WebElement> profResultsGridHorizontalCols;

    @FindAll(@FindBy(css = "[data-grid-col-name='columnName']"))
    private List<WebElement> profiledCols;

    @FindBy(css = "div[data-section='grid-results'] .jqx-rc-t + div")
    private WebElement resultsGridVerticalScrollBarup;

    @FindBy(css = "div[data-section='grid-results'] .jqx-rc-l + div")
    private WebElement resultsGridHorizontalScrollBarLeft;

    @FindBy(css = "div[data-section='grid-results'] .jqx-scrollbar-thumb-state-normal")
    private WebElement resultGridVScrollbar;

    @FindBy(css = ".infaPanelTitle div[data-btn-name='managerules'] .infaButton-label")
    private WebElement manageRuleButton;

    @FindBy(css = "[data-btn-name='managerules'] button")
    private WebElement manageRulesButton;

    @FindBy(css = "button[data-id='add-rule-btn']")
    private WebElement addRulesButton;

    @FindBy(css = ".infaTableButtonSet div:nth-child(2) button[title='Delete']")
    private WebElement deleteRulesButton;

    @FindAll(@FindBy(css = ".ui-dialog .jqx-grid-cell-pinned span"))
    private List<WebElement> rulesGrid;

    @FindBy(css = "#OK4")
    private WebElement selectButton;

    // @FindAll(@FindBy(css = "tr.d-table__body__row td:nth-child(2) span"))
    @FindAll(@FindBy(css = ".ui-dialog-content tr[class*=table__body__row] td:nth-child(3) span>span"))
    private List<WebElement> ruleColsAssociateGrid;

    @FindBy(css = ".ui-dialog-content .infaTableGrid-checkboxes .jqx-scrollbar-thumb-state-normal")
    private WebElement rulesSelectVerticalScroll;

    // @FindAll(@FindBy(css = "tr.d-table__body__row input[type='checkbox']"))
    @FindAll(@FindBy(css = ".ui-dialog-content tr[class*=table__body__row] input[type='checkbox']"))
    private List<WebElement> rulesColsCheckboxRules;

    @FindAll(@FindBy(css = ".ui-dialog-buttonset .infaButton  span"))
    private List<WebElement> uiDialogueButtons;

    @FindBy(css = "div[class*='toolbar__content'] button[class*='button--primary']")
    private WebElement save;

    @FindBy(css = ".ui-dialog [placeholder='Find']")
    private WebElement rulesPageColsFindBox;

    @FindBy(css = "[data-section='grid-results'] input[placeholder='Find']")
    private WebElement resultsPageColsFindBox;

    @FindAll(@FindBy(css = "[data-section='row-details'] li span"))
    private List<WebElement> rowDetailsTabs;

    @FindAll(@FindBy(css = "div[class*=cp-result-rule-section] h1[class*=section__header__container]"))
    private List<WebElement> rulesTabHeaders;

    @FindAll(@FindBy(css = ".cp-result-rule-section>div[class*='section__content'] div[class*=section__content] tbody>tr>td:nth-of-type(1)"))
    private List<WebElement> rulesDetailsTabResultsLabel;

    @FindAll(@FindBy(css = ".cp-result-rule-section>div[class*='section__content'] div[class*=section__content] tbody>tr>td:nth-of-type(2)"))
    private List<WebElement> rulesDetailsTabResultsData;

    @FindBy(css = "button[class*='button--call-to-action'] i[class*='cp-pageheader-action-menu-icon']")
    private WebElement optionsButton;

    @FindAll(@FindBy(css = "ul[class*='menu'] li"))
    private List<WebElement> optionsMenu;

    @FindBy(css = "div.jqx-grid-empty-cell>span")
    private WebElement noDataToDisplayText;

    @FindBy(css = "[data-object-instance-active='true'] tbody>tr>td:nth-of-type(3)>span span:nth-of-type(1)")
    private List<WebElement> profileResultListWithRule;

    @FindBy(css = "[data-object-instance-active='true'] tbody>tr>td:nth-of-type(3)>span span:nth-of-type(2)")
    private List<WebElement> profileResultWithRuleInputColumns;

    @FindBy(css = "div[class*='shell__page__content']>div>ul>li[data-id='rules']>span")
    private WebElement rulesTab;

    // ScheduleTab
    @FindBy(css = "div.profile-content>ul>li[data-id='schedule']")
    private WebElement scheduleTab;

    private String backToSummary_css = "div.frequency-analysis-container button[class*=button--primary] span";

    @FindAll(@FindBy(css = "[data-notify='message']"))
    private List<WebElement> notificationMessages;

    @FindAll(@FindBy(css = "[data-section='datatypes'] input[type='checkbox']"))
    private List<WebElement> inferredDataTypesCheckboxes;

    @FindAll(@FindBy(css = "div[class*=bubble] div[class*=menu__item] [type='checkbox']"))
    private List<WebElement> drillDownDropDownCheckboxes;

    @FindAll(@FindBy(css = "div[class*=bubble] div[class*=menu__item] label"))
    private List<WebElement> drillDownDropDownLabels;

    @FindAll(@FindBy(css = "div[class*='filter__pills']>div[class*=pill]"))
    private List<WebElement> drillDownDropDownsList;

    @FindAll(@FindBy(css = "div[class*=pill] i[class*=pill__menu]"))
    private List<WebElement> drillDownDropDown;

    @FindAll(@FindBy(css = "[data-section='patterns'] input[type='checkbox']"))
    private List<WebElement> patternsCheckboxes;

    @FindAll(@FindBy(css = "[data-section='fa-detail-grid'] input[type='checkbox']"))
    private List<WebElement> valueFrequencyCheckboxes;

    @FindAll(@FindBy(css = "[data-section='datatypes'] tr td:nth-child(2) span span"))
    private List<WebElement> inferredDataTypesData;
    
    @FindBy(css = "div[class='row-details-section'] table[data-section='trend'] th:nth-of-type(1)")
    private WebElement trendSection;

    @FindAll(@FindBy(css = "[data-section='patterns'] tr td:nth-child(2) span span"))
    private List<WebElement> patternsDataS;

    @FindAll(@FindBy(css = "[data-section='fa-detail-grid'] tr td span"))
    private List<WebElement> valueFrequencyData;

    @FindAll(@FindBy(css = "[data-section='queries'] button"))
    private List<WebElement> drillDownButtons;

    @FindBy(css = "[data-section='queries'] button[class*=button--primary]")
    private WebElement drillDownApplyButton;

    // @FindBy(css = ".cp-result-rule-section .d-toolbar__content>button>img")
    @FindBy(css = ".cp-result-rule-section .d-toolbar__content>button>img")
    private WebElement rulesSubTabAddRuleButton;

    @FindBy(css = ".infa-tabsPanelPadding[aria-expanded='true']:nth-child(4) .d-section__content")
    private WebElement rulesSubTabtext;

    @FindBy(css = "[data-section='queries'] .cp-close-filter-icon")
    private WebElement drillDownXButton;

    @FindBy(css = "[data-section='queries'] div[class*=section__header] button[class*=icon-button][data-id='hide-filter-query']")
    private WebElement drillDownClearButton;

    @FindAll(@FindBy(css = "[data-section='queries'] .cp-query-data-table tr"))
    private List<WebElement> drillDownResultsRows;

    @FindAll(@FindBy(css = "[data-section='queries'] .cp-query-data-table th span span"))
    private List<WebElement> drillDownResultsHeader;

    @FindAll(@FindBy(css = "[data-section='queries'] .cp-query-data-table tr td span"))
    private List<WebElement> drillDownResultsData;

    @FindBy(css = "div[class*=loader__spinner]")
    private WebElement loaderSpinner;

    @FindBy(css = "button[data-testid='cancel'] span")
    private WebElement chooseProfileCancelButton;

    @FindBy(css = ".cp-run-chooser table tr[class*='table__body__row']")
    private List<WebElement> listOfProfileRuns;

    @FindBy(css = "button[data-button-name='select'] span")
    private WebElement chooseRunSelectButton;

    @FindAll(@FindBy(css = "[data-section='patterns'] tr td:nth-child(3) span span"))
    private List<WebElement> patternsData;

    @FindAll({@FindBy(css = "[data-section='queries'] tbody[class*=table__body]")})
    private WebElement tableDetailsGrid;

    @FindBy(css = "[data-section='queries'] div[class*=section__header] button[class*=icon-button]:nth-child(2)")
    private WebElement drillDownTableSettingsButton;

    @FindBy(css = "span.sorted-ascending img")
    private WebElement sortColumnsButton;

    @FindAll({@FindBy(css = "div.infaTableGrid-column-header-content")})
    private List<WebElement> headers;

    @FindBy(css = ".cp-profile-export-dialog input[name='fileName']")
    private WebElement exportProfileResultFileName;
    
    @FindBy(css = ".cp-profile-export-dialog button[class*=button--primary]")
    private WebElement exportProfileResult;
    
    @FindBy(css = ".cp-profile-export-dialog button[class*=button--secondary]")
    private WebElement cancelExportProfileResult;

    @FindAll({@FindBy(css = ".cp-profile-export-dialog small[class*=form__error]")})
    private List<WebElement> errorMessageExportProfileResult;

    @FindBy(css = "input[value ='SELECTED_COLUMNS']")
    private WebElement exportProfileResultSelectedColRange;

    @FindBy(css = "input[value ='ALL_COLUMNS']")
    private WebElement exportProfileResultAllColRange;

    @FindAll({@FindBy(css = ".cp-profile-export-dialog input[type='checkbox']")})
    private List<WebElement> exportProfileResultScope;

    @FindBy(css = "span[data-notify='message']")
    private WebElement notificationMessage;

    public WebElement getExportProfileResultSelectedColRange() {
        return exportProfileResultSelectedColRange;
    }

    @FindBy(css = "li[data-id='definition']")
    private WebElement definitionTab;

    @FindBy(css = "[data-run-info='status']>a")
    private WebElement profileRunMonitorLink;

    @FindBy(css = "div.cp-datapreview-pane button[data-id='cp-datapreview-minimize']")
    private WebElement dataPreviewMinimizeButton;

    @FindBy(css = "div.cp-datapreview-pane button[data-id='cp-datapreview-restore']")
    private WebElement dataPreviewRestoreButton;

    @FindBy(css = "div.cp-datapreview-pane button[data-id='cp-datapreview-maximize']")
    private WebElement dataPreviewMaximizeButton;

    @FindBy(css = "div.frequency-analysis-container div[class*='table__body__empty-message']")
    private WebElement valueFreqNoDataToDisplay;

    @FindBy(css = "table[data-section='most-frequent-values'] div[class*='table__body__empty-message']")
    private WebElement mostFreqValueNoDataToDisplay;
    
    @FindBy(css = "table[data-id='result-table'] div[class*='table__body__empty-message']")
    private WebElement resultsGridNoDataToDisplay;

    @FindBy(css = "th[data-id='columnName']")
    private WebElement columnNameHeader;

    @FindAll({@FindBy(css = "div[data-testid='dropdown-menu'] span")})
    private List<WebElement> listOfOptionsInTheDropdown;
    
	@FindBy(css = "span[class='non-unique-color']")
    private WebElement nonUniqueColor;
    
    @FindBy(css = "span[class='unique-color']")
    private WebElement uniqueColor;
    
	@FindBy(css="table[data-section='datatypes'] td[data-q-title='Documented Data Type'] i[class*='aicon__small_help']")
	private WebElement documentedDataTypeToolTip;
	
	@FindBy(css="div[class*='bubble--top']")
	private WebElement toolTipMessage;
	
	@FindBy(css="div[data-section='grid-results'] i[class*='aicon__close-solid link']")
	private WebElement clearButtonOfFindTextBox;
	
	@FindBy(css="span[class='cp-path-selector'] button[class*='button--secondary']")
	private WebElement treePreviewer;
	
    @FindAll({@FindBy(css = "div[class*='tree__node'] span[class*='tree__node__name']")})
    private List<WebElement> nodeNamesInTreePreviewer;
    
	@FindBy(css="div[class='cp-results-view-menu'] button[class*='button--primary']")
	private WebElement viewButtonOfTreePreviewer;
	
	@FindBy(css="div[class='cp-results-view-menu'] button[data-id='expand-list']")
	private WebElement expandIconInTreePreviewer;
	
	@FindBy(css="div[class='cp-results-view-menu'] button[data-id='collapse-list']")
	private WebElement collapseIconInTreePreviewer;
	
	@FindBy(css="div[class='cp-results-view-menu'] input[placeholder='Find Segment']")
	private WebElement findTextAreaInTreePreviewer;
	
	@FindAll({@FindBy(css = "td[data-id='columnName'] a[href] span")})
    private List<WebElement> folderNamesInResultsGrid;
	
	@FindAll({@FindBy(css = "div[data-dialog-name='profile-result-export-dialog'] label[class='form__label']")})
    private List<WebElement> optionsAvailableInExportProfileResultsDialogBox;
	
	@FindAll({@FindBy(css = "div[class*='cp-path-selector-panel'] ul[aria-label='Breadcrumb'] a")})
    private List<WebElement> listOfSegmentsInTheBreadcrumbs;
	
	@FindBy(css="div[class*='cp-path-selector-panel'] i[class*='aicon__chevron-left']")
	private WebElement backButtonInNavigationToolbar;
	
	@FindBy(xpath = "/span[@data-run-info='execution-warning']//img")
	private List<WebElement> warningMessage;
	
	@FindBy(xpath = "//table[@class='d-table']/tbody[@class='d-table__body']/tr")
	private List<WebElement> columnTableFreqPair;
	
	String noOfItems = "(//select[contains(@class,'select')])[last()]";
    String ruleOrCleanseOrVerifierNameOnProfileResultsPage = "(//span[text()='Input Columns: #COLUMNNAME#']//ancestor::div[@role='row']//following-sibling::div[@role='row']//a[@title='#RULEORCLEANSENAME#'])[1]";
    String ruleIcon = "//div[@data-column-name='#COLUMNNAME#']//img";
    String rowDataValues = "//div[@data-section='grid-results']//tr[#i#]/td[contains(@class,'table__body__cell') and @data-id='#CELLNAME#']/span/span";
    String rowDataValuesForLastSixElements = "//div[@data-section='grid-results']//tr[#i#]/td[contains(@class,'table__body__cell') and @data-id='#CELLNAME#']/span";
    String expandIconForNodesInTreePreviewer="//span[text()='#NODENAME#']//ancestor::div[contains(@class,'preview-tree__node__container')]//i[@data-testid='switcher']";
    /**
     * Getters And Setters Section
     *
     */
    String dropdownButtonForView = "(//div[@data-testid='dropdown-bar'])[1]//button";
    String dropdownButtonForWith = "(//div[@data-testid='dropdown-bar'])[2]//button";
    String allSegmentsOrParticularNodeButton="//div[contains(@class,'cp-path-selector-panel')]//a[text()='#NODENAME#']";
    
	public WebElement getBackButtonInNavigationToolbar() {
		return backButtonInNavigationToolbar;
	}

	public void setBackButtonInNavigationToolbar(WebElement backButtonInNavigationToolbar) {
		this.backButtonInNavigationToolbar = backButtonInNavigationToolbar;
	}
	
	public WebElement getResultsGridNoDataToDisplay() {
		return resultsGridNoDataToDisplay;
	}

	public void setResultsGridNoDataToDisplay(WebElement resultsGridNoDataToDisplay) {
		this.resultsGridNoDataToDisplay = resultsGridNoDataToDisplay;
	}
    
    public List<WebElement> getListOfSegmentsInTheBreadcrumbs() {
        return listOfSegmentsInTheBreadcrumbs;
    }

    public void setListOfSegmentsInTheBreadcrumbs(List<WebElement> listOfSegmentsInTheBreadcrumbs) {
        this.listOfSegmentsInTheBreadcrumbs = listOfSegmentsInTheBreadcrumbs;
    }
    
    public List<WebElement> getOptionsAvailableInExportProfileResultsDialogBox() {
        return optionsAvailableInExportProfileResultsDialogBox;
    }

    public void setOptionsAvailableInExportProfileResultsDialogBox(List<WebElement> optionsAvailableInExportProfileResultsDialogBox) {
        this.optionsAvailableInExportProfileResultsDialogBox = optionsAvailableInExportProfileResultsDialogBox;
    }
       
	public WebElement getFindTextAreaInTreePreviewer() {
		return findTextAreaInTreePreviewer;
	}

	public void setFindTextAreaInTreePreviewer(WebElement findTextAreaInTreePreviewer) {
		this.findTextAreaInTreePreviewer = findTextAreaInTreePreviewer;
	}
	   
	public WebElement getViewButtonOfTreePreviewer() {
		return viewButtonOfTreePreviewer;
	}

	public void setViewButtonOfTreePreviewer(WebElement viewButtonOfTreePreviewer) {
		this.viewButtonOfTreePreviewer = viewButtonOfTreePreviewer;
	}
	
	public WebElement getExpandIconInTreePreviewer() {
		return expandIconInTreePreviewer;
	}

	public void setExpandIconInTreePreviewer(WebElement expandIconInTreePreviewer) {
		this.expandIconInTreePreviewer = expandIconInTreePreviewer;
	}
    
	public WebElement getCollapseIconInTreePreviewer() {
		return collapseIconInTreePreviewer;
	}

	public void setCollapseIconInTreePreviewer(WebElement collapseIconInTreePreviewer) {
		this.collapseIconInTreePreviewer = collapseIconInTreePreviewer;
	}
	
    public List<WebElement> getFolderNamesInResultsGrid() {
        return folderNamesInResultsGrid;
    }

    public void setFolderNamesInResultsGrid(List<WebElement> folderNamesInResultsGrid) {
        this.folderNamesInResultsGrid = folderNamesInResultsGrid;
    }
    
	public WebElement getTreePreviewer() {
		return treePreviewer;
	}

	public void setTrendSection(WebElement trendSection) {
		this.trendSection = trendSection;
	}
	
	public WebElement getTrendSection() {
		return trendSection;
	}

	public void setTreePreviewer(WebElement treePreviewer) {
		this.treePreviewer = treePreviewer;
	}
	
    public List<WebElement> getNodeNamesInTreePreviewer() {
        return nodeNamesInTreePreviewer;
    }

    public void setNodeNamesInTreePreviewer(List<WebElement> nodeNamesInTreePreviewer) {
        this.nodeNamesInTreePreviewer = nodeNamesInTreePreviewer;
    }
    
	public WebElement getClearButtonOfFindTextBox() {
		return clearButtonOfFindTextBox;
	}

	public void setClearButtonOfFindTextBox(WebElement clearButtonOfFindTextBox) {
		this.clearButtonOfFindTextBox = clearButtonOfFindTextBox;
	}
    
	public WebElement getToolTipMessage() {
		return toolTipMessage;
	}

	public void setToolTipMessage(WebElement toolTipMessage) {
		this.toolTipMessage = toolTipMessage;
	}

	public WebElement getDocumentedDataTypeToolTip() {
		return documentedDataTypeToolTip;
	}

	public void setDocumentedDataTypeToolTip(WebElement documentedDataTypeToolTip) {
		this.documentedDataTypeToolTip = documentedDataTypeToolTip;
	}
    
	public WebElement getNonUniqueColor() {
		return nonUniqueColor;
	}

	public void setNonUniqueColor(WebElement nonUniqueColor) {
		this.nonUniqueColor = nonUniqueColor;
	}

	public WebElement getUniqueColor() {
		return uniqueColor;
	}

	public void setUniqueColor(WebElement uniqueColor) {
		this.uniqueColor = uniqueColor;
	}
    public List<WebElement> getListOfOptionsInTheDropdown() {
        return listOfOptionsInTheDropdown;
    }

    public void setListOfOptionsInTheDropdown(List<WebElement> listOfOptionsInTheDropdown) {
        this.listOfOptionsInTheDropdown = listOfOptionsInTheDropdown;
    }

    public WebElement getColumnNameHeader() {
        return columnNameHeader;
    }

    public void setColumnNameHeader(WebElement columnNameHeader) {
        this.columnNameHeader = columnNameHeader;
    }

    public void setThreeDotsButtonOnResultsPage(WebElement threeDotsButtonOnResultsPage) {
        this.threeDotsButtonOnResultsPage = threeDotsButtonOnResultsPage;
    }

    public List<WebElement> getResultsGridColsForValidation() {
        return resultsGridColsForValidation;
    }

    public void setResultsGridColsForValidation(List<WebElement> resultsGridColsForValidation) {
        this.resultsGridColsForValidation = resultsGridColsForValidation;
    }

    public WebElement getValueFreqNoDataToDisplay() {
        return valueFreqNoDataToDisplay;
    }

    public void setValueFreqNoDataToDisplay(WebElement valueFreqNoDataToDisplay) {
        this.valueFreqNoDataToDisplay = valueFreqNoDataToDisplay;
    }

    public WebElement getMostFreqValueNoDataToDisplay() {
        return mostFreqValueNoDataToDisplay;
    }

    public void setMostFreqValueNoDataToDisplay(WebElement mostFreqValueNoDataToDisplay) {
        this.mostFreqValueNoDataToDisplay = mostFreqValueNoDataToDisplay;
    }

    public WebElement getThreeDotsButtonOnResultsPage() {
        return threeDotsButtonOnResultsPage;
    }

    public void setExportProfileResultSelectedColRange(WebElement exportProfileResultSelectedColRange) {
        this.exportProfileResultSelectedColRange = exportProfileResultSelectedColRange;
    }

    public WebElement getExportProfileResultAllColRange() {
        return exportProfileResultAllColRange;
    }

    public void setExportProfileResultAllColRange(WebElement exportProfileResultAllColRange) {
        this.exportProfileResultAllColRange = exportProfileResultAllColRange;
    }

    public List<WebElement> getExportProfileResultScope() {
        return exportProfileResultScope;
    }

    public void setExportProfileResultScope(List<WebElement> exportProfileResultScope) {
        this.exportProfileResultScope = exportProfileResultScope;
    }

    public List<WebElement> getErrorMessageExportProfileResult() {
        return errorMessageExportProfileResult;
    }

    public void setErrorMessageExportProfileResult(List<WebElement> errorMessageExportProfileResult) {
        this.errorMessageExportProfileResult = errorMessageExportProfileResult;
    }

    public WebElement getCancelExportProfileResult() {
        return cancelExportProfileResult;
    }

    public void setCancelExportProfileResult(WebElement cancelExportProfileResult) {
        this.cancelExportProfileResult = cancelExportProfileResult;
    }
    
    public WebElement getExportProfileResult() {
        return exportProfileResult;
    }

    public void setExportProfileResult(WebElement exportProfileResult) {
        this.exportProfileResult = exportProfileResult;
    }
 
    public WebElement getExportProfileResultFileName() {
        return exportProfileResultFileName;
    }

    public void setExportProfileResultFileName(WebElement exportProfileResultFileName) {
        this.exportProfileResultFileName = exportProfileResultFileName;
    }

    public List<WebElement> getDrillDownDropDownCheckboxes() {
        return drillDownDropDownCheckboxes;
    }

    public List<WebElement> getDrillDownDropDownLabels() {
        return drillDownDropDownLabels;
    }

    public List<WebElement> getDrillDownDropDownsList() {
        return drillDownDropDownsList;
    }

    public List<WebElement> getDrillDownDropDown() {
        return drillDownDropDown;
    }

    public WebElement getChooseRunSelectButton() {
        return chooseRunSelectButton;
    }

    public WebElement getSortColumnsButton() {
        return sortColumnsButton;
    }

    public void setSortColumnsButton(WebElement sortColumnsButton) {
        this.sortColumnsButton = sortColumnsButton;
    }

    public WebElement getNoOfRulesInHeader() {
        return noOfRulesInHeader;
    }

    public void setNoOfRulesInHeader(WebElement noOfRulesInHeader) {
        this.noOfRulesInHeader = noOfRulesInHeader;
    }

    public WebElement getTableDetailsGrid() {
        return tableDetailsGrid;
    }

    public List<WebElement> getInferredDataTypesData() {
        return inferredDataTypesData;
    }

    public List<WebElement> getPatternsDataS() {
        return patternsDataS;
    }

    public List<WebElement> getValueFrequencyData() {
        return valueFrequencyData;
    }


    public ProfileResultsPage(WebDriver driver) {
        super(driver, By.cssSelector(".infaPage.activePage"));
        this.driver = driver;
        PageFactory.initElements(this.driver, this);
    }

    public WebElement getChooseProfileCancelButton() {
        return chooseProfileCancelButton;
    }

    public List<WebElement> getListOfProfileRuns() {
        return listOfProfileRuns;
    }

    public List<WebElement> getPatternsData() {
        return patternsData;
    }

    public WebElement getDrillDownClearButton() {
        return drillDownClearButton;
    }

    public WebElement getDrillDownXButton() {
        return drillDownXButton;
    }


    public ProfileResultsPage findTheColumn(String columnName) {
        try {
            waitForElementToBeclickable(getRulesPageColsFindBox());
        } catch (Exception e) {
        }
        waitForElement(getRulesPageColsFindBox(), "Find Input");
        getRulesPageColsFindBox().sendKeys(columnName);
        funcWait(2000);
        return this;
    }

    public ProfileResultsPage findTheColumnForFrequency(String columnName) {
            waitForElementToBeclickable(getResultsPageColsFindBox());
            waitForElement(getResultsPageColsFindBox(), "Find Input");
            driver.manage().timeouts().implicitlyWait(8,TimeUnit.SECONDS);
            try {
            	getClearButtonOfFindTextBox().click();
            }catch(Exception e) {
            	logger.info("Clear button is not visible. Hence, Moving Ahead.");
            }finally {
            	if (!System.getProperty("exec.args").contains("DEV")){
        			driver.manage().timeouts().implicitlyWait(300,TimeUnit.SECONDS);
        			driver.manage().timeouts().pageLoadTimeout(160, TimeUnit.SECONDS);
        			driver.manage().timeouts().setScriptTimeout(60, TimeUnit.SECONDS);
        		}else{
        			driver.manage().timeouts().implicitlyWait(400,TimeUnit.SECONDS);
        			driver.manage().timeouts().pageLoadTimeout(400, TimeUnit.SECONDS);
        			driver.manage().timeouts().setScriptTimeout(60, TimeUnit.SECONDS);
        		}
            }
            enterValueInto(getResultsPageColsFindBox(), columnName);
            invisibilityOfElementOfGivenSelectorWithTimeout(15, "div[data-section='grid-results'] div[class*='loader__message']");

        return this;
    }

    public ProfileResultsPage clearFindColumn() {
        waitForElementToBeclickable(getRulesPageColsFindBox());
        getRulesPageColsFindBox().clear();
        invisibilityOfElementOfGivenSelectorWithTimeout(15, "div[data-section='grid-results'] div[class*='loader__message']");
        return this;
    }

    public ProfileResultsPage clearFindColumnResultsPage() {
        waitForElementToBeclickable(getResultsPageColsFindBox());
        getResultsPageColsFindBox().clear();
        invisibilityOfElementOfGivenSelectorWithTimeout(15, "div[data-section='grid-results'] div[class*='loader__message']");
        return this;
    }

    public ColumnValuesFrequencyPage naviagteToColumn(String col) {
        ColumnValuesFrequencyPage columnValuesFrequencyPage = null;
        WaitForObjectToVanish(".blockUI img");
        boolean flag = false;
        while (!flag) {
            try {
                List<WebElement> list = getResultsGridCols();
                for (WebElement ele : list) {
                    String gridColName = ele.getText();
                    if (gridColName.equals(col)) {
                        ele.click();
                        flag = true;
                        break;
                    }
                }
                flag = getElementFromCssStringColumnValueFrequency(backToSummary_css).isDisplayed();
            } catch (Exception e) {
            }
        }
        columnValuesFrequencyPage = new ColumnValuesFrequencyPage(driver);
        return columnValuesFrequencyPage;
    }

    public WebElement getDefinitionTab() {
        return definitionTab;
    }

    public WebElement getProfileRunMonitorLink() {
        return profileRunMonitorLink;
    }

    public WebElement getScheduleTab() {
        return scheduleTab;
    }

    public void setScheduleTab(WebElement scheduleTab) {
        this.scheduleTab = scheduleTab;
    }

    public WebElement getDeleteRulesButton() {
        return deleteRulesButton;
    }

    public List<WebElement> getRulesDetailsTabResultsLabel() {
        return rulesDetailsTabResultsLabel;
    }

    public List<WebElement> getRulesDetailsTabResultsData() {
        return rulesDetailsTabResultsData;
    }

    public List<WebElement> getRulesTabHeaders() {
        return rulesTabHeaders;
    }

    public List<WebElement> getRowDetailsTabs() {
        return rowDetailsTabs;
    }

    public WebElement getRulesPageColsFindBox() {
        return rulesPageColsFindBox;
    }

    public WebElement getResultsPageColsFindBox() {
        return resultsPageColsFindBox;
    }

    public WebElement getSave() {
        return save;
    }

    public WebElement getRunButton() {
        return runButton;
    }

    public List<WebElement> getUiDialogueButtons() {
        return uiDialogueButtons;
    }

    public List<WebElement> getRulesColsCheckboxRules() {
        return rulesColsCheckboxRules;
    }

    public WebElement getRulesSelectVerticalScroll() {
        return rulesSelectVerticalScroll;
    }

    public List<WebElement> getRuleColsAssociateGrid() {
        return ruleColsAssociateGrid;
    }

    public WebElement getSelectButton() {
        return selectButton;
    }

    public List<WebElement> getRulesFromGrid() {
        return rulesGrid;
    }

    public WebElement getAddRulesButton() {
        return addRulesButton;
    }

    public WebElement getRulesTab() {
        return rulesTab;
    }

    public List<WebElement> getvalueFrquenciesOnLeftPane() {
        return valueFrquenciesOnLeftPane;
    }

    public List<WebElement> getMostFrequentOnlyValues() {
        return mostFreqOnlyValues;
    }

    public void setMostFrequentOnlyValues(List<WebElement> mostFrequentOnlyValues) {
        this.mostFreqOnlyValues = mostFrequentOnlyValues;
    }

    public List<WebElement> getHeaders() {
        return headers;
    }

    public void setHeaders(List<WebElement> headers) {
        this.headers = headers;
    }

    public void setValueFrequenciesOnLeftPane(List<WebElement> valueFrquenciesOnLeftPane) {
        this.valueFrquenciesOnLeftPane = valueFrquenciesOnLeftPane;
    }

    public void setRunButton(WebElement runButton) {
        this.runButton = runButton;
    }

    public void setRulesTab(WebElement rulesTab) {
        this.rulesTab = rulesTab;
    }

    public void setAddRulesButton(WebElement addRulesButton) {
        this.addRulesButton = addRulesButton;
    }

    public WebElement getManageRulesButton() {
        return manageRulesButton;
    }

    public WebElement getManageRuleButton() {
        return manageRuleButton;
    }

    public WebElement getResultsGridVerticalScrollBarup() {
        return resultsGridVerticalScrollBarup;
    }

    public void setResultsGridVerticalScrollBarup(WebElement resultsGridVerticalScrollBarup) {
        this.resultsGridVerticalScrollBarup = resultsGridVerticalScrollBarup;
    }

    public WebElement getResultsGridHorizontalScrollBarLeft() {
        return resultsGridHorizontalScrollBarLeft;
    }

    public void setResultsGridHorizontalScrollBarLeft(WebElement resultsGridHorizontalScrollBarLeft) {
        this.resultsGridHorizontalScrollBarLeft = resultsGridHorizontalScrollBarLeft;
    }

    public List<WebElement> getProfResultsGridHorizontalCols() {
        return profResultsGridHorizontalCols;
    }

    public void setProfResultsGridHorizontalCols(List<WebElement> profResultsGridHorizontalCols) {
        this.profResultsGridHorizontalCols = profResultsGridHorizontalCols;
    }

    public List<WebElement> getProfiledCols() {
        return profiledCols;
    }

    public void setProfiledCols(List<WebElement> profiledCols) {
        this.profiledCols = profiledCols;
    }

    public List<WebElement> getDetailsPageMostFreqValuesHoverText() {
        return detailsPageMostFreqValuesHoverText;
    }

    public void setDetailsPageMostFreqValuesHoverText(List<WebElement> detailsPageMostFreqValuesHoverText) {
        this.detailsPageMostFreqValuesHoverText = detailsPageMostFreqValuesHoverText;
    }

    public List<WebElement> getDetailsPageLeastFreqValuesHoverText() {
        return detailsPageLeastFreqValuesHoverText;
    }

    public void setDetailsPageLeastFreqValuesHoverText(List<WebElement> detailsPageLeastFreqValuesHoverText) {
        this.detailsPageLeastFreqValuesHoverText = detailsPageLeastFreqValuesHoverText;
    }

    public List<WebElement> getDetailsPageDataTypesHoverText() {
        return detailsPageDataTypesHoverText;
    }

    public void setDetailsPageDataTypesHoverText(List<WebElement> detailsPageDataTypesHoverText) {
        this.detailsPageDataTypesHoverText = detailsPageDataTypesHoverText;
    }

    public List<WebElement> getDetailsPagePatternsHoverText() {
        return detailsPagePatternsHoverText;
    }

    public void setDetailsPagePatternsHoverText(List<WebElement> detailsPagePatternsHoverText) {
        this.detailsPagePatternsHoverText = detailsPagePatternsHoverText;
    }

    public List<WebElement> getTrendGraphHoverText() {
        return trendGraphHoverText;
    }

    public void setTrendGraphHoverText(List<WebElement> trendGraphHoverText) {
        this.trendGraphHoverText = trendGraphHoverText;
    }

    public List<WebElement> getNumericColumnDetailsData() {
        return numericColumnDetailsData;
    }

    public void setNumericColumnDetailsData(List<WebElement> numericColumnDetailsData) {
        this.numericColumnDetailsData = numericColumnDetailsData;
    }

    /*
     * public List<WebElement> getLeastFreqValuesDetailsData() { return
     * leastFreqValuesDetailsData; }
     *
     * public void setLeastFreqValuesDetailsData(List<WebElement>
     * leastFreqValuesDetailsData) { this.leastFreqValuesDetailsData =
     * leastFreqValuesDetailsData; }
     */

    public List<WebElement> getBottomDetailsData() {
        return bottomData;
    }

    public void setBottomDetailsData() {
        this.bottomData = bottomData;
    }

    public void setTopDetailData() {
        this.topData = topData;
    }

    public List<WebElement> getTopDetailsData() {
        return topData;
    }

    public List<WebElement> getMostFreqValuesDetailsData() {
        return mostFreqValuesDetailsData;
    }

    public void setMostFreqValuesDetailsData(List<WebElement> mostFreqValuesDetailsData) {
        this.mostFreqValuesDetailsData = mostFreqValuesDetailsData;
    }

    public List<WebElement> getPatternsDetailsData() {
        return patternsDetailsData;
    }

    public void setPatternsDetailsData(List<WebElement> patternsDetailsData) {
        this.patternsDetailsData = patternsDetailsData;
    }

    public List<WebElement> getDetailsTabPatternsBarChart() {
        return detailsTabPatternsBarChart;
    }

    public void setDetailsTabPatternsBarChart(List<WebElement> detailsTabPatternsBarChart) {
        this.detailsTabPatternsBarChart = detailsTabPatternsBarChart;
    }

    public List<WebElement> getDetailsTabDataTypeBarChart() {
        return detailsTabDataTypeBarChart;
    }

    public void setDetailsTabDataTypeBarChart(List<WebElement> detailsTabDataTypeBarChart) {
        this.detailsTabDataTypeBarChart = detailsTabDataTypeBarChart;
    }

    public List<WebElement> getDetailsSectionHeadersExpand() {
        return detailsSectionHeadersExpand;
    }

    public void setDetailsSectionHeadersExpand(List<WebElement> detailsSectionHeadersExpand) {
        this.detailsSectionHeadersExpand = detailsSectionHeadersExpand;
    }

    public List<WebElement> getDataTypeDetailsData() {
        return dataTypeDetailsData;
    }

    public void setDataTypeDetailsData(List<WebElement> dataTypeFirstrow) {
        this.dataTypeDetailsData = dataTypeDetailsData;
    }

    public List<WebElement> getDetailsSectionHeaders() {
        return detailsSectionHeaders;
    }

    public void setDetailsSectionHeaders(List<WebElement> detailsSectionHeadersExpan) {
        this.detailsSectionHeaders = detailsSectionHeaders;
    }

    public void setValueFrequencyData(List<WebElement> valueFrequencyData) {
        this.valueFrequencyData = valueFrequencyData;
    }

    /*
     * public List<WebElement> getValueFrequencyData(){ return valueFrequencyData; }
     */
    public WebElement getResultGridHorizontalScrollbar() {
        return resultGridHorizontalScrollbar;
    }

    public void setResultGridHorizontalScrollbar(WebElement resultGridHorizontalScrollbar) {
        this.resultGridHorizontalScrollbar = resultGridHorizontalScrollbar;
    }

    public List<WebElement> getTrendRerunThirdDot() {
        return trendRerunThirdDot;
    }

    public void setTrendRerunThirdDot(List<WebElement> trendRerunThirdDot) {
        this.trendRerunThirdDot = trendRerunThirdDot;
    }

    public void setDetailsTab(WebElement deatilsTab) {
        this.detailsTab = detailsTab;
    }

    public List<WebElement> getTrendRerunFirstDot() {
        return trendRerunFirstDot;
    }

    public WebElement getDetailsTab() {
        return detailsTab;
    }

    public void setTrendRerunFirstDot(List<WebElement> trendRerunFirstDot) {
        this.trendRerunFirstDot = trendRerunFirstDot;
    }

    public List<WebElement> getTrendRerunSecondDot() {
        return trendRerunSecondDot;
    }

    public void setTrendRerunSecondDot(List<WebElement> trendRerunSecondDot) {
        this.trendRerunSecondDot = trendRerunSecondDot;
    }

    public List<WebElement> getTrendColDataTrendColsecondRerun() {
        return trendColDataTrendColsecondRerun;
    }

    public void setTrendColDataTrendColsecondRerun(List<WebElement> trendColDataTrendColsecondRerun) {
        this.trendColDataTrendColsecondRerun = trendColDataTrendColsecondRerun;
    }

    public List<WebElement> getTrendColDataTrendCol3() {
        return trendColDataTrendCol3;
    }

    public void setTrendColDataTrendCol3(List<WebElement> trendColDataTrendCol3) {
        this.trendColDataTrendCol3 = trendColDataTrendCol3;
    }

    public List<WebElement> gettrendColDataTrendCol2() {
        return trendColDataTrendCol2;
    }

    public void settrendColDataTrendCol2(List<WebElement> trendTrendGraph) {
        this.trendColDataTrendCol2 = trendColDataTrendCol2;
    }

    public List<WebElement> getTrendNullDistinctCols() {
        return trendNullDistinctCols;
    }

    public void setTrendNullDistinctCols(List<WebElement> trendNullDistinctCols) {
        this.trendNullDistinctCols = trendNullDistinctCols;
    }

    public List<WebElement> gettrendColDataTrendCol1() {
        return trendColDataTrendCol1;
    }

    public void settrendColDataTrendCol1(List<WebElement> trendColData) {
        this.trendColDataTrendCol1 = trendColDataTrendCol1;
    }

    public List<WebElement> getTrendColCols() {
        return trendColCols;
    }

    public void setTrendColCols(List<WebElement> trendColCols) {
        this.trendColCols = trendColCols;
    }

    public String getPredefinedFilterTextForEverything() {
        waitForElementToBeVisible(getPredefinedFiler());
        return getPredefinedFilerEverything().getAttribute("value");
    }

    public String getPredefinedFilterTextFor100NullPercentage() {
        WaitForObjectToVanish(".blockUI img");
        return getPredefinedFiler_100Null().getAttribute("value");
    }

    public String getPredefinedFilterTextFor100DistinctPercentage() {
        WaitForObjectToVanish(".blockUI img");
        return getPredefinedFiler_100Distinct().getAttribute("value");
    }

    public String getPredefinedFilterTextFor100ConstantPercentage() {
        WaitForObjectToVanish(".blockUI img");
        return getPredefinedFiler_100Constant().getAttribute("value");
    }

    public String getPredefinedFilterTextForConflictingDataType() {
        return getPredefinedFiler_100ConflictingDatatypes().getAttribute("value");
    }

    public String getProfileStartTime() {
        return getHeaderProfileStartTime().getText();
    }

    public String getProfileSelectedRunText() {
        funcWait(5000);
        return getHeaderProfileRunSelected().getText();
    }

    public String getColumnSectionHeaderText() {
        waitForElementToBeVisible(headerProfileColumns);
        return getHeaderProfileColumns().getText();
    }

    public String getSamplingOptionName() {
        return getHeaderProfileOptions().getText();
    }

    public String getProfileName() {
        return getHeaderProfileName().getText();
    }

    public boolean isProfileIconPresent() {
        return getHeaderProfileIcon().isDisplayed();
    }

    public WebElement getHeaderProfileIcon() {
        return headerProfileIcon;
    }

    public void setHeaderProfileIcon(WebElement headerProfileIcon) {
        this.headerProfileIcon = headerProfileIcon;
    }

    public WebElement getHeaderProfileRunSelected() {
        return headerProfileRunSelected;
    }

    public void setHeaderProfileRunSelected(WebElement headerProfileRunSelected) {
        this.headerProfileRunSelected = headerProfileRunSelected;
    }

    public WebElement getHeaderProfileColumns() {
        return headerProfileColumns;
    }

    public void setHeaderProfileColumns(WebElement headerProfileColumns) {
        this.headerProfileColumns = headerProfileColumns;
    }

    public WebElement getHeaderProfileRules() {
        return headerProfileRules;
    }

    public void setHeaderProfileRules(WebElement headerProfileRules) {
        this.headerProfileRules = headerProfileRules;
    }

    public WebElement getHeaderProfileOptions() {
        return headerProfileOptions;
    }

    public void setHeaderProfileOptions(WebElement headerProfileOptions) {
        this.headerProfileOptions = headerProfileOptions;
    }

    public WebElement getHeaderProfileStartTime() {
        return headerProfileStartTime;
    }

    public void setHeaderProfileStartTime(WebElement headerProfileStartTime) {
        this.headerProfileStartTime = headerProfileStartTime;
    }

    public WebElement getHeaderProfileName() {
        return headerProfileName;
    }

    public void setHeaderProfileName(WebElement headerProfileName) {
        this.headerProfileName = headerProfileName;
    }

    public WebElement getPredefinedFiler() {
        return predefinedFiler;
    }

    public void setResultsPageHeader() {
        this.resultsPageheader = resultsPageheader;
    }

    public WebElement getResultsPageHeader() {
        return resultsPageheader;
    }

    public void setPredefinedFiler(WebElement predefinedFiler) {
        this.predefinedFiler = predefinedFiler;
    }

    public WebElement getPredefinedFilerEverything() {
        return predefinedFilerEverything;
    }

    public void setPredefinedFilerEverything(WebElement predefinedFilerEverything) {
        this.predefinedFilerEverything = predefinedFilerEverything;
    }

    public WebElement getPredefinedFiler_100Null() {
        return predefinedFiler_100Null;
    }

    public void setPredefinedFiler_100Null(WebElement predefinedFiler_100Null) {
        this.predefinedFiler_100Null = predefinedFiler_100Null;
    }

    public WebElement getPredefinedFiler_100Distinct() {
        return predefinedFiler_100Distinct;
    }

    public void setPredefinedFiler_100Distinct(WebElement predefinedFiler_100Distinct) {
        this.predefinedFiler_100Distinct = predefinedFiler_100Distinct;
    }

    public WebElement getPredefinedFiler_100Constant() {
        return predefinedFiler_100Constant;
    }

    public void setPredefinedFiler_100Constant(WebElement predefinedFiler_100Constant) {
        this.predefinedFiler_100Constant = predefinedFiler_100Constant;
    }

    public WebElement getPredefinedFiler_100ConflictingDatatypes() {
        return predefinedFiler_100ConflictingDatatypes;
    }

    public void setPredefinedFiler_100ConflictingDatatypes(WebElement predefinedFiler_100ConflictingDatatypes) {
        this.predefinedFiler_100ConflictingDatatypes = predefinedFiler_100ConflictingDatatypes;
    }

    public List<WebElement> getResultColumnList() {
        return resultColumnList;
    }

    public void setResultColumnList(List<WebElement> resultColumnList) {
        this.resultColumnList = resultColumnList;
    }

    public WebElement getResultGridDownScrollbar() {
        return resultGridDownScrollbar;
    }

    public void setResultGridDownScrollbar(WebElement resultGridDownScrollbar) {
        this.resultGridDownScrollbar = resultGridDownScrollbar;
    }

    public WebElement getRowDetailsSection() {
        return rowDetailsSection;
    }

    public void setRowDetailsSection(WebElement rowDetailsSection) {
        this.rowDetailsSection = rowDetailsSection;
    }

    public List<WebElement> getResultsGridCols() {
        return resultsGridCols;
    }

    public void setResultsGridCols(List<WebElement> resultsGridCols) {
        this.resultsGridCols = resultsGridCols;
    }

    public List<WebElement> getDetailsHeadersCols() {
        return detailsHeadersCoLS;
    }

    public WebElement getBackToSummary() {
        return backToSummary;
    }

    public void setBackToSummary(WebElement backToSummary) {
        this.backToSummary = backToSummary;
    }

    public void setFirstRowOnResultsPage(WebElement firstRowOnResultsPage) {
        this.firstRowOnResultsPage = firstRowOnResultsPage;
    }

    public WebElement getFirstRowOnResultsPage() {
        return firstRowOnResultsPage;
    }

    public WebElement getOptionsButton() {
        return optionsButton;
    }

    public void setOptionsButton(WebElement optionsButton) {
        this.optionsButton = optionsButton;
    }

    public List<WebElement> getOptionsMenu() {
        return optionsMenu;
    }

    public void setOptionsMenu(List<WebElement> optionsMenu) {
        this.optionsMenu = optionsMenu;
    }

    public WebElement getNoDataToDisplayText() {
        waitForElementToBeVisible(noDataToDisplayText);
        return noDataToDisplayText;
    }

    public void setNoDataToDisplayText(WebElement noDataToDisplayText) {
        this.noDataToDisplayText = noDataToDisplayText;
    }

    public List<WebElement> getProfileResultListWithRule() {
        return profileResultListWithRule;
    }

    public void setProfileResultListWithRule(List<WebElement> profileResultListWithRule) {
        this.profileResultListWithRule = profileResultListWithRule;
    }

    public List<WebElement> getProfileResultWithRuleInputColumns() {
        return profileResultWithRuleInputColumns;
    }

    public void setProfileResultWithRuleInputColumns(List<WebElement> profileResultWithRuleInputColumns) {
        this.profileResultWithRuleInputColumns = profileResultWithRuleInputColumns;
    }

    public WebElement getResultGridView() {
        return ResultGridView;
    }

    public void setResultGridView(WebElement resultGridView) {
        ResultGridView = resultGridView;
    }

    public WebElement getRulesSubTabAddRuleButton() {
        return rulesSubTabAddRuleButton;
    }

    public void setRulesSubTabAddRuleButton(WebElement rulesSubTabAddRuleButton) {
        this.rulesSubTabAddRuleButton = rulesSubTabAddRuleButton;
    }

    public WebElement getRulesSubTabtext() {
        return rulesSubTabtext;
    }

    public void setRulesSubTabtext(WebElement rulesSubTabtext) {
        this.rulesSubTabtext = rulesSubTabtext;
    }

    /**
     * Page Methods Section
     *
     */

    public String getSourceMethod() {
        return sourceMethod;
    }

    public void setSourceMethod(String sourceMethod) {
        this.sourceMethod = sourceMethod;
    }

    public WebElement getColumnDetail1OnValueFrequencyPage() {
        return columnDetail1OnValueFrequencyPage;
    }

    public void setColumnDetail1OnValueFrequencyPage(WebElement columnDetail1OnValueFrequencyPage) {
        this.columnDetail1OnValueFrequencyPage = columnDetail1OnValueFrequencyPage;
    }

    public WebElement getColumnDetail2OnValueFrequencyPage() {
        return columnDetail2OnValueFrequencyPage;
    }

    public void setColumnDetail2OnValueFrequencyPage(WebElement columnDetail2OnValueFrequencyPage) {
        this.columnDetail2OnValueFrequencyPage = columnDetail2OnValueFrequencyPage;
    }

    public WebElement getColumnDetail3OnValueFrequencyPage() {
        return columnDetail3OnValueFrequencyPage;
    }

    public void setColumnDetail3OnValueFrequencyPage(WebElement columnDetail3OnValueFrequencyPage) {
        this.columnDetail3OnValueFrequencyPage = columnDetail3OnValueFrequencyPage;
    }

    public String getLogMessage() {
        return logMessage;
    }

    public void setLogMessage(String logMessage) {
        logger.info(logMessage);
        this.logMessage += "<BR> " + logMessage;
    }

    public void setErrorLogMessage(String logMessage) {
        this.logMessage += "<BR><font color='red'> " + logMessage + "</font>";
    }

    public List<WebElement> getNotificationMessages() {
        return notificationMessages;
    }

    public List<WebElement> getInferredDataTypesCheckboxes() {
        return inferredDataTypesCheckboxes;
    }

    public List<WebElement> getPatternsCheckboxes() {
        return patternsCheckboxes;
    }

    public List<WebElement> getvalueFrequencyCheckboxes() {
        return valueFrequencyCheckboxes;
    }

    public List<WebElement> getDrillDownButtons() {
        return drillDownButtons;
    }

    public List<WebElement> getDrillDownResultsRows() {
        return drillDownResultsRows;
    }

    public List<WebElement> getDrillDownResultsHeader() {
        return drillDownResultsHeader;
    }

    public List<WebElement> getDrillDownResultsData() {
        return drillDownResultsData;
    }

    public WebElement getLoaderSpinner() {
        return loaderSpinner;
    }

    public WebElement getDataPreviewMinimizeButton() {
        return dataPreviewMinimizeButton;
    }

    public void setDataPreviewMinimizeButton(WebElement dataPreviewMinimizeButton) {
        this.dataPreviewMinimizeButton = dataPreviewMinimizeButton;
    }

    public WebElement getDataPreviewMaximizeButton() {
        return dataPreviewMaximizeButton;
    }

    public void setDataPreviewMaximizeButton(WebElement dataPreviewMaximizeButton) {
        this.dataPreviewMaximizeButton = dataPreviewMaximizeButton;
    }

    public WebElement getDataPreviewRestoreButton() {
        return dataPreviewRestoreButton;
    }

    public void setDataPreviewRestoreButton(WebElement dataPreviewRestoreButton) {
        this.dataPreviewRestoreButton = dataPreviewRestoreButton;
    }

    public WebElement getViewDropDownOnResultsPage() {
        return viewDropDownOnResultsPage;
    }

    public void setViewDropDownOnResultsPage(WebElement viewDropDownOnResultsPage) {
        this.viewDropDownOnResultsPage = viewDropDownOnResultsPage;
    }
    
    public List<WebElement> getColumnFreqPair() {
        return columnTableFreqPair;
    }
    
    public String getCurrentMethod() {
        this.logMessage = "";
        String arr[] = new String[2];
        String fullName[] = Thread.currentThread().getStackTrace()[2].getClassName().split("\\.");
        String className = fullName[fullName.length - 1];
        String method = Thread.currentThread().getStackTrace()[2].getMethodName();
        arr[0] = className;
        arr[1] = method;
        return arr[0] + "." + arr[1];
    }

    public ProfileResultsPage selectPredefinedFilterAsEverything(String tc_id) throws SQLException {
        try {
            logger.info("Select Predefined Filter As Everything Started");
            WaitForObjectToVanish(".blockUI img");
            WebElement dropdownButton = driver.findElement(By.xpath(dropdownButtonForWith));
            waitForElementToBeclickable(dropdownButton);
            dropdownButton.click();
            for (WebElement ele : getListOfOptionsInTheDropdown()) {
                if (ele.getText().contains("All Statistics")) {
                    ele.click();
                    break;
                }
            }
            invisibilityOfElementLocated(By.cssSelector("div[class*='loader__message']"));
            logger.info("Select Predefined Filter As Everything Done Sucessfully");
        } catch (Exception e) {
            setLogMessage("Select Predefined Filter As Everything Failed with error....\n" + e.getMessage().toString());
            logger.error("Select Predefined Filter As Everything Failed....");
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            e.printStackTrace();
            Assert.fail("Select Predefined Filter As Everything Failed....", e);
        }
        return this;
    }

    public ProfileResultsPage selectPredefinedFilterAs100NullPercentage(String tc_id) throws SQLException {
        try {
            logger.info("Select Predefined Filter As 100 Null Percentage Started");
            WebElement dropdownButton = driver.findElement(By.xpath(dropdownButtonForWith));
            WaitForObjectToVanish(".blockUI img");
            waitForElementToBeclickable(dropdownButton);
            dropdownButton.click();
            for (WebElement ele : getListOfOptionsInTheDropdown()) {
                if (ele.getText().contains("100% Null")) {
                    ele.click();
                    break;
                }
            }
            invisibilityOfElementLocated(By.cssSelector("div[class*='loader__message']"));
            logger.info("Select Predefined Filter As 100 Null Percentage Done Successfully");
        } catch (Exception e) {
            setLogMessage("Select Predefined Filter As 100 Null Percentage Failed with error....\n"
                    + e.getMessage().toString());
            logger.error("Select Predefined Filter As 100 Null Percentage Failed....");
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            e.printStackTrace();
            Assert.fail("Select Predefined Filter As 100 Null Percentage Failed....", e);
        }

        return this;
    }

    public ProfileResultsPage selectPredefinedFilterAs100DistinctPercentage(String tc_id) throws SQLException {
        try {
            logger.info("Select Predefined Filter As 100 Distinct Percentage Started");
            WaitForObjectToVanish(".blockUI img");
            WebElement dropdownButton = driver.findElement(By.xpath(dropdownButtonForWith));
            waitForElementToBeclickable(dropdownButton);
            dropdownButton.click();
            for (WebElement ele : getListOfOptionsInTheDropdown()) {
                if (ele.getText().contains("100% Distinct")) {
                    ele.click();
                    break;
                }
            }
            invisibilityOfElementLocated(By.cssSelector("div[class*='loader__message']"));
            logger.info("Select Predefined Filter As 100 Distinct Percentage Done Successfully");
        } catch (Exception e) {
            setLogMessage("Select Predefined Filter As 100 Distinct Percentage Failed with error....\n"
                    + e.getMessage().toString());
            logger.error("Select Predefined Filter As 100 Distinct Percentagee Failed....");
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            e.printStackTrace();
            Assert.fail("Select Predefined Filter As 100 Distinct Percentage Failed....", e);
        }

        return this;
    }

    public ProfileResultsPage selectPredefinedFilterAs100ConstantPercentage(String tc_id) throws SQLException {
        try {
            logger.info("Select Predefined Filter As 100 Constant Percentage Started");
            WaitForObjectToVanish(".blockUI img");
            WebElement dropdownButton = driver.findElement(By.xpath(dropdownButtonForWith));
            waitForElementToBeclickable(dropdownButton);
            dropdownButton.click();
            for (WebElement ele : getListOfOptionsInTheDropdown()) {
                if (ele.getText().contains("100% Constant")) {
                    ele.click();
                    break;
                }
            }
            invisibilityOfElementLocated(By.cssSelector("div[class*='loader__message']"));
            logger.info("Select Predefined Filter As 100 Constant Percentage Done Successfully");
        } catch (Exception e) {
            setLogMessage("Select Predefined Filter As 100 Distinct Percentage Failed with error....\n"
                    + e.getMessage().toString());
            logger.error("Select Predefined Filter As 100 Distinct Percentagee Failed....");
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            e.printStackTrace();
            Assert.fail("Select Predefined Filter As 100 Distinct Percentage Failed....", e);
        }

        return this;
    }

    public ProfileResultsPage selectPredefinedFilterAsConflictingDataType(String tc_id) throws SQLException {
        try {
            logger.info("Select Predefined Filter As Conflicting Data Type Started");
            WaitForObjectToVanish(".blockUI img");
            WebElement dropdownButton = driver.findElement(By.xpath(dropdownButtonForWith));
            waitForElementToBeclickable(dropdownButton);
            dropdownButton.click();
            for (WebElement ele : getListOfOptionsInTheDropdown()) {
                if (ele.getText().contains("Conflicting Data Types")) {
                    ele.click();
                    break;
                }
            }
            invisibilityOfElementLocated(By.cssSelector("div[class*='loader__message']"));
            logger.info("Select Predefined Filter As Conflicting Data Type Done Successfully");
        } catch (Exception e) {
            setLogMessage("Select Predefined Filter As Conflicting Data Type Failed with error....\n"
                    + e.getMessage().toString());
            logger.error("Select Predefined Filter As Conflicting Data Type Failed....");
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            e.printStackTrace();
            Assert.fail("Select Predefined Filter As Conflicting Data Type Failed....", e);
        }

        return this;
    }

    public ProfileResultsPage selectViewAsRules() {
        funcWait(2000);
        invisibilityOfLoaderImageWithTimeoutInDialog(15);
        WebElement dropdownButton = driver.findElement(By.xpath(dropdownButtonForView));
        dropdownButton.click();
        for (WebElement ele : getListOfOptionsInTheDropdown()) {
            if (ele.getText().equalsIgnoreCase("Rules")) {
                ele.click();
                break;
            }
        }
        invisibilityOfLoaderImageWithTimeoutInDialog(15);
        return this;
    }

    public ManageRulePage clickOnRulesTab() {
        try {
            WaitForObjectToVanish(".blockUI img");
            logger.info("Navigate to Rules Tab Started");
            waitForElementToBeVisible(getRulesTab());
            funcWait(2000);
            waitForElementToBeclickable(getRulesTab());
            performClickOn(getRulesTab());
            funcWait(1000);
            WaitForObjectToVanish(".blockUI img");
            //waitForAllElementsToPresent("span.infaTable-title-name.panel-title");
            logger.info("Navigate to Rules Tab Ended Successfully");
        } catch (Exception e) {
            setLogMessage("Navigate to Rules Tab Started failed with error " + e.getMessage().toString());
            // testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            // testDbDetailUtilities.updateStatusForTestCase(tc_id,
            // ProfilingConstants.FAILED);
            logger.error("Navigate to Rules Tab Started failed");
            System.out.println(e.toString());
            Assert.fail("Navigate to Rules Tab Started failed with error", e);
        }
        return new ManageRulePage(driver);
    }

    public ProfileResultsPage waitForResultPageToLoad(String tc_id) throws SQLException {
        try {
            logger.info("Wait for Results page to load started");
            waitForLoad(driver);
            invisibilityOfElementOfGivenSelectorWithTimeout(30, ".blockUI blockOverlay");
            invisibilityOfElementOfGivenSelectorWithTimeout(30, "div[class*='shell__page__content'] >div[class*='loader']:nth-of-type(2) div[class*='loader__message']");
            invisibilityOfElementOfGivenSelectorWithTimeout(30, "div[data-section='grid-results'] div[class*='loader__message']");
            invisibilityOfElementOfGivenSelectorWithTimeout(15, "div[data-q-loading='datatypes-section'] div[class*='loader__message']");
            invisibilityOfElementOfGivenSelectorWithTimeout(15, "div[data-q-loading='patterns-section'] div[class*='loader__message']");
            invisibilityOfElementOfGivenSelectorWithTimeout(15, "div[data-q-loading='frequentvalues-section'] div[class*='loader__message']");
            invisibilityOfElementOfGivenSelectorWithTimeout(15, "div[data-section='queries'] div[class*='loader__message']");
            waitForElementBy(By.cssSelector("span[class='profile-header']"));
            logger.info("Wait for Results page to load ended successfully");
        } catch (Exception e) {
            setLogMessage("Wait for Results page to load Failed with error....\n" + e.getMessage().toString());
            logger.error("Wait for Results page to load Failed....");
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            e.printStackTrace();
            Assert.fail("Wait for Results page to load Failed....", e);
        }
        return this;
    }

    public void selectOptionFromMenu(String option, String tc_id) throws SQLException {
        try {
            logger.info("Select option from menu started");
            WaitForObjectToVanish(".blockUI img");
            waitForPreLoadImageDisappear();
            waitForElementToBeVisible(getOptionsButton());
            getOptionsButton().click();
            WaitForObjectToVanish("div[class*='loader']");
            waitForAllElementsToPresent("ul[class*='menu'] li");
            List<WebElement> list = getOptionsMenu();
            for (int i = 0; i < list.size(); i++) {
                if (list.get(i).getText().equalsIgnoreCase(option)) {
                    list.get(i).click();
//					performClickOn(list.get(i));
                    break;
                }
            }
            logger.info("Select option from menu ended successfully for Option:" + option);
        } catch (Exception e) {
            setLogMessage("Select option from menu Failed with error....\n" + e.getMessage().toString());
            logger.error("Select option from menu Failed....");
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            e.printStackTrace();
            Assert.fail("Select option from menu Failed....", e);
        }

    }

    public CompareProfileRunPage selectCompareRunsOption(String tc_id) throws SQLException {
        try {
            logger.info("Select option from menu started");
            WaitForObjectToVanish(".blockUI img");
            waitForElementToBeVisible(getOptionsButton());
            performClickOn(getOptionsButton());
            waitForAllElementsToPresent("ul[class*='menu'] li");
            WaitForObjectToVanish(".blockUI img");
            List<WebElement> list = getOptionsMenu();
            for (int i = 0; i < list.size(); i++) {
                if (list.get(i).getText().equalsIgnoreCase("Compare Profile Runs")) {
                    performClickOn(list.get(i));
                    break;
                }
            }
           invisibilityOfElementOfGivenSelectorWithTimeout(30, "div[data-dialog-name='profile-run-selector'] div[class*='loader__message']");
            logger.info("Select option from menu ended successfully for Option:" + "Compare Profile Runs");
        } catch (Exception e) {
            setLogMessage("Select option from menu Failed with error....\n" + e.getMessage().toString());
            logger.error("Select option from menu Failed....");
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            e.printStackTrace();
            Assert.fail("Select option from menu ended successfully for Option:\" + \"Compare Profile Runs\" failed", e);
        }

        return new CompareProfileRunPage(driver);
    }

    public CompareColumnsPage selectCompareColumnsOption(String tc_id) throws SQLException {
        try {
            logger.info("Select option from menu started");
            WaitForObjectToVanish(".blockUI img");
            waitForElementToBeclickable(getOptionsButton());
            performClickOn(getOptionsButton());
            WaitForObjectToVanish(".blockUI img");
            waitForAllElementsToPresent("ul[class*='menu'] li");
            List<WebElement> list = getOptionsMenu();
            for (int i = 0; i < list.size(); i++) {
                if (list.get(i).getText().equalsIgnoreCase("Compare Columns")) {
                    performClickOn(list.get(i));
                    break;
                }
            }
            logger.info("Select option from menu ended successfully for Option:" + "Compare Columns");
        } catch (Exception e) {
            setLogMessage("Select option from menu Failed with error....\n" + e.getMessage().toString());
            logger.error("Select option from menu Failed....");
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            e.printStackTrace();
            Assert.fail("Select option from menu ended successfully for Option:\" + \"Compare Columns\" failed", e);
        }

        return new CompareColumnsPage(driver);
    }

    public boolean checkRuleIconsForColumns(String[] ruleColumns) {
        List<WebElement> columnList = getResultsGridCols();
        int counter = 0;
        for (int j = 0; j < ruleColumns.length; j++) {
            for (int i = 0; i < columnList.size(); i++) {
                if (columnList.get(i).getText().equals(ruleColumns[j])) {
                    String ruleIconLocator = "div[data-section='grid-results'] tbody>tr:nth-of-type(rowNumber)>td:nth-of-type(3)>span>div>span>img";
                    ruleIconLocator = ruleIconLocator.replace("rowNumber", String.valueOf(i+2));
                    if (getElementFromCssString(ruleIconLocator).isDisplayed() == true) {
                        System.out.println("rule icon for column " + ruleColumns[j] + " is displayed");
                        counter++;
                    } else {
                        System.out.println("Rule icon not found for column " + ruleColumns[j]);
                        Assert.fail("Rule icon is not present for " + ruleColumns[j]);
                    }
                    break;
                }
            }
        }
        if (counter == ruleColumns.length)
            return true;
        else
            return false;
    }

    public ProfileResultsPage validateDetailsCols(String detailsTabHeaders, String tc_id) throws SQLException {
        try {
            logger.info("Validate Details Columns started");
            boolean flag = false;
            WebElement firstRowOnResultsPage = driver.findElement(By.xpath("(//div[@data-grid-col-name='columnName']//span//a)[1]"));
            // String detailsPage = null;
            funcWait(5000);
            //waitForElementToBeVisible(firstRowOnResultsPage);
            funcWait(1000);
            performClickOn(firstRowOnResultsPage);
            waitForElementToBeVisible(getRowDetailsSection());
            String[] headers = detailsTabHeaders.split(";");
            try {
                /*
                 * detailsPage = getRowDetailsSection().getText(); if (detailsPage.contains(""))
                 * { getResultsGridCols().get(0).click();
                 */
                for (int i = 0; i < headers.length; i++) {
                    for (WebElement ele : getDetailsHeadersCols()) {
                        String headCol = ele.getText();
                        if (headCol.trim().contains(headers[i].trim())) {
                            flag = true;
                            break;
                        } else {
                            flag = false;
                        }
                    }
                }
                Assert.assertTrue(flag);
                logger.info("Validate Details Columns ended successfully");
            } catch (Exception e) {
                System.out.println(e.getMessage());
            }

        } catch (Exception e) {
            setLogMessage("Validate Details Columns Failed with error....\n" + e.getMessage().toString());
            logger.error("Validate Details Columns Failed....");
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            e.printStackTrace();
            Assert.fail("Validate Details Columns Failed....", e);
        }
        return new ProfileResultsPage(driver);
    }

    public ProfileResultsPage validateDetailsColsCols(String detailsTabHeaders, String tc_id) throws SQLException {
        try {
            logger.info("Validate Details ColsCols started");
            boolean flag = false;
            String detailsPage = null;
            WebElement firstRowOnResultsPage = driver.findElement(By.xpath("(//div[@data-grid-col-name='columnName']//span//a)[1]"));
            waitForElementToBeVisible(getRowDetailsSection());
            funcWait(1000);
            String[] headers = detailsTabHeaders.split(";");
            try {
                performClickOn(firstRowOnResultsPage);
                funcWait(2000);
                waitForElementToBeVisible(getRowDetailsSection());
                // getResultsGridCols().get(0).click();
                if (headers[0].contains("Trend")) {
                    for (int i = 1; i < headers.length; i++) {
                        for (WebElement ele : getTrendColCols()) {
                            String headCol = ele.getText();
                            if (headCol.trim().contains(headers[i].trim())) {
                                flag = true;
                                break;
                            } else {
                                flag = false;
                            }
                        }
                    }
                }
                Assert.assertTrue(flag);
                logger.info("Validate Details ColsCols ended successfully");
            } catch (Exception e) {
                System.out.println(e.getMessage());
            }
        } catch (Exception e) {
            setLogMessage("Validate Details ColsCols Failed with error....\n" + e.getMessage().toString());
            logger.error("Validate Details ColsCols failed...");
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            e.printStackTrace();
            Assert.fail("Validate Details ColsCols Failed with error...", e);
        }

        return new ProfileResultsPage(driver);
    }

    public ProfileResultsPage validateDetailsColsData(String detailsTabData, String tc_id) throws SQLException {
        try {
            logger.info("Validate Details Cols data started");
            boolean flag = false;
            String detailsPage = null;
            waitForElementToBeVisible(getRowDetailsSection());
            String[] resData = detailsTabData.split(";");
            try {
                if (resData[0].contains("Trend")) {
                    for (int i = 1; i < resData.length; i++) {
                        for (WebElement ele : gettrendColDataTrendCol1()) {
                            String headCol = ele.getText();
                            if (headCol.equals("")) {
                                headCol = ele.getAttribute("innerHTML");
                            }
                            if (headCol.trim().contains(resData[i].trim())) {
                                flag = true;
                                break;
                            } else {
                                flag = false;
                            }
                        }
                    }
                    // Type Col Color Validation
                    setLogMessage("Validate Details Cols color validation started");
                    Assert.assertTrue(
                            getTrendNullDistinctCols().get(0).getCssValue("color").contains("rgba(236, 28, 36, 1)")); // Red
                    Assert.assertTrue(
                            getTrendNullDistinctCols().get(1).getCssValue("color").contains("rgba(0, 169, 187, 1)")); // Blue
                    Assert.assertTrue(
                            gettrendColDataTrendCol1().get(2).getCssValue("color").contains("rgba(51, 51, 51, 1)")); // Default
                    for (WebElement ele : gettrendColDataTrendCol2())
                        Assert.assertTrue(ele.getCssValue("fill").contains("rgb(255, 165, 0)")); // Orange
                    setLogMessage("Validate Details Cols color validation ended successfully");
                    Assert.assertTrue(gettrendColDataTrendCol2().size() == 3);
                    Assert.assertTrue(flag);

                    for (WebElement ele : getTrendColDataTrendCol3()) {
                        Assert.assertTrue(ele.getText().isEmpty());
                    }
                }

                /*
                 * if (resData[0].contains("DataTypes")) {
                 *
                 * }
                 */
                logger.info("Validate Details Cols data ended successfully");
            } catch (Exception e) {
                System.out.println(e.getMessage());
            }
        } catch (Exception e) {
            setLogMessage("Validate Details Cols data Failed with error....\n" + e.getMessage().toString());
            logger.error("Validate Details Cols data failed...");
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            e.printStackTrace();
            Assert.fail("Validate Details Cols data Failed", e);
        }

        return new ProfileResultsPage(driver);
    }

    public ProfileResultsPage validateDetailsCols(String detailsTabHeaders, String col, String tc_id) throws SQLException {
        try {
            logger.info("Validate Details Cols started");
            boolean flag = false;
            waitForElementToBeVisible(getRowDetailsSection());
            String[] headers = detailsTabHeaders.split(";");
            try {
                // getBackToSummary().click();
                // currently this step is not working
                clickOnParticularResultsCol(col, tc_id);
                for (int i = 0; i < headers.length; i++) {
                    for (WebElement ele : getDetailsHeadersCols()) {
                        String headCol = ele.getText();
                        if (headCol.trim().contains(headers[i].trim())) {
                            flag = true;
                            break;
                        } else {
                            flag = false;
                        }
                    }
                }
                Assert.assertTrue(flag);
                logger.info("Validate Details Cols started");
            } catch (Exception e) {
                System.out.println(e.getMessage());
            }
        } catch (Exception e) {
            setLogMessage("Validate Details Cols Failed with error....\n" + e.getMessage().toString());
            logger.error("Validate Details Cols failed...");
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            e.printStackTrace();
            Assert.fail("Validate Details Cols Failed", e);
        }

        return new ProfileResultsPage(driver);
    }

    public ProfileResultsPage clickOnParticularResultsCol(String col, String tc_id) throws SQLException {
        try {
            logger.info("Clicking on particular Results col started for Column Name:" + col);
            invisibilityOfLoaderImageWithTimeout(15);
            boolean flag = false;
            for (WebElement ele : getResultsGridCols()) {
                String gridColName = ele.getText();
                if (gridColName.equalsIgnoreCase(col)) {
/*                    WebElement distributionElement = driver.findElement(By.xpath("//div[@data-grid-col-name='columnName']//span//a[text()='" + gridColName + "']/ancestor::td//following-sibling::td[@data-id='distribution']"));
                    distributionElement.click();*/
                	invisibilityOfElementOfGivenSelectorWithTimeout(30, "div[class*='loader__message']");                    
                    ele.click();
                    flag = true;
                    setLogMessage("Clicking on particular Results col done successfully for Column Name:" + col);
                    invisibilityOfLoaderImageWithTimeout(5);
                    break;
                }
            }
            if (!flag && getResultGridDownScrollbar().isDisplayed()) {
                // getResultGridDownScrollbar().click();
                setLogMessage("Clicking the Result grid down scrollbar");
                new Actions(driver).clickAndHold(resultGridVScrollbar).moveByOffset(0, 26).release().perform();
                funcWait(1000);
                clickOnParticularResultsCol(col, tc_id);
            }
        } catch (Exception e) {
            setLogMessage("Clicking on  particular Results col failed with error....\n" + e.getMessage().toString());
            logger.error("Clicking on  particular Results col failed...");
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            e.printStackTrace();
            Assert.fail("Clicking on  particular Results col failed...", e);
        }

        return new ProfileResultsPage(driver);
    }

    public ProfileResultsPage clickOnParticularValueDistributionCol(String col, String tc_id) throws SQLException {
        try {
            logger.info("Clicking on particular value distribution col started for Column Name:" + col);
            boolean flag = false;
            WebElement ele;
            String counter = "";
            for (int i = 0; i < getResultsGridCols().size(); i++) {
                counter = String.valueOf(i);
                ele = getResultsGridCols().get(i);
                String gridColName = ele.getText();
                {
                    if (gridColName.equals(col)) {
                        funcWait(3000);
                        System.out.println(gridColName);
                        boolean waitForbackToSummary = false;
                        try {
                            new WebDriverWait(driver, 2).until(ExpectedConditions.presenceOfElementLocated(
                                    By.cssSelector("div.frequency-analysis-container button[class*=button--primary] span")));
                            waitForbackToSummary = driver
                                    .findElement(By.cssSelector("div.frequency-analysis-container button[class*=button--primary] span"))
                                    .isDisplayed();
                        } catch (Exception e) {

                        }
                        if (waitForbackToSummary) {
                            waitForElementToBeclickable(getBackToSummary());
                            performClickOn(getBackToSummary());
                            funcWait(2000);
                        }
                        driver.findElement(
                                By.cssSelector("div.jqx-grid-group-cell:nth-of-type(3)>div[data-uid='counter']"
                                        .replace("counter", counter)))
                                .click();
                        waitForElementToBeVisible(getDetailsTab());
                        funcWait(2000);
                        flag = true;
                        logger.info("Clicking on particular value distribution col done successfully for Column Name:"
                                + col);
                        break;
                    }
                }
                if (!flag && getResultGridDownScrollbar().isDisplayed()) {
                    // getResultGridDownScrollbar().click();
                    logger.info("Clicking the Result grid down scrollbar");
                    new Actions(driver).clickAndHold(resultGridVScrollbar).moveByOffset(0, 15).release().perform();
                    clickOnParticularResultsCol(col, tc_id);
                }
            }

        } catch (Exception e) {
            setLogMessage("Clicking on particular value distribution col failed with error....\n"
                    + e.getMessage().toString());
            logger.error("Clicking on particular value distribution col failed...");
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            e.printStackTrace();
            Assert.fail("Clicking on  particular Results col failed...", e);
        }
        return new ProfileResultsPage(driver);
    }

    public ProfileResultsPage selectParticularResultsCol(String col, String tc_id) throws SQLException {
        try {
            logger.info("Selecting particular Results col started for Column Name:" + col);
            boolean flag = false;
            funcWait(2000);
            waitForElementToBeVisible(getResultsGridCols().get(0));
            for (WebElement ele : getResultsGridCols()) {
                String gridColName = ele.getText();
                if (gridColName.equals(col)) {
                    funcWait(1000);
                    ele.click();
                    flag = true;
                    logger.info("Clicking on particular Results col done successfully for Column Name:" + col);
                    break;
                }
            }
            if (!flag && getResultGridDownScrollbar().isDisplayed()) {
                getResultGridDownScrollbar().click();
                clickOnParticularResultsCol(col, tc_id);
            }
            invisibilityOfElementOfGivenSelectorWithTimeout(30, "div[class*='row-details-section'] div[class*='loader__message']");
        } catch (Exception e) {
            setLogMessage("Selecting particular Results col failed with error....\n" + e.getMessage().toString());
            logger.error("Selecting on particular Results col failed...");
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            e.printStackTrace();
            Assert.fail("Selecting on  particular Results col failed...", e);
        }

        return new ProfileResultsPage(driver);
    }

    // First Run
    public ProfileResultsPage validateTrendDetailsColsData1(String detailsTabData, String tc_id) throws SQLException {
        try {
            logger.info("Validate Trend Details Columns data1 started");
            boolean flag = false;
            String detailsPage = null;
            waitForElementToBeVisible(getRowDetailsSection());
            String[] resData = detailsTabData.split(";");
            try {
                if (resData[0].contains("Trend")) {
                    for (int i = 1; i < resData.length; i++) {
                        for (WebElement ele : gettrendColDataTrendCol1()) {
                            String headCol = ele.getText();
                            if (headCol.trim().contains(resData[i].trim())) {
                                flag = true;
                                break;
                            } else {
                                flag = false;
                            }
                        }
                    }
                    // Type Col Color Validation
                    setLogMessage("Validate Type Col Color started");
                    Assert.assertTrue(flag);
                    Assert.assertTrue(
                            getTrendNullDistinctCols().get(0).getCssValue("color").contains("rgba(236, 28, 36, 1)")); // Red
                    Assert.assertTrue(
                            getTrendNullDistinctCols().get(1).getCssValue("color").contains("rgba(0, 169, 187, 1)")); // Blue
                    Assert.assertTrue(
                            gettrendColDataTrendCol1().get(2).getCssValue("color").contains("rgba(51, 51, 51, 1)")); // Default
                    logger.info("Validate Type Col Color ended successfully");

                    for (WebElement ele : getTrendRerunFirstDot())
                        Assert.assertTrue(ele.getCssValue("fill").contains("rgb(35, 115, 228)")); // Blue
                    Assert.assertTrue(getTrendRerunFirstDot().size() == 3);

                    for (WebElement ele : getTrendRerunSecondDot())
                        Assert.assertTrue(ele.getCssValue("fill").contains("rgb(255, 165, 0)")); // Orange

                    Assert.assertTrue(
                            getTrendColDataTrendColsecondRerun().get(0).getCssValue("d").contains("M 5 7 L 55 3")); // FirstLine
                    Assert.assertTrue(
                            getTrendColDataTrendColsecondRerun().get(1).getCssValue("d").contains("M 5 3 L 55 7")); // SecondLine
                    Assert.assertTrue(
                            getTrendColDataTrendColsecondRerun().get(2).getCssValue("d").contains("M 5 7 L 55 7")); // ThirdLine

                    for (WebElement ele : getTrendColDataTrendColsecondRerun())
                        Assert.assertTrue(ele.getCssValue("stroke").contains("rgb(35, 115, 228)")); // LineColor

                    Assert.assertTrue(getTrendColDataTrendCol3().get(0).getText().contains("16.67%"));
                    Assert.assertTrue(getTrendColDataTrendCol3().get(1).getText().contains("-16.67%"));
                    Assert.assertTrue(getTrendColDataTrendCol3().get(2).getText().contains("0%"));
                    Assert.assertTrue(getTrendColDataTrendCol3().size() == 3);
                    logger.info("Validate Trend Details Columns data1 ended successfully");
                }

            } catch (Exception e) {
                System.out.println(e.getMessage());
            }
        } catch (Exception e) {
            setLogMessage("Validate Trend Details Columns data1 failed with error....\n" + e.getMessage().toString());
            logger.error("Validate Trend Details Columns data1 failed...");
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            e.printStackTrace();
            Assert.fail("Validate Trend Details Columns data1 failed...", e);
        }

        return new ProfileResultsPage(driver);
    }

    // Second Run
    public ProfileResultsPage validateTrendDetailsColsData2(String detailsTabData, String tc_id) throws SQLException {
        try {
            logger.info("Validate Trend Details Columns data2 started");
            boolean flag = false;
            String detailsPage = null;
            waitForElementToBeVisible(getRowDetailsSection());
            String[] resData = detailsTabData.split(";");
            try {
                if (resData[0].contains("Trend")) {
                    for (int i = 1; i < resData.length; i++) {
                        for (WebElement ele : gettrendColDataTrendCol1()) {
                            String headCol = ele.getText();
                            if (headCol.trim().contains(resData[i].trim())) {
                                flag = true;
                                break;
                            } else {
                                flag = false;
                            }
                        }
                    }
                    // Type Col Color Validation
                    logger.info("Validate Type col color started");
                    Assert.assertTrue(flag);
                    Assert.assertTrue(
                            getTrendNullDistinctCols().get(0).getCssValue("color").contains("rgba(236, 28, 36, 1)")); // Red
                    Assert.assertTrue(
                            getTrendNullDistinctCols().get(1).getCssValue("color").contains("rgba(0, 169, 187, 1)")); // Blue
                    Assert.assertTrue(
                            gettrendColDataTrendCol1().get(2).getCssValue("color").contains("rgba(51, 51, 51, 1)")); // Default
                    logger.info("Validate Type col color ended successfully");

                    logger.info("Validate Trend rerun dot color started");
                    for (WebElement ele : getTrendRerunFirstDot())
                        Assert.assertTrue(ele.getCssValue("fill").contains("rgb(35, 115, 228)")); // Blue
                    Assert.assertTrue(getTrendRerunFirstDot().size() == 3);

                    for (WebElement ele : getTrendRerunSecondDot())
                        Assert.assertTrue(ele.getCssValue("fill").contains("rgb(35, 115, 228)")); // Blue

                    for (WebElement ele : getTrendRerunThirdDot())
                        Assert.assertTrue(ele.getCssValue("fill").contains("rgb(255, 165, 0)")); // Orange
                    logger.info("Validate Trend rerun dot color ended successfully");

                    System.out.println(
                            "First line color:" + getTrendColDataTrendColsecondRerun().get(0).getCssValue("d"));
                    System.out.println(
                            "Second line color:" + getTrendColDataTrendColsecondRerun().get(1).getCssValue("d"));
                    System.out.println(
                            "Third line color:" + getTrendColDataTrendColsecondRerun().get(2).getCssValue("d"));
                    /*
                     * Assert.assertTrue(getTrendColDataTrendColsecondRerun().get(0).getCssValue(
                     * "d") .contains("M 5 5.49962 L 30 3 L 55 7")); // FirstLine //value has
                     * changed by a fraction to 5.50019, can be reverted once confirmed
                     */
                    Assert.assertTrue(getTrendColDataTrendColsecondRerun().get(1).getCssValue("d")
                            .contains("M 5 3 L 30 7 L 55 5.39952")); // SecondLine
                    Assert.assertTrue(getTrendColDataTrendColsecondRerun().get(2).getCssValue("d")
                            .contains("M 5 7 L 30 7 L 55 3")); // ThirdLine
                    Assert.assertTrue(getTrendColDataTrendColsecondRerun().get(0).getCssValue("d")
                            .contains("M 5 5.50019 L 30 3 L 55 7")); // FirstLine

                    for (WebElement ele : getTrendColDataTrendColsecondRerun())
                        Assert.assertTrue(ele.getCssValue("stroke").contains("rgb(35, 115, 228)")); // LineColor

                    Assert.assertTrue(getTrendColDataTrendCol3().get(0).getText().contains("-26.67%"));
                    Assert.assertTrue(getTrendColDataTrendCol3().get(1).getText().contains("6.67%"));
                    Assert.assertTrue(getTrendColDataTrendCol3().get(2).getText().contains("20%"));
                    logger.info("Validate Trend Details Columns data2 ended successfully");
                }

            } catch (Exception e) {
                System.out.println(e.getMessage());
            }
        } catch (Exception e) {
            setLogMessage("Validate Trend Details Columns data2 failed with error....\n" + e.getMessage().toString());
            logger.error("Validate Trend Details Columns data2 failed...");
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            e.printStackTrace();
            Assert.fail("Error", e);
        }

        return new ProfileResultsPage(driver);
    }

    public ProfileResultsPage validateorderOfValueFrequency(String profiledCols, String tc_id)
            throws InterruptedException, SQLException {
        try {
            logger.info("Validate Order of value frequency started");

            String[] cols = profiledCols.split(";");
            waitForAllElementsToPresent("[data-section='grid-results']");
            funcWait(2000);
            for (int i = 0; i < cols.length; i++) {
                List<String> valuesFrequencyOnLeftPane = new ArrayList<String>();
                List<String> top5ValueFrequencyOnLeftPane = new ArrayList<String>();
                List<String> mostFrequentValues = new ArrayList<String>();
                Set<String> setOfMostFrequentValues = new HashSet<>();
                System.out.println("Clicking on Profiled Column:" + cols[i]);
                funcWait(2000);
                clickOnParticularResultsCol(cols[i], tc_id);
                waitForElementToBeVisible(getBackToSummary());
                // Get most frequent values without their % detail
                for (WebElement ele : getMostFrequentOnlyValues()) {
                    if (!ele.getText().equals(" "))
                        setOfMostFrequentValues.add(ele.getText());
                }
                // Get Value Frequencies on Left pane
                for (WebElement ele : getvalueFrquenciesOnLeftPane()) {
                    if (!ele.getText().equals(" "))
                        valuesFrequencyOnLeftPane.add(ele.getText());
                }

                for (int j = 0; j < 5; j++) {
                    top5ValueFrequencyOnLeftPane.add(valuesFrequencyOnLeftPane.get(j));
                }
                //Sorting since the bug fix is not intended
                Collections.sort(top5ValueFrequencyOnLeftPane);
                Set<String> sortedMostFreqValues = new TreeSet<>(setOfMostFrequentValues);
                Assert.assertEquals(top5ValueFrequencyOnLeftPane, sortedMostFreqValues, "Expected was: " + top5ValueFrequencyOnLeftPane + "Actual was: " + setOfMostFrequentValues);
                logger.info("Validate Order of value frequency ended successfully");
                performClickOn(getBackToSummary());
                waitForElementToBeVisible(getResultsPageHeader());
                top5ValueFrequencyOnLeftPane.clear();
                valuesFrequencyOnLeftPane.clear();
                mostFrequentValues.clear();

            }
        } catch (Exception e) {
            setLogMessage("Validate Order of value frequency failed with error....\n" + e.getMessage().toString());
            logger.error("Validate Order of value frequency failed...");
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            e.printStackTrace();
            Assert.fail("Validate Order of value frequency failed...", e);
        }
        return new ProfileResultsPage(driver);

    }

    public ProfileResultsPage validateValueFrequencyData(String valueFrequencyData, String profiledCols, String tc_id) {
        try {
            logger.info("Validate value frequency started");
            String[] cols = profiledCols.split(";");
            String[] colsData = valueFrequencyData.split(";");
            List<String> actual = new ArrayList<String>();
            List<String> expected = new ArrayList<String>();

            if ((cols.length) == (colsData.length)) {
                for (int i = 0; i < cols.length; i++) {
                    // Taking expected data
                    logger.info("Taking expected data");
                    String al[] = colsData[i].split("#");
                    for (int j = 0; j < al.length; j++) {
                        expected.add(al[j]);
                    }
                    logger.info("Taking actual data");
                    System.out.println("Clicking on Profiled Column:" + cols[i]);
                    funcWait(2000);
                    clickOnParticularResultsCol(cols[i], tc_id);
                    funcWait(2000);
                    waitForElementToBeVisible(getBackToSummary());
                    for (WebElement ele : getValueFrequencyData()) {
                        if (!ele.getText().equals("") && !ele.getText().equals(" "))
                            actual.add(ele.getText());
                    }

                    System.out.println("Actual data is:" + actual);
                    System.out.println("Expected data is:" + expected);
                    Assert.assertEquals(actual, expected);
                    performClickOn(getBackToSummary());
                    waitForElementToBeVisible(getResultsPageHeader());
                    actual.clear();
                    expected.clear();
                }

            } else {
                logger.info("Columns list and column data list is not equal. Please validate");
                new PageObjectBase(driver, By.tagName("body")).takeSnapShot(tc_id + "_" + sourceMethod);
                Assert.fail();
            }
            logger.info("Validate Value Frequency Data completed");

        } catch (Exception e) {
            e.printStackTrace();
            logger.info("validate value frequency data failed with error");
            Assert.fail("Validate value frequency data failed", e);
        }
        return new ProfileResultsPage(driver);
    }

    public ProfileResultsPage validateValueFrequencyDataUsingMap(String valueFrequencyData, String profiledCols,
                                                                 String tc_id) throws SQLException {
        Map<String, List<String>> expectedValueFreqdata = new HashMap<>();
        Map<String, List<String>> expectedValueFreqdataSorted = new HashMap<>();
        Map<String, List<String>> actualValueFreqdataSorted = new HashMap<>();
        Map<String, List<String>> actualValueFreqdata = new HashMap<>();
        String[] cols = profiledCols.split(";");
        String[] colsData = valueFrequencyData.split(";");

        if ((cols.length) == (colsData.length)) {
            for (int i = 0; i < cols.length; i++) {
                expectedValueFreqdata.put(cols[i], Arrays.asList(colsData[i].split("#")));
            }

            System.out.println("Expected data:" + expectedValueFreqdata);
            for (int i = 0; i < cols.length; i++) {
                List<String> actual = new ArrayList<String>();
                System.out.println("Clicking on Profiled Column:" + cols[i]);
                funcWait(2000);
                clickOnParticularResultsCol(cols[i], tc_id);
                funcWait(2000);
                waitForElementToBeVisible(getBackToSummary());
                for (WebElement ele : getValueFrequencyData()) {
                    if (!ele.getText().equals("") && !ele.getText().equals(" ")) {
                        actual.add(ele.getText().trim());
                    }

                }
                actualValueFreqdata.put(cols[i].trim(), actual);
                performClickOn(getBackToSummary());
                waitForElementToBeVisible(getResultsPageHeader());
            }
            for (Map.Entry<String, List<String>> entry : expectedValueFreqdata.entrySet()) {
                Collections.sort(entry.getValue());
                expectedValueFreqdataSorted.put(entry.getKey(), entry.getValue());
            }
            for (Map.Entry<String, List<String>> entry : actualValueFreqdata.entrySet()) {
                Collections.sort(entry.getValue());
                actualValueFreqdataSorted.put(entry.getKey(), entry.getValue());
            }
            System.out.println("After sorting expected data:" + expectedValueFreqdataSorted);
            System.out.println("After sorting actual data:" + actualValueFreqdataSorted);

        }
        Assert.assertTrue(expectedValueFreqdataSorted.equals(actualValueFreqdataSorted));
        return new ProfileResultsPage(driver);
    }
    
    
	public List<String> getListOfValueFrequenciesForAParticularColumn(String tc_id) throws SQLException {
		List<String> actualValueFrequencies= new ArrayList<String>();
		waitForElementToBeVisible(getBackToSummary());
		for (WebElement ele : driver.findElements(By.xpath("//div[@data-section='fa-detail-grid']//tr//td[4]//span"))) {
			if (!ele.getText().equals("") && !ele.getText().equals(" ")) {
				actualValueFrequencies.add(ele.getText().trim());
			}
		}
		return actualValueFrequencies;
	}



    public ProfileResultsPage validateValueFrequencyDataWhenMaxtopNSetTo0(String profiledCols,
                                                                          String tc_id) throws SQLException {
        String[] cols = profiledCols.split(";");
        for (int i = 0; i < cols.length; i++) {
            System.out.println("Clicking on Profiled Column:" + cols[i]);
            funcWait(2000);
            clickOnParticularResultsCol(cols[i], tc_id);
            funcWait(2000);
            waitForElementToBeVisible(getBackToSummary());
            Assert.assertEquals(getValueFreqNoDataToDisplay().getText(), "No data to display", "Max Value Freq pair for column " + cols[i] + " is not null");
            Assert.assertEquals(getMostFreqValueNoDataToDisplay().getText(), "No data to display", "Most Frequent Value for column " + cols[i] + " is not null");
            performClickOn(getBackToSummary());
            waitForElementToBeVisible(getResultsPageHeader());
        }
        return new ProfileResultsPage(driver);
    }

    public ProfileResultsPage validateDetailsSectionColsData(String detailsTabColData, String profiledCols, String tc_id)
            throws InterruptedException, SQLException {
        try {
            logger.info("Validate Details Section Columns Data Started");
            List<String> actual = new ArrayList<String>();
            List<String> expected = new ArrayList<String>();
            List<String> widthPercentExpected = new ArrayList<String>();
            List<String> widthPercentActual = new ArrayList<String>();
            String[] cols = profiledCols.split(";");
            String[] colsData = detailsTabColData.split(";");
            // waitForElementToBeVisible(resultGridVScrollbar);
            WaitForObjectToVanish(".blockUI img");
            waitForAllElementsToPresent("[data-section='grid-results']");
            funcWait(2000);
            try {

                if ((cols.length) == (colsData.length)) {
                    for (int i = 0; i < cols.length; i++) {
                        if (i == 15) {
                            driver.navigate().refresh();
                            WebDriverWait wait = new WebDriverWait(driver, 10);
                            Alert alert = wait.until(ExpectedConditions.alertIsPresent());
                            alert.accept();
                            invisibilityOfLoaderImageWithTimeout(20);
                        }
                        int counter = 0;
                        System.out.println("Clicking on Profiled Column:" + cols[i]);
                        funcWait(2000);
                        clickOnParticularResultsCol(cols[i], tc_id);
                        WaitForObjectToVanish(".blockUI img");
                        waitForElementToBeVisible(getBackToSummary());
                        if (colsData[i].contains("Standard Deviation")) {
                            String al[] = colsData[i].split("@");
                            for (int j = 1; j < al.length; j++) {
                                if (al[j].contains("%"))
                                    widthPercentExpected.add(al[j]);
                            }
                            for (int j = 1; j < al.length; j++) {
                                expected.add(al[j]);
                            }
                            if (al[0].contains("DataTypes"))
                                for (WebElement ele : getDataTypeDetailsData()) {
                                    if (!ele.getText().equals(" "))
                                        actual.add(ele.getText());
                                }
                            else if (al[0].contains("Patterns"))
                                for (WebElement ele : getPatternsDetailsData()) {
                                    if (ele.getText().contains("NULL")) {
                                        if (!ele.getText().equals(" "))
                                            actual.add(ele.getText());
                                    } else if (!ele.getText().contains("NULL")) {
                                        if (!ele.getText().equals(" "))
                                            actual.add(ele.getText());
                                    }
                                    /*
                                     * if (ele.getText().contains("NULL")) counter = 1;
                                     */
                                }
                            else if (al[0].contains("Top 5"))
                                for (WebElement ele : getTopDetailsData()) {
                                    if (!ele.getText().equals(" "))
                                        actual.add(ele.getText());
                                }
                            else if (al[0].contains("Bottom 5"))
                                for (WebElement ele : getBottomDetailsData()) {
                                    if (!ele.getText().equals(" "))
                                        actual.add(ele.getText());
                                }
                            else if (al[0].contains("Most Frequent Values")) {
                                for (WebElement ele : getMostFreqValuesDetailsData()) {
                                    if (!ele.getText().equals(" "))
                                        actual.add(ele.getText());
                                }
                            } else if (al[0].contains("Numeric Column Statistics"))
                                for (WebElement ele : getNumericColumnDetailsData()) {
                                    if (!ele.getText().equals(" "))
                                        actual.add(ele.getText());
                                }
                            if (al[0].contains("DataTypes"))
                                for (WebElement ele : getDetailsTabDataTypeBarChart()) {
                                    String data = ele.getAttribute("style");
                                    widthPercentActual
                                            .add(data.substring(data.indexOf(":") + 1, data.indexOf("%")).trim() + "%");
                                }
                            else if (al[0].contains("Patterns"))
                                for (WebElement ele : getDetailsTabPatternsBarChart()) {
                                    String data = ele.getAttribute("style");
                                    widthPercentActual
                                            .add(data.substring(data.indexOf(":") + 1, data.indexOf("%")).trim() + "%");
                                }

                            System.out.println("Actual data is:" + actual);
                            System.out.println("Expected data is:" + expected);
                            /*
                             * System.out.println("Actual header is:"+getDetailsSectionHeaders().get(2).
                             * getText()); System.out.println("Expected  header is:"+al[0]);
                             */
                            if (al[0].contains("DataTypes"))
                                Assert.assertTrue(getDetailsSectionHeaders().get(1).getText().contains("Data Types"));
                            logger.info("Validate Details Section Headers for DataTypes Completed Successfully");
                            if (al[0].contains("Patterns"))
                                Assert.assertTrue(getDetailsSectionHeaders().get(2).getText().equals(al[0]));
                            logger.info("Validate Details Section Headers for Patterns Completed Successfully");
                            if (al[0].contains("Numeric Column Statistics"))
                                Assert.assertTrue(getDetailsSectionHeaders().get(4).getText().equals(al[0]));
                            logger.info(
                                    "Validate Details Section Headers for Numeric Column Details Completed Successfully");
                            if (al[0].contains("Most Frequent Values")) {
                                Assert.assertTrue(getDetailsSectionHeaders().get(3).getText().equals(al[0]));
                                logger.info(
                                        "Validate Details Section Headers for Most Frequent Values Completed Successfully");
                            }

                            Assert.assertEquals(actual, expected);
                            System.out.println("The actual and expected values match for:" + cols[i]);
                            if (al[0].contains("DataTypes") || al[0].contains("Patterns"))
                                Assert.assertEquals(widthPercentActual, widthPercentExpected);
                            logger.info("Validate Details Section Columns Data Completed Successfully");
                            performClickOn(getBackToSummary());
                            waitForElementToBeVisible(getResultsPageHeader());
                            actual.clear();
                            expected.clear();
                            widthPercentExpected.clear();
                            widthPercentActual.clear();
                        } else {
                            String al[] = colsData[i].split("#");
                            for (int j = 1; j < al.length; j++) {
                                if (al[j].contains("%"))
                                    widthPercentExpected.add(al[j]);
                            }
                            for (int j = 1; j < al.length; j++) {
                                expected.add(al[j]);
                            }
                            if (al[0].contains("DataTypes"))
                                for (WebElement ele : getDataTypeDetailsData()) {
                                    if (!ele.getText().equals(" "))
                                        actual.add(ele.getText().trim());
                                }
                            else if (al[0].contains("Patterns"))
                                for (WebElement ele : getPatternsDetailsData()) {
                                    if (ele.getText().contains("NULL")) {
                                        if (!ele.getText().equals(" "))
                                            actual.add(ele.getText());
                                    } else if (!ele.getText().contains("NULL")) {
                                        if (!ele.getText().equals(" "))
                                            actual.add(ele.getText());
                                    }
                                    /*
                                     * if (ele.getText().contains("NULL")) counter = 1;
                                     */
                                }
                            else if (al[0].contains("Top 5"))
                                for (WebElement ele : getTopDetailsData()) {
                                    if (!ele.getText().equals(" "))
                                        actual.add(ele.getText());
                                }
                            else if (al[0].contains("Bottom 5"))
                                for (WebElement ele : getBottomDetailsData()) {
                                    if (!ele.getText().equals(" "))
                                        actual.add(ele.getText());
                                }
                            else if (al[0].contains("Most Frequent Values")) {
                                for (WebElement ele : getMostFreqValuesDetailsData()) {
                                    if (!ele.getText().equals(" "))
                                        actual.add(ele.getText());
                                }
                            } else if (al[0].contains("Numeric Column Statistics"))
                                for (WebElement ele : getNumericColumnDetailsData()) {
                                    if (!ele.getText().equals(" "))
                                        actual.add(ele.getText());
                                }
                            if (al[0].contains("DataTypes"))
                                for (WebElement ele : getDetailsTabDataTypeBarChart()) {                              	
                                    String data = ele.getAttribute("style");
                                    widthPercentActual
                                            .add(data.substring(data.indexOf(":") + 1, data.indexOf("%")).trim() + "%");
                                }
                            else if (al[0].contains("Patterns"))
                                for (WebElement ele : getDetailsTabPatternsBarChart()) {
                                    String data = ele.getAttribute("style");
                                    widthPercentActual
                                            .add(data.substring(data.indexOf(":") + 1, data.indexOf("%")).trim() + "%");
                                }
                            System.out.println("abc");
                            System.out.println("Actual data is:" + actual);
                            System.out.println("Expected data is:" + expected);
                            System.out.println("Actual Width Percentage is:" + widthPercentActual);
                            System.out.println("Expected Width Percentage is:" + widthPercentExpected);
                            /*
                             * System.out.println("Actual header is:"+getDetailsSectionHeaders().get(2).
                             * getText()); System.out.println("Expected  header is:"+al[0]);
                             */
                            if (al[0].contains("DataTypes"))
                                Assert.assertTrue(getDetailsSectionHeaders().get(1).getText().contains("Data Types"));
                            logger.info("Validate Details Section Headers for DataTypes Completed Successfully");
                            if (al[0].contains("Patterns"))
                                Assert.assertTrue(getDetailsSectionHeaders().get(2).getText().equals(al[0]));
                            logger.info("Validate Details Section Headers for Patterns Completed Successfully");
                            if (al[0].contains("Numeric Column Statistics"))
                                Assert.assertTrue(getDetailsSectionHeaders().get(4).getText().equals(al[0]));
                            logger.info(
                                    "Validate Details Section Headers for Numeric Column Details Completed Successfully");
                            if (al[0].contains("Most Frequent Values")) {
                                Assert.assertTrue(getDetailsSectionHeaders().get(3).getText().equals(al[0]));
                                logger.info(
                                        "Validate Details Section Headers for Most Frequent Values Completed Successfully");
                            }
                            Collections.sort(actual);
                            Collections.sort(expected);
                            Assert.assertEquals(actual, expected);
                            System.out.println("The actual and expected values match for:" + cols[i]);
                            if (al[0].contains("DataTypes") || al[0].contains("Patterns"))
                                Assert.assertEquals(widthPercentActual, widthPercentExpected);
                            logger.info("Validate Details Section Columns Data Completed Successfully");
                            performClickOn(getBackToSummary());
                            waitForElementToBeVisible(getResultsPageHeader());
                            actual.clear();
                            expected.clear();
                            widthPercentExpected.clear();
                            widthPercentActual.clear();
                        }

                    }
                } else {
                    setLogMessage("The column list is not equal to column data list. Please check");
                    Assert.assertTrue(false, "The column list is not equal to column data list");
                }
            } catch (Exception e) {
                e.printStackTrace();
                Assert.fail("Exception: ", e);
            }
        } catch (Exception e) {
            setLogMessage("Validate Details Section Columns Data failed with error....\n" + e.getMessage().toString());
            logger.info("Validate Details Section Columns Data  failed...");
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            e.printStackTrace();
            Assert.fail("Validate Details Section Columns Data  failed...", e);

        }

        return new ProfileResultsPage(driver);
    }

    public ProfileResultsPage validateHoverTextForTrendCol(String detailsTabData, String tc_id) throws SQLException {
        try {
            logger.info("Validate Hover Text for Trend Column Started");
            List<String> actual = new ArrayList<String>();
            List<String> expected = new ArrayList<String>();
            String[] colsData = detailsTabData.split(";");
            try {
                waitForElementToBeVisible(getRowDetailsSection());
                waitForElementToBeVisible(getFirstRowOnResultsPage());
                funcWait(2000);
                performClickOn(getFirstRowOnResultsPage());
                funcWait(1000);
                waitForElementToBeVisible(getDetailsTab());
                funcWait(1000);
                // getResultsGridCols().get(0).click();
                for (int j = 0; j < colsData.length; j++) {
                    String[] resData = colsData[j].split("#");
                    for (int i = 1; i < resData.length; i++)
                        expected.add(resData[i].trim());
                    if (resData[0].contains("Trend")) {
                        for (WebElement ele : getTrendGraphHoverText())
                            if (!ele.getText().equals(" ")) {
                                actual.add(ele.getAttribute("data-q-title").trim());
                            }
                        if (resData[0].contains("DataTypes")) {
                            for (WebElement ele : getDetailsPageDataTypesHoverText())
                                if (!ele.getAttribute("data-q-title").isEmpty())
                                    actual.add(ele.getAttribute("data-q-title").trim());
                        }
                        if (resData[0].contains("Patterns")) {
                            for (WebElement ele : getDetailsPagePatternsHoverText())
                                if (!ele.getAttribute("data-q-title").isEmpty())
                                    actual.add(ele.getAttribute("data-q-title").trim());
                        }

                        if (resData[0].contains("Top 5")) {
                            for (WebElement ele : getDetailsPageMostFreqValuesHoverText())
                                if (!ele.getAttribute("data-q-title").isEmpty())
                                    actual.add(ele.getAttribute("data-q-title").trim());
                        }

                        if (resData[0].contains("Bottom 5")) {
                            for (WebElement ele : getDetailsPageLeastFreqValuesHoverText())
                                if (!ele.getAttribute("data-q-title").isEmpty())
                                    actual.add(ele.getAttribute("data-q-title").trim());
                        }

                        Assert.assertEquals(actual, expected);
                        setLogMessage("Validate Hover Text for Trend Column ended successfully");
                        actual.clear();
                        expected.clear();
                    }
                }
            } catch (Exception e) {
                System.out.println(e.toString());
            }
        } catch (Exception e) {
            setLogMessage("Validate Hover Text for Trend Column failed with error....\n" + e.getMessage().toString());
            logger.error("Validate Hover Text for Trend Column failed...");
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            e.printStackTrace();
            Assert.fail("ERROR", e);
        }

        return new ProfileResultsPage(driver);
    }

    public ProfileResultsPage validateResultsGridData(String detailsTabHeaders, String baselineFileName, String tc_id,
                                                      String profileName, String runKey) throws InvocationTargetException, InterruptedException, SQLException {
        ProfileResultsPage profileResultPage = validateResultsGridData(detailsTabHeaders, baselineFileName, tc_id,
                profileName, runKey, 10);
        return profileResultPage;
    }


    public ProfileResultsPage validateResultsGridData(String detailsTabHeaders, String baselineFileName, String tc_id,
                                                      String profileName, String runKey, int offSet) throws InvocationTargetException, InterruptedException, SQLException {
        waitForResultPageToLoad(tc_id);
        logger.info("Validate Results Grid Data Started");
        String baselineFilePath = System.getProperty("user.dir") + "/src/test/resources/BaselineJsons/"
                + System.getProperty("agentOS").toLowerCase() + "/" + System.getProperty("sourceType").toLowerCase()
                + "/" + baselineFileName;
        List<String> actual = new ArrayList<String>();
        List<String> expected = new ArrayList<String>();
        List<String> resultsGridProfiledCols = new ArrayList<String>();
        SortedMap<String, Map<String, String>> resultsGridData = new TreeMap<>();
        SortedMap<String, Map<String, String>> baseLine = new TreeMap<>();
        String[] colsData = detailsTabHeaders.split(";");
        List<WebElement> listOfHorizontalColumns = driver.findElements(By.xpath("//div[@data-section='grid-results']//tr[contains(@class,'header__row')]//span[text()]"));
        waitForAllElementsToPresent("[data-section='grid-results'] div[data-grid-col-name='columnName']");
        List<String> columnHeaders = Arrays.asList("nulPercent", "nulCount", "distinctPercent", "distinctCount", "duplicatePercent", "duplicateCount", "totalPatterns", "topPatternPercent", "maximumLength", "maximumValue", "minimumLength", "minimumValue", "blankCount", "blankPercent");
        String cellValue = "";
        if (new File(baselineFilePath).exists()) {
            logger.info(listOfHorizontalColumns.size() + "");
            for (int m = 0; m < listOfHorizontalColumns.size(); m++) {
                if (!listOfHorizontalColumns.get(m).getText().isEmpty()
                        && listOfHorizontalColumns.get(m).isDisplayed()) {
                    actual.add(listOfHorizontalColumns.get(m).getText());
                    if (m < listOfHorizontalColumns.size() - 1) {
                        while (!listOfHorizontalColumns.get(m + 1).isDisplayed())
                            getResultGridHorizontalScrollbar().click();
                    }
                }
            }
            resultsGridProfiledCols = scrollAndGetColumnList();
            System.out.println("Results grid Size is:" + resultsGridProfiledCols.size());
            Map<String, String> colDataMap = new TreeMap<>();
            boolean flag = false;
            for (int i = 0; i < resultsGridProfiledCols.size(); i++) {
                colDataMap = new TreeMap<>();
                for (int k = 0; k < columnHeaders.size(); k++) {
                    try {
                        driver.manage().timeouts().implicitlyWait(20, TimeUnit.SECONDS);
                        if (flag) {
                            if (k >= 6) {
                                cellValue = driver.findElement(By.xpath(rowDataValuesForLastSixElements.replace("#CELLNAME#", columnHeaders.get(k)).replace("#i#", String.valueOf(i + 3)))).getText();
                            } else {
                                cellValue = driver.findElement(By.xpath(rowDataValues.replace("#CELLNAME#", columnHeaders.get(k)).replace("#i#", String.valueOf(i + 3)))).getText();
                            }
                        } else {
                            if (k >= 6) {
                                cellValue = driver.findElement(By.xpath(rowDataValuesForLastSixElements.replace("#CELLNAME#", columnHeaders.get(k)).replace("#i#", String.valueOf(i + 2)))).getText();
                            } else {
                                cellValue = driver.findElement(By.xpath(rowDataValues.replace("#CELLNAME#", columnHeaders.get(k)).replace("#i#", String.valueOf(i + 2)))).getText();
                            }
                        }
                    } catch (Exception e) {
                        if (k >= 6) {
                            cellValue = driver.findElement(By.xpath(rowDataValuesForLastSixElements.replace("#CELLNAME#", columnHeaders.get(k)).replace("#i#", String.valueOf(i + 3)))).getText();
                        } else {
                            cellValue = driver.findElement(By.xpath(rowDataValues.replace("#CELLNAME#", columnHeaders.get(k)).replace("#i#", String.valueOf(i + 3)))).getText();
                        }
                        flag = true;
                    } finally {
                        if (!System.getProperty("exec.args").contains("QAPOD")) {
                            driver.manage().timeouts().implicitlyWait(300, TimeUnit.SECONDS);
                        } else {
                            driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
                        }
                    }
                    colDataMap.put(actual.get(k + 2), cellValue);
                }
                resultsGridData.put(resultsGridProfiledCols.get(i), colDataMap);

            }

            System.out.println("Results Grid Data Is:" + resultsGridData);
            baseLine = convertResultsGridBaselineJsonToUICompatableMap(baselineFilePath);
            System.out.println("======================ActualData===========================");
            resultsGridData.entrySet().stream()
                    .forEach(e -> System.out.println("Key : " + e.getKey() + " value : " + e.getValue()));
            Assert.assertEquals(resultsGridData, baseLine, "Baseline Grid Data and Actual Grid data is not equal");
            for (int j = 0; j < colsData.length; j++)
                expected.add(colsData[j]);
            Assert.assertEquals(actual, expected);
            setLogMessage("Validate Results Grid Data Ended Successfully");
        } else {
            String profileId = exploreModuleApiUtils.getProfileIdByRepoHandleName(profileName);
            Response allProfileJson = exploreModuleApiUtils.getResultForAllTheColumn(profileId, runKey);
            String response = allProfileJson.asString();
            System.out.println(response);
            exploreModuleApiUtils.createNewBaseLine(response, baselineFilePath);
            Assert.fail("Kindly validate the new baseline created, replace _verify in the name and run the test again");
        }
        actual.clear();
        expected.clear();
        resultsGridProfiledCols.clear();
        resultsGridData.clear();
        return new ProfileResultsPage(driver);
    }

    public ProfileResultsPage validateResultsGridDataSEUser(String detailsTabHeaders, String baselineFileName, String tc_id,
                                                      String profileName, String runKey, int offSet) throws InvocationTargetException, InterruptedException, SQLException {
        waitForResultPageToLoad(tc_id);
        logger.info("Validate Results Grid Data Started");
        String baselineFilePath = System.getProperty("user.dir") + "/src/test/resources/BaselineJsons/"
                + System.getProperty("agentOS").toLowerCase() + "/" + System.getProperty("sourceType").toLowerCase()
                + "/" + baselineFileName;
        List<String> actual = new ArrayList<String>();
        List<String> expected = new ArrayList<String>();
        List<String> resultsGridProfiledCols = new ArrayList<String>();
        SortedMap<String, Map<String, String>> resultsGridData = new TreeMap<>();
        SortedMap<String, Map<String, String>> baseLine = new TreeMap<>();
        String[] colsData = detailsTabHeaders.split(";");
        List<WebElement> listOfHorizontalColumns = driver.findElements(By.xpath("//div[@data-section='grid-results']//tr[contains(@class,'header__row')]//span[text()]"));
        waitForAllElementsToPresent("[data-section='grid-results'] div[data-grid-col-name='columnName']");
        List<String> columnHeaders = Arrays.asList("nulPercent", "nulCount", "distinctPercent", "distinctCount", "duplicatePercent", "duplicateCount", "totalPatterns", "topPatternPercent", "maximumLength", "minimumLength", "blankCount", "blankPercent");
        String cellValue = "";
        if (new File(baselineFilePath).exists()) {
            logger.info(listOfHorizontalColumns.size() + "");
            for (int m = 0; m < listOfHorizontalColumns.size(); m++) {
                if (!listOfHorizontalColumns.get(m).getText().isEmpty()
                        && listOfHorizontalColumns.get(m).isDisplayed()) {
                    actual.add(listOfHorizontalColumns.get(m).getText());
                    if (m < listOfHorizontalColumns.size() - 1) {
                        while (!listOfHorizontalColumns.get(m + 1).isDisplayed())
                            getResultGridHorizontalScrollbar().click();
                    }
                }
            }
            resultsGridProfiledCols = scrollAndGetColumnList();
            System.out.println("Results grid Size is:" + resultsGridProfiledCols.size());
            Map<String, String> colDataMap = new TreeMap<>();
            boolean flag = false;
            for (int i = 0; i < resultsGridProfiledCols.size(); i++) {
                colDataMap = new TreeMap<>();
                for (int k = 0; k < columnHeaders.size(); k++) {
                    try {
                        driver.manage().timeouts().implicitlyWait(20, TimeUnit.SECONDS);
                        if (flag) {
                            if (k >= 6) {
                                cellValue = driver.findElement(By.xpath(rowDataValuesForLastSixElements.replace("#CELLNAME#", columnHeaders.get(k)).replace("#i#", String.valueOf(i + 3)))).getText();
                            } else {
                                cellValue = driver.findElement(By.xpath(rowDataValues.replace("#CELLNAME#", columnHeaders.get(k)).replace("#i#", String.valueOf(i + 3)))).getText();
                            }
                        } else {
                            if (k >= 6) {
                                cellValue = driver.findElement(By.xpath(rowDataValuesForLastSixElements.replace("#CELLNAME#", columnHeaders.get(k)).replace("#i#", String.valueOf(i + 2)))).getText();
                            } else {
                                cellValue = driver.findElement(By.xpath(rowDataValues.replace("#CELLNAME#", columnHeaders.get(k)).replace("#i#", String.valueOf(i + 2)))).getText();
                            }
                        }
                    } catch (Exception e) {
                        if (k >= 6) {
                            cellValue = driver.findElement(By.xpath(rowDataValuesForLastSixElements.replace("#CELLNAME#", actual.get(k)).replace("#i#", String.valueOf(i + 3)))).getText();
                        } else {
                            cellValue = driver.findElement(By.xpath(rowDataValues.replace("#CELLNAME#", actual.get(k)).replace("#i#", String.valueOf(i + 3)))).getText();
                        }
                        flag = true;
                    } finally {
                        if (!System.getProperty("exec.args").contains("QAPOD")) {
                            driver.manage().timeouts().implicitlyWait(300, TimeUnit.SECONDS);
                        } else {
                            driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
                        }
                    }
                    colDataMap.put(actual.get(k + 2), cellValue);
                }
                resultsGridData.put(resultsGridProfiledCols.get(i), colDataMap);

            }

            System.out.println("Results Grid Data Is:" + resultsGridData);
            baseLine = convertResultsGridBaselineJsonToUICompatableMap(baselineFilePath);
            System.out.println("======================ActualData===========================");
            resultsGridData.entrySet().stream()
                    .forEach(e -> System.out.println("Key : " + e.getKey() + " value : " + e.getValue()));
            Assert.assertEquals(resultsGridData, baseLine, "Baseline Grid Data and Actual Grid data is not equal");
            for (int j = 0; j < colsData.length; j++)
                expected.add(colsData[j]);
            Assert.assertEquals(actual, expected);
            setLogMessage("Validate Results Grid Data Ended Successfully");
        } else {
            String profileId = exploreModuleApiUtils.getProfileIdByRepoHandleName(profileName);
            Response allProfileJson = exploreModuleApiUtils.getResultForAllTheColumn(profileId, runKey);
            String response = allProfileJson.asString();
            System.out.println(response);
            exploreModuleApiUtils.createNewBaseLine(response, baselineFilePath);
            Assert.fail("Kindly validate the new baseline created, replace _verify in the name and run the test again");
        }
        actual.clear();
        expected.clear();
        resultsGridProfiledCols.clear();
        resultsGridData.clear();
        return new ProfileResultsPage(driver);
    }

    private SortedMap<String, List<String>> getValueChartDatafromBaseline(String path) {
        logger.info("Get value chart data from baseline started");
        SortedMap<String, List<String>> finalBaseline = new TreeMap<>();
        List<String> mData = new ArrayList<>();
        String pathToCapture[] = {"value/columnName"};
        Map<String, Object> jsonMap = validateBaseLines.getBaseLineAsMap(" ", false, path, pathToCapture);

        for (Entry<String, Object> entry : jsonMap.entrySet()) {
            String key = entry.getKey().replace("value_columnName_", "");
            String value = new String(entry.getValue().toString());
            if (!key.contains("@odata.context") && !key.contains("value")) {
                mData = getValueDistChartData(value);
                finalBaseline.put(key, mData);
            }
        }

        /*
         * System.out.println(
         * "======================BaselineData===========================");
         * finalBaseline.entrySet().stream() .forEach(e -> System.out.println("Key : " +
         * e.getKey() + " value : " + e.getValue()));
         */
        logger.info("Get value chart data from baseline ended successfully");
        return finalBaseline;
    }

    private Map<String, String> convertColNamesToUIformat(String value) {
        logger.info("Convert Column Names to UI format started");
        Map<String, String> mData = new TreeMap<>();
        String[] sp = value.split(",");
        try {
            for (int i = 0; i < sp.length; i++) {
                if (sp[i].contains("nulPercent")) {
                    String val = sp[i].replace("nulPercent", "% Null");
                    String data = convertDataToPercentageAndRoundOftoTwoValues(val);
                    String[] fData = data.split("=");
                    if (fData.length >= 2) {
                        mData.put(fData[0].trim(), fData[1].trim());
                    } else
                        mData.put(fData[0].trim(), "");
                }
                if (sp[i].contains("nulCount")) {
                    String val = sp[i].replace("nulCount", "# Null");
                    String[] fData = val.split("=");
                    if (fData.length >= 2)
                        mData.put(fData[0].trim(), fData[1].trim());
                    else
                        mData.put(fData[0].trim(), "");
                }
                if (sp[i].contains("distinctPercent")) {
                    String val = sp[i].replace("distinctPercent", "% Distinct");
                    String data = convertDataToPercentageAndRoundOftoTwoValues(val);
                    String[] fData = data.split("=");
                    if (fData.length >= 2)
                        mData.put(fData[0].trim(), fData[1].trim());
                    else
                        mData.put(fData[0].trim(), "");
                }
                if (sp[i].contains("distinctCount")) {
                    String val = sp[i].replace("distinctCount", "# Distinct");
                    String[] fData = val.split("=");
                    if (fData.length >= 2)
                        mData.put(fData[0].trim(), fData[1].trim());
                    else
                        mData.put(fData[0].trim(), "");
                }
                if (sp[i].contains("duplicatePercent")) {
                    String val = sp[i].replace("duplicatePercent", "% Non-distinct");
                    String data = convertDataToPercentageAndRoundOftoTwoValues(val);
                    String[] fData = data.split("=");
                    if (fData.length >= 2)
                        mData.put(fData[0].trim(), fData[1].trim());
                    else
                        mData.put(fData[0].trim(), "");
                }
                if (sp[i].contains("duplicateCount")) {
                    String val = sp[i].replace("duplicateCount", "# Non-distinct");
                    String[] fData = val.split("=");
                    if (fData.length >= 2)
                        mData.put(fData[0].trim(), fData[1].trim());
                    else
                        mData.put(fData[0].trim(), "");
                }
                if (sp[i].contains("totalPatterns")) {
                    String val = sp[i].replace("totalPatterns", "# Patterns");
                    String[] fData = val.split("=");
                    if (fData.length >= 2)
                        mData.put(fData[0].trim(), fData[1].trim());
                    else
                        mData.put(fData[0].trim(), "");
                }
                if (sp[i].contains("topPatternPercent")) {
                    String val = sp[i].replace("topPatternPercent", "% of Top Pattern");
                    String data = convertDataToPercentageAndRoundOftoTwoValues(val);
                    String[] fData = data.split("=");
                    if (fData.length >= 2)
                        mData.put(fData[0].trim(), fData[1].trim());
                    else
                        mData.put(fData[0].trim(), "");
                }
				/*if (sp[i].contains("zeroCount")) {
					String val = sp[i].replace("zeroCount", "# Zero");
					String[] fData = val.split("=");
					if (fData.length >= 2) {
						mData.put(fData[0].trim(), fData[1].trim());
					} else
						mData.put(fData[0].trim(), "");
				}
				if (sp[i].contains("zeroPercent")) {
					String val = sp[i].replace("zeroPercent", "% Zero");
					String data = convertDataToPercentageAndRoundOftoTwoValues(val);
					String[] fData = data.split("=");
					if (fData.length >= 2) {
						mData.put(fData[0].trim(), fData[1].trim());
					} else
						mData.put(fData[0].trim(), "");
				}*/
                if (sp[i].contains("blankCount")) {
                    String val = sp[i].replace("blankCount", "# Blank");
                    String[] fData = val.split("=");
                    if (fData.length >= 2) {
                        mData.put(fData[0].trim(), fData[1].trim());
                    } else
                        mData.put(fData[0].trim(), "");
                }
                if (sp[i].contains("blankPercent")) {
                    String val = sp[i].replace("blankPercent", "% Blank");
                    String data = convertDataToPercentageAndRoundOftoTwoValues(val);
                    String[] fData = data.split("=");
                    if (fData.length >= 2) {
                        mData.put(fData[0].trim(), fData[1].trim());
                    } else
                        mData.put(fData[0].trim(), "");
                }

                if (sp[i].contains("maximumLength")) {
                    String val = sp[i].replace("maximumLength", "Maximum Length");
                    String[] fData = val.split("=");
                    if (fData.length >= 2)
                        mData.put(fData[0].trim(), fData[1].trim());
                    else
                        mData.put(fData[0].trim(), "");
                }
                if (sp[i].contains("maximumValue")) {
                    String val = sp[i].replace("maximumValue", "Maximum Value");
                    String[] fData = val.split("=");
                    if (fData.length >= 2)
                        mData.put(fData[0].trim(), fData[1].trim());
                    else
                        mData.put(fData[0].trim(), "");
                }
                if (sp[i].contains("minimumLength")) {
                    String val = sp[i].replace("minimumLength", "Minimum Length");
                    String[] fData = val.split("=");
                    if (fData.length >= 2)
                        mData.put(fData[0].trim(), fData[1].trim());
                    else
                        mData.put(fData[0].trim(), "");
                }
                if (sp[i].contains("minimumValue")) {
                    String val = sp[i].replace("minimumValue", "Minimum Value");
                    String[] fData = val.split("=");
                    if (fData.length >= 2)
                        mData.put(fData[0].trim(), fData[1].trim());
                    else
                        mData.put(fData[0].trim(), "");
                }

            }
        } catch (Exception e) {
            System.out.println(e.toString());
            logger.error("Convert Column Names to UI format failed with error...." + e.getMessage().toString());
            Assert.fail("Convert Column Names to UI format failed..", e);
        }
        logger.info("Convert Column Names to UI format ended successfully");
        return mData;
    }

    private String convertDataToPercentageAndRoundOftoTwoValues(String val) {
        logger.info("Convert Data to Percentage and round of to two values started");
        String value = val;
        String dat = "";
        if (value.contains(".")) {
            String data[] = val.split("\\.");
            if (data[1].length() >= 2) {
                double temp = Double.parseDouble(value.split("=")[1]);
                temp = Math.round(temp * 100.0) / 100.0;
                dat = value.split("=")[0] + "=" + Double.toString(temp) + "%";
            } else {
                dat = data[0] + "." + data[1].substring(0, 1) + "%";
            }
        } else if (value.contains("=0")) {
            dat = value + "%";
        } else {
            dat = value + "%";
        }
        logger.info("Convert Data to Percentage and round of to two values completed successfully");
        return dat;
    }

    public List<String> getAllResultColumns() {
        List<String> columnNames = new ArrayList<String>();
        try {
            logger.info("Get All Result Columns started");
            List<WebElement> list = getResultsGridColsForValidation();
            for (WebElement element : list) {
                String columnName = element.getAttribute("data-column-name");
                columnNames.add(columnName.trim());
            }
        } catch (StaleElementReferenceException e) {
            List<WebElement> list = getResultsGridColsForValidation();
            for (WebElement element : list) {
                String columnName = element.getAttribute("data-column-name");
                columnNames.add(columnName.trim());
            }
        }
        logger.info("Get All Result Columns ended successfully");
        return columnNames;

    }

    public SortedMap<String, SortedMap<String, String>> getAllResultsData(List<WebElement> elements) {
        logger.info("Get All Result Data started");
        SortedMap<String, String> valueList = new TreeMap<>();
        List<WebElement> listCols = getProfResultsGridHorizontalCols();
        try {
            String data = " ";
            int k = 2;
            for (int j = 2; j < listCols.size(); j++) {
                if (!listCols.get(j).getText().isEmpty()) {
                    try {
                        data = elements.get(k).getText();
                    } catch (StaleElementReferenceException e) {
                        System.out.println(e.toString());
                        data = elements.get(k).getText();
                    }
                    if (k < 18)
                        k++;
                    valueList.put(listCols.get(j).getText(), data);
                } else {
                    getResultGridHorizontalScrollbar().click();
                    getResultGridHorizontalScrollbar().click();
                    data = elements.get(k).getText();
                    if (k < 18)
                        k++;
                    valueList.put(listCols.get(j).getText().trim(), data.trim());
                }

                if (getResultGridHorizontalScrollbar().isDisplayed())
                    getResultGridHorizontalScrollbar().click();
            }

        } catch (Exception e) {
            System.out.println(e.getMessage());
            /*
             * Assert.fail("Get All Results Data failed with error...." +
             * e.getMessage().toString());
             */
        }
        logger.info("Get All Result Data completed successfully");
        try {
            data.put(elements.get(0).getText().trim(), valueList);
        } catch (Exception e) {
            System.out.println(e.toString());
            /*
             * Assert.fail("Get All Results Data failed with error...." +
             * e.getMessage().toString());
             */
        }
        return data;
    }

    public ArrayList<String> scrollAndGetColumnList() throws InvocationTargetException, InterruptedException {
        logger.info("Scroll and Get Column List Started");
        boolean flag = false;
        List<String> res = null;
        res = getAllResultColumns();
/*		while (!flag) {
			res = getAllResultColumns();
			if (getResultGridDownScrollbar().isDisplayed())
				// getResultGridDownScrollbar().click();
				new Actions(driver).clickAndHold(resultGridVScrollbar).moveByOffset(0, 13).release().perform();
			else
				flag = true;
		}*/
        ArrayList<String> al = new ArrayList<String>();
        for (String set : res)
            al.add(set);
/*
		while (getResultsGridVerticalScrollBarup().isDisplayed())
			getResultsGridVerticalScrollBarup().click();*/
        logger.info("Scroll and Get Column List Ended successfully");
        return al;
    }

    public SortedMap<String, SortedMap<String, String>> scrollAndGetResutsGridData(List<WebElement> ele)
            throws InvocationTargetException, InterruptedException {
        logger.info("Scroll and Get Results Grid Data Started");
        boolean flag = false;
        while (!flag) {
            res = getAllResultsData(ele);
            if (res.size() > 0)
                flag = true;
        }
        while (getResultsGridHorizontalScrollBarLeft().isDisplayed())
            getResultsGridHorizontalScrollBarLeft().click();
        logger.info("Scroll and Get Results Grid Data Completed Successfully");
        return res;
    }

    public List<String> getValueDistributionChartDetails(String ele)
            throws InvocationTargetException, InterruptedException {
        logger.info("Get Value Distribution Chart Details Started");
        boolean flag = false;
        List<String> chartData = new ArrayList<>();
        try {
            while (!flag) {
                chartData = getAllValueDistChartDetails(ele);
                if (chartData.size() > 0)
                    flag = true;
            }
        } catch (Exception e) {
            System.out.println(e.toString());
            logger.error("Get Value Distribution Chart Details failed");
            Assert.fail("Get Value Distribution Chart Details failed", e);
        }
        logger.info("Get Value Distribution Chart Details Completed Successfully");
        return chartData;
    }

    public ProfileResultsPage validateValueDistributionChart() throws InvocationTargetException, InterruptedException {
        logger.info("Validate Value Distribution Chart Started");
        List<String> actual = new ArrayList<String>();
        List<String> expected = new ArrayList<String>();
        SortedMap<String, List<String>> resultsGridData = new TreeMap<>();
        SortedMap<String, List<String>> baseLine = new TreeMap<>();
        List<String> profCols = new ArrayList<>();
        profCols = scrollAndGetColumnList();
        int l = 0;
        try {
            baseLine = getValueChartDatafromBaseline(System.getProperty("user.dir")
                    + "/src/test/resources/BaselineJsons/CP_ALL_SUP_DATA_TYPES_32_COLUMN_RESULTS.json");

            for (int i = 0; i < profCols.size(); i++) {
                String valChart1 = "div[data-section='grid-results'] tr[class*='body__row']:nth-of-type(#i#) td[data-id='distribution'] div>div";
                List<WebElement> valDistChartData = getListWebElementFromCssStringForProfileResult(valChart1.replace("#i#", String.valueOf(i + 2)));
                List<String> values = new ArrayList<>();
                values = getValueDistributionChartDetails(valChart1.replace("#i#", String.valueOf(i + 2)));
                resultsGridData.put(profCols.get(i), values);
            }
            logger.info("Baseline Data Is:" + baseLine);
            logger.info("Results Grid Data Is:" + resultsGridData);
            Assert.assertTrue(baseLine.equals(resultsGridData), "Baseline Grid Data and Actual Grid data is not equal");

            logger.info("Actual Data Is:" + actual);
            logger.info("Expected Data Is:" + expected);
            Assert.assertEquals(actual, expected);
            actual.clear();
            expected.clear();
            resultsGridData.clear();
            logger.info("Validate Value Distribution Chart Ended Successfully");
        } catch (Exception e) {
            System.out.println(e.toString());
            logger.error("Validate value distribution chart failed");
            Assert.fail("Validate value distribution chart failed", e);
        }
        return new ProfileResultsPage(driver);

    }

    public List<String> getAllValueDistChartDetails(String elements) {
        logger.info("Get All Value Distribution Chart Details Started");
        List<String> data = new ArrayList<>();
        List<String> res = new ArrayList<>();
        String[] split;
        String value = "";
        List<WebElement> ele = getListWebElementFromCssString(elements);
        try {
            for (WebElement element : ele) {
                data.add(element.getAttribute("style"));
            }
            for (String val : data) {
                split = val.split(";");
                value += " " + split[0] + "=" + split[1] + ",";
            }
        } catch (Exception e) {
            System.out.println(e.toString());
        }
        String rData[] = value.split("\\),");
        for (String dataAdd : rData)
            res.add(dataAdd + ")");
        logger.info("Get All Value Distribution Chart Details Ended successfully");
        Collections.sort(res);
        return res;
    }

    private SortedMap<String, Map<String, String>> convertResultsGridBaselineJsonToUICompatableMap(String path) {
        logger.info("Convert Results Grid Baseline Json To UI Compatible Map Started");
        SortedMap<String, Map<String, String>> finalBaseline = new TreeMap<>();
        Map<String, String> mData = new TreeMap<String, String>();
        String pathToCapture[] = {"value/columnName"};
        Map<String, Object> jsonMap = validateBaseLines.getBaseLineAsMap(" ", false, path, pathToCapture);

        for (Entry<String, Object> entry : jsonMap.entrySet()) {
            String key = entry.getKey().replace("value_columnName_", "");
            String value = new String(entry.getValue().toString());
            mData = convertColNamesToUIformat(value);
            if (!key.contains("@odata.context") && !key.contains("value"))
                finalBaseline.put(key, mData);
        }

        System.out.println("======================BaselineData===========================");
        finalBaseline.entrySet().stream()
                .forEach(e -> System.out.println("Key : " + e.getKey() + " value : " + e.getValue()));
        logger.info("Convert Results Grid Baseline Json To UI Compatible Map Ended Successfully");
        return finalBaseline;
    }

    private List<String> getValueDistChartData(String value) {
        logger.info("Get value distribution chart data started");
        String mData = "";
        List<String> sort = new ArrayList<>();
        String[] sp = value.split(",");
        try {
            for (int i = 0; i < sp.length; i++) {
                if (sp[i].contains("nulPercent")) {
                    String val = sp[i].replace("nulPercent", "width: ");
                    String data = convertDataToPercentageAndRoundOftoTwoValues(val);
                    String[] fData = data.split("=");
                    if (fData.length >= 2) {
                        mData += fData[0] + fData[1] + "=" + " " + "background: rgb(236, 28, 36)" + ",";
                    } else
                        mData += data + "=" + " " + "background: rgb(236, 28, 36)" + ",";
                }
                if (sp[i].contains("distinctPercent")) {
                    String val = sp[i].replace("distinctPercent", "width: ");
                    String data = convertDataToPercentageAndRoundOftoTwoValues(val);
                    String[] fData = data.split("=");
                    if (fData.length >= 2)
                        mData += fData[0] + fData[1] + "=" + " " + "background: rgb(0, 169, 187)" + ",";
                    else
                        mData += data.trim() + "=" + " " + "background: rgb(0, 169, 187)" + ",";
                }

                if (sp[i].contains("duplicatePercent")) {
                    String val = sp[i].replace("duplicatePercent", "width: ");
                    String data = convertDataToPercentageAndRoundOftoTwoValues(val);
                    String[] fData = data.split("=");
                    if (fData.length >= 2)
                        mData += fData[0] + fData[1] + "=" + " " + "background: rgb(0, 0, 0)" + ",";
                    else
                        mData += data.trim() + "=" + " " + "background: rgb(0, 0, 0)" + ",";
                }

            }
            String split[] = mData.split("\\),");
            for (String dAta : split)
                sort.add(dAta + ")");
            Collections.sort(sort);
        } catch (Exception e) {
            System.out.println(e.toString());
            logger.error("Get value distribution chart data failed");
            Assert.fail("Get value distribution chart data failed", e);
        }
        logger.info("Get value distribution chart data ended successfully");
        return sort;
    }

    public ProfileResultsPage validateResultsGridColsColor() {
        logger.info("Validate Results Grid Cols Color Started");
        List<WebElement> ele = driver.findElements(By.cssSelector("[data-section='grid-results'] th[class*='table__header__cell'] span[class*='color']"));
        WaitForObjectToVanish(".blockUI img");
        for (WebElement e : ele) {
            waitForElementToBeVisible(e);
            String col = e.getText();
            if (col.equals("% Null") || col.equals("# Null")) {
                String color = e.getCssValue("color");
                Assert.assertEquals(color, "rgba(236, 28, 36, 1)");
            }
            if (col.equals("% Distinct") || col.equals("# Distinct")) {
                String color = e.getCssValue("color");
                Assert.assertEquals(color, "rgba(0, 169, 187, 1)");
            }
            if (col.equals("% Non-Distinct") || col.equals("# Non-Distinct")) {
                String color = e.getCssValue("color");
                Assert.assertEquals(color, "rgba(0, 0, 0, 1)");
            }
        }
        logger.info("Validate Results Grid Cols Color Completed Successfully");
        return new ProfileResultsPage(driver);
    }

    public ProfileResultsPage validateDetailstabRuleDetails(String ruleName, String ruleDesc, String inputCols,
                                                            String outputCols, String profCol, String ruleType, String location, String tc_id) throws SQLException {
        try {
            logger.info("Validate Details Tab Rule Details Started");
            WaitForObjectToVanish(".blockUI img");
            // uncomment after bug is resolved
            selectParticularResultsCol(profCol, tc_id);
            invisibilityOfElementOfGivenSelectorWithTimeout(20, "div[class='frequency-analysis-container'] div[class*='loader__message']");
            // uncomment after bug is resolved
            waitForElementToBeVisible(getBackToSummary());
            invisibilityOfElementOfGivenSelectorWithTimeout(20, "div[class*='row-details-section'] div[class*='loader__message']");
            selectRowDetailsTabs("Rules");
            WaitForObjectToVanish(".blockUI img");
            String headerAssociatedRules = "", headerRule = "";
            for (int i = 0; i < getRulesTabHeaders().size(); i++) {
                if (getRulesTabHeaders().get(i).getText().contains("Associated Rules")) {
                    headerAssociatedRules = getRulesTabHeaders().get(i).getText();
                } else if (getRulesTabHeaders().get(i).getText().contains(ruleName)) {
                    headerRule = getRulesTabHeaders().get(i).getText();
                }
            }
            Assert.assertEquals(headerAssociatedRules, "Associated Rules (1)");
            Assert.assertEquals(headerRule, ruleName);
            Map<String, String> baseline = new HashMap<>();
            baseline.put("Name", ruleName);
            baseline.put("Description", ruleDesc);
            baseline.put("Type", ruleType);
            baseline.put("Location", location);
            baseline.put("Input(s)", inputCols);
            baseline.put("Output(s)", outputCols);

            Map<String, String> actual = new HashMap<>();
            for (int i = 0; i < 6; i++)
                actual.put(getRulesDetailsTabResultsLabel().get(i).getText().replace(":", ""),
                        getRulesDetailsTabResultsData().get(i).getText().replace(", ", ",").trim());
            System.out.println("Expected was:" + baseline);
            System.out.println("Actual was:" + actual);
            Assert.assertEquals(actual, baseline);
            WaitForObjectToVanish(".blockUI img");
            getBackToSummary().click();
            WaitForObjectToVanish(".blockUI img");
            selectParticularResultsCol(outputCols, tc_id);
            WaitForObjectToVanish(".blockUI img");
            waitForElementToBeVisible(getBackToSummary());
            WaitForObjectToVanish(".blockUI img");
            List<WebElement> detailsTabHeaders = getRowDetailsTabs();
            for (WebElement ele : detailsTabHeaders) {
                String tab = ele.getText();
                Assert.assertFalse(tab.contains("Rules"), "Rules tab is displayed which is not expected");
                break;
            }
            logger.info("Validate Details Tab Rule Details Completed successfully");
        } catch (Exception e) {
            e.printStackTrace();
            setLogMessage(
                    "Profile result rule sub tab details validation failed with error " + e.getMessage().toString());
            logger.error("Profile result rule sub tab details validation failed");
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            System.out.println(e.toString());
            Assert.fail("Profile result rule sub tab details validation failed", e);
        }
        return new ProfileResultsPage(driver);
    }

    public void selectRowDetailsTabs(String tabName) {
        try {
            logger.info("Select Row Details Tabs Started");
            for (WebElement ele : getRowDetailsTabs())
                if (ele.getText().contains(tabName))
                    ele.click();
            logger.info("Select Row Details Tabs Ended Successfully");
        } catch (Exception e) {
            System.out.println(e.toString());
            logger.error("Select Row Details Tabs failed");
            Assert.fail("Select Row Details Tabs failed", e);
        }
    }

    public ProfileResultsPage associateRuleToColsSaveAndRun(String ruleName, String colNames, String tc_id)
            throws SQLException {
        waitForElementToBeVisible(getAddRulesButton());
        String[] cols = colNames.split(";");
        try {
            logger.info("Associate Rule to Column, Save and Run the profile started");
            getAddRulesButton().click();
            // waitForElementToBeVisible(getDeleteRulesButton());
            // getAddRulesButton().click();
            funcWait(3000);
            getRulesPageColsFindBox().click();
            getRulesPageColsFindBox().clear();
            getRulesPageColsFindBox().sendKeys(ruleName);
            funcWait(3000);
            List<WebElement> rules = getRulesFromGrid();
            for (WebElement ele : rules) {
                if (ele.getText().equals(ruleName)) {
                    funcWait(2000);
                    ele.click();
                    clickUIDialogueButton("Select", tc_id);
                    break;
                }
            }
            waitForElementToBeVisible(getRulesPageColsFindBox());
            System.out.println(cols);
            for (String col : cols) {
                getRulesPageColsFindBox().click();
                getRulesPageColsFindBox().clear();
                getRulesPageColsFindBox().sendKeys(col);
                funcWait(5000);
                for (int i = 0; i < getRuleColsAssociateGrid().size(); i++) {
                    System.out.println(getRuleColsAssociateGrid().size());
                    System.out.println("Name:" + getRuleColsAssociateGrid().get(i).getText());
                    System.out.println(col);
                    if (getRuleColsAssociateGrid().get(i).getText().trim().equalsIgnoreCase(col.trim())) {
                        funcWait(2000);
                        getRulesColsCheckboxRules().get(i).click();
                        funcWait(2000);
                        break;
                    }
                }
            }
            clickUIDialogueButton("OK", tc_id);
            waitForElementToBeVisible(getSave());
            getSave().click();
            logger.info("Click on Save button successfull");
            waitForPreLoadImageDisappear();
            waitForElementToBeclickable(getRunButton());
            getRunButton().click();
            logger.info("Click on Run button successfull");
            logger.info("Associate Rule to Column, Save and Run the profile ended successfully");

        } catch (Exception e) {
            setLogMessage("Associate Rule to Column, Save and Run the profile failed with error "
                    + e.getMessage().toString());
            logger.error("Associate Rule to Column, Save and Run the profile failed");
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            System.out.println(e.toString());
            Assert.fail("Associate Rule to Column, Save and Run the profile failed", e);
        }
        return new ProfileResultsPage(driver);
    }

    public ProfileResultsPage associateRuleToColsAndSave(String ruleName, String colNames, String tc_id)
            throws SQLException {
        waitForElementToBeVisible(getAddRulesButton());
        waitForPreLoadImageDisappear();
        String[] cols = colNames.split(";");
        try {
            logger.info("Associate Rule to Column, Save the profile started");
            getAddRulesButton().click();
            // waitForElementToBeVisible(getDeleteRulesButton());
            // getAddRulesButton().click();
            funcWait(3000);
            getRulesPageColsFindBox().click();
            getRulesPageColsFindBox().clear();
            getRulesPageColsFindBox().sendKeys(ruleName);
            funcWait(3000);
            invisibilityOfLoaderImageForRuleTab(30);
            List<WebElement> rules = getRulesFromGrid();
            for (WebElement ele : rules) {
                if (ele.getText().equals(ruleName)) {
                    funcWait(2000);
                    ele.click();
                    try {
                        clickUIDialogueButton("Select", tc_id);
                        funcWait(1000);
                    } catch (Exception e) {
                        e.printStackTrace();
                    }

                    break;
                }
            }
            funcWait(1500);
            waitForPreLoadImageDisappear();
            System.out.println(cols);
            for (String col : cols) {
                getRulesPageColsFindBox().click();
                getRulesPageColsFindBox().clear();
                getRulesPageColsFindBox().sendKeys(col);
                waitForPreLoadImageDisappear();
                invisibilityOfLoaderImageForRuleTab(30);
                for (int i = 0; i < getRuleColsAssociateGrid().size(); i++) {
                    System.out.println(getRuleColsAssociateGrid().size());
                    System.out.println("Name:" + getRuleColsAssociateGrid().get(i).getText());
                    System.out.println(col);
                    if (getRuleColsAssociateGrid().get(i).getText().equalsIgnoreCase(col)) {
                        funcWait(2000);
                        getRulesColsCheckboxRules().get(i).click();
                        break;
                    }
                }
            }
            clickUIDialogueButton("OK", tc_id);
            waitForElementToBeVisible(getSave());
            getSave().click();
            setLogMessage("Click on Save button successfull");
            setLogMessage("Associate Rule to Column, Save the profile ended successfully");
            funcWait(5000);

        } catch (Exception e) {
            setLogMessage("Associate Rule to Column, Save and Run the profile failed with error "
                    + e.getMessage().toString());
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            logger.error("Associate Rule to Column, Save and Run the profile failed");
            System.out.println(e.toString());
            Assert.fail("Associate Rule to Column, Save and Run the profile failed", e);
        }
        return new ProfileResultsPage(driver);
    }

    private void clickUIDialogueButton(String button, String tc_id) throws SQLException {
        try {
            logger.info("Click on UI Dialogue button Started for:" + button);
            for (WebElement ele : getUiDialogueButtons())
                if (ele.getText().equals(button)) {
                    ele.click();
                    break;
                }
        } catch (Exception e) {
            setLogMessage("Click on UI Dialogue button failed with error " + e.getMessage().toString());
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            logger.error("Click on UI Dialogue button failed");
            System.out.println(e.toString());
            Assert.fail("Click on UI Dialogue button failed", e);
        }
    }

    // Creating profile using table - Employees Table - With Single or
    // All_Cols_Column
    public void createProfileAndExecute(String projectName, String folderName, String profileName,
                                        boolean isUnderProject, String connName) throws InterruptedException {
        exploreModuleApiUtils.deleteProject(projectName);
        exploreModuleApiUtils.createProject(projectName);
        exploreModuleApiUtils.createFolderUnder(projectName, folderName);
        exploreModuleApiUtils.createProfileUnderProjectOrFolder(projectName, folderName, profileName, false, connName);
        exploreModuleApiUtils.waitForTheExecutionToComplete(
                exploreModuleApiUtils.getJobIdapiExecuteProfile(profileName), profileName);
    }

    public void createProfileAndExecute(String projectName, String folderName, String profileName,
                                        boolean isUnderProject, String connName, String source, String cols)
            throws InterruptedException, SQLException {
        exploreModuleApiUtils.deleteProject(projectName);
        exploreModuleApiUtils.createProject(projectName);
        exploreModuleApiUtils.createFolderUnder(projectName, folderName);
        if (cols.contains("ALL_COLS")) {
            exploreModuleApiUtils.createProfileUnderProjectOrFolder(projectName, folderName, profileName, false,
                    connName, source, cols);
        } else {
            exploreModuleApiUtils.createProfileUnderProjectOrFolder(projectName, folderName, profileName, false,
                    connName, source, cols);
        }
        String status = exploreModuleApiUtils.waitForTheExecutionToComplete(
                exploreModuleApiUtils.getJobIdapiExecuteProfile(profileName), profileName);
        if (status.equals("COMPLETED")) {
            Assert.assertEquals(status, "COMPLETED", "The execution of profile is failed with status " + status);
        } else {
            Assert.fail("The execution of profile is failed with status " + status);
        }
    }

    public String createProfileAndExecuteAndGetTheStartTime(String projectName, String folderName, String profileName,
                                                            boolean isUnderProject, String connName, String source, String cols)
            throws InterruptedException, SQLException {
        String formattedDate = "";
        exploreModuleApiUtils.deleteProject(projectName);
        exploreModuleApiUtils.createProject(projectName);
        exploreModuleApiUtils.createFolderUnder(projectName, folderName);
        if (cols.contains("ALL_COLS"))
            exploreModuleApiUtils.createProfileUnderProjectOrFolder(projectName, folderName, profileName, false,
                    connName, source, cols);
        else
            exploreModuleApiUtils.createProfileUnderProjectOrFolder(projectName, folderName, profileName, false,
                    connName);
        // exploreModuleApiUtils.apiExecuteProfile(profileName);
        formattedDate = getProfileActualStartTime();
        exploreModuleApiUtils.waitForTheExecutionToComplete(
                exploreModuleApiUtils.getJobIdapiExecuteProfile(profileName), profileName);
        /*
         * exploreModuleApiUtils.waitForTheExecutionToComplete(exploreModuleApiUtils.
         * getJobIdBasedOnAssetId(profileName), profileName);
         */

        return formattedDate;
    }

    public String getProfileActualStartTime() {
        SimpleDateFormat dateFormat = new SimpleDateFormat("MMM d, yyyy, h:mm aa");
        String formattedDate = dateFormat.format(new Date()).toString();
        System.out.println("Profile Start time :" + formattedDate);
        return formattedDate;
    }

    public boolean checkWhetherRuleHeaderIsPresentOrNot(String ruleName, String columnName) {
        boolean flag = false;
        WaitForObjectToVanish(".blockUI img");
        waitForAllElementsToPresent("[data-object-instance-active='true'] tbody>tr>td:nth-of-type(3)>span span:nth-of-type(1)");
        Iterator<WebElement> profileResultListWithRule = getProfileResultListWithRule().iterator();
        Iterator<WebElement> profileResulttWithRuleInputColumns = getProfileResultWithRuleInputColumns().iterator();
        while (profileResultListWithRule.hasNext() && profileResulttWithRuleInputColumns.hasNext()) {
            WebElement RuleName = profileResultListWithRule.next();
            WebElement ruleInputColumns = profileResulttWithRuleInputColumns.next();
            if (RuleName.getText().equals(ruleName) && ruleInputColumns.getText().contains(columnName)) {
                flag = true;
                break;
            }
        }
        return flag;
    }

    public boolean checkWhetherProfiledColIsPresent(String columnName) {
        boolean flag = false;
        waitForAllElementsToPresent("[data-grid-col-name='columnName']");
        Iterator<WebElement> profiledColListIterator = getProfiledCols().iterator();
        while (profiledColListIterator.hasNext()) {
            WebElement profiledCol = profiledColListIterator.next();
            if (profiledCol.getText().equals(columnName)) {
                flag = true;
                break;
            }
        }
        return flag;
    }

    public boolean validateProfileResultRuleHeader(String expectedRuleOccurances) {
        boolean flag = false;
        waitForAllElementsToPresent("[data-object-instance-active='true'] [data-run-info='rules']");
        String ActualRuleOccurances = getHeaderProfileRules().getText();
        if (expectedRuleOccurances.equals(ActualRuleOccurances))
            flag = true;
        else
            flag = false;
        return flag;
    }

    public ProfileResultsPage navigateToRulestab(String tc_id) throws SQLException {
        try {
            logger.info("Navigate to Rules Tab Started");
            invisibilityOfElementOfGivenSelectorWithTimeout(20, ".blockUI.blockOverlay>img");
            performClickOn(getRulesTab());
            funcWait(1000);
            waitForAllElementsToPresent("span.infaTable-title-name.panel-title");
            funcWait(3000);
            setLogMessage("Navigate to Rules Tab Ended Successfully");
        } catch (Exception e) {
            setLogMessage("Navigate to Rules Tab Started failed with error " + e.getMessage().toString());
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            System.out.println(e.toString());
            logger.error("Navigate to Rules Tab Started failed");
            Assert.fail("Navigate to Rules Tab Started failed", e);
        }

        return new ProfileResultsPage(driver);
    }

    public List<String> getNotificationsList() {
        List<String> msgList = new ArrayList<>();
        Iterator<WebElement> msgIterator = getNotificationMessages().iterator();
        while (msgIterator.hasNext()) {
            WebElement element = msgIterator.next();
            String msg = element.getText();
            msgList.add(msg);
        }
        return msgList;
    }

    public ProfileResultsPage clickRunButton() {
        performClickOn(getRunButton());
        return this;
    }

    public boolean checkColumnListContent(String[] expectedColumnList, String tc_id) throws Exception {
        boolean flag = false;
        // Getting the actual column list from UI
        try {
            logger.info("Check Column List Content Started");
            ArrayList<String> ui_columnList = scrollAndGetColumnList();
            //ui_columnList.remove(0);
            int counter = 0;
            System.out.println("ActualColumnListSize:" + ui_columnList.size());
            System.out.println("ExpectedColumnListSize:" + expectedColumnList.length);
            if (expectedColumnList.length == ui_columnList.size()) {
                for (int i = 0; i < expectedColumnList.length; i++) {
                    if (expectedColumnList[i].equals(ui_columnList.get(i))) {
                        counter++;
                    }
                    flag = true;
                }
            }
            logger.info("Check Column List Content Ended Successfully");
        } catch (Exception e) {
            setLogMessage("Check Column List Content failed with error " + e.getMessage().toString());
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            System.out.println(e.toString());
            logger.error("Check Column List Content failed");
            Assert.fail("Check Column List Content failed", e);
        }

        return flag;
    }

    public ProfileResultsPage clickOnScheduleTab(String tc_id) throws SQLException {
        try {
            logger.info("Click on Schedule Tab Started");
            funcWait(1000);
            performClickOn(getScheduleTab());
            logger.info("Click on Schedule Tab Ended Successfully");
        } catch (Exception e) {
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            e.printStackTrace();
            Assert.fail("Click on Schedule Tab failed", e);
        }
        return new ProfileResultsPage(driver);
    }

    public ManageRulePage clickOnAddRuleButton(String tc_id) throws SQLException {
        try {
            logger.info("Click on Add Rule button Started");
            funcWait(6000);
            waitForElementToBeInvisible(".blockUI img");
            logger.info("Clicking on Add Rule button under rules sub tab");
            waitForElementToBeclickable(getRulesSubTabAddRuleButton());
            performClickOn(getRulesSubTabAddRuleButton());
            logger.info("Clicking on Add Rule button under rules sub tab completed successfully");
            WaitForObjectToVanish(".blockUI img");
        } catch (Exception e) {
            setLogMessage("Not able to click on Add rule button under rules sub tab because of error "
                    + e.getMessage().toString());
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            logger.error("Clicking on Add Rule button under rules sub tab failed");
            e.printStackTrace();
            Assert.fail("Clicking on Add Rule button under rules sub tab failed", e);
        }
        return new ManageRulePage(driver);
    }

    public String getTextOfRulesSubTabWhenNoRuleApplied(String tc_id) throws SQLException {
        logger.info("Get Text of Rules Sub Tab When No Rule Applied Started");
        funcWait(1000);
        List<WebElement> getTextLocator = getListWebElementFromCssString(
                ".cp-result-rule-section .d-section__content div");
        String text = "";
        try {
            Iterator<WebElement> getTextIterator = getTextLocator.iterator();
            int count = 1;
            while (getTextIterator.hasNext()) {
                WebElement ele = getTextIterator.next();
                text = text + ele.getText();
                if (count < getTextLocator.size()) {
                    text = text + "\n";
                    count++;
                }
            }
            logger.info("Get Text of Rules Sub Tab When No Rule Applied Ended Successfully");
        } catch (Exception e) {
            e.printStackTrace();
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            logger.error("Getting text from rules sub tab screen failed");
            new PageObjectBase(driver, By.tagName("body")).takeSnapShot(tc_id + "_" + sourceMethod);
            Assert.fail("Getting text from rules sub tab screen failed", e);
        }
        return text;
    }

    public void drillDownSelect(List<WebElement> drillDownQuryListElements, String drillDownQueryInputs) {
        logger.info("Drill Down Started on list elements and query inputs");
        Actions action = new Actions(driver);
        try {
        	driver.manage().timeouts().implicitlyWait(5, TimeUnit.SECONDS);
            if (drillDownQueryInputs != null) {
                String[] dTypes = drillDownQueryInputs.split(";");
                for (String dataT : dTypes) {
                    for (WebElement ele : drillDownQuryListElements) {
                        String data = ele.getAttribute("name");
                        if (dataT.equals(data))
                        		ele.click();
                            
                    }
                }
            }
            logger.info("Drill Down Failed on list elements and query inputs");
        } catch (Exception e) {               
                logger.info("Element is not visible. Hence, clicking on the down arrow button.");
                action.moveToElement(driver.findElement(By.xpath("//span[text()='Distinct']"))).click().build().perform();  
                for(int i=0;i<5;i++) {
                	action.sendKeys(Keys.ARROW_DOWN).build().perform();
            }
             drillDownSelect(drillDownQuryListElements, drillDownQueryInputs);   
        }finally {
            if (!System.getProperty("exec.args").contains("QAPOD")) {
                driver.manage().timeouts().implicitlyWait(300, TimeUnit.SECONDS);
            } else {
                driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
            }
        }
    }

    public void drillDownSelect(List<WebElement> drillDownQuryListElements, String drillDownQueryInputs,
                                String isPattern) {
        logger.info("Drill Down Started on list elements, query inputs and pattern started");
        Actions action = new Actions(driver);
        try {
        	driver.manage().timeouts().implicitlyWait(5, TimeUnit.SECONDS);
            if (drillDownQueryInputs != null) {
                String[] dTypes = drillDownQueryInputs.split(";");
                for (String dataT : dTypes) {
                    for (int i = 0; i < getPatternsData().size(); i++) {
                        String data = getPatternsData().get(i).getText().trim();
	/*					if (data.equalsIgnoreCase("Others")) {
							int j = i + 1;
							for (; j < getPatternsData().size(); j++) {
								if (getPatternsData().get(j).getText().equalsIgnoreCase(dataT)) {
									drillDownQuryListElements.get(j - 1).click();
									i = j;
								}
							}*/
                        /*} else*/
                        if (dataT.equals(data))
                            drillDownQuryListElements.get(i).click();
                    }
                }
            }
            logger.info("Drill Down Started on list elements, query inputs and pattern ended successfully");
        } catch (Exception e) {               
            logger.info("Element is not visible. Hence, clicking on the down arrow button.");
            action.moveToElement(driver.findElement(By.xpath("//span[text()='Distinct']"))).click().build().perform();  
            for(int i=0;i<5;i++) {
            	action.sendKeys(Keys.ARROW_DOWN).build().perform();
        }
         drillDownSelect(drillDownQuryListElements, drillDownQueryInputs,isPattern);   
    }finally {
        if (!System.getProperty("exec.args").contains("QAPOD")) {
            driver.manage().timeouts().implicitlyWait(300, TimeUnit.SECONDS);
        } else {
            driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
        }
    }
    }

    public void drillDownSelectSingleElement(List<WebElement> drillDownQuryListElements, String drillDownQueryInputs,
                                             List<WebElement> drillDownQuryListElementsData) {
        logger.info("Drill Down Started on selecting single element");
        Actions action = new Actions(driver);
        try {
        	driver.manage().timeouts().implicitlyWait(5, TimeUnit.SECONDS);
            if (drillDownQueryInputs != null) {
                String[] dTypes = drillDownQueryInputs.split(";");
                String dataT = dTypes[0];
                for (int i = 0; i < drillDownQuryListElementsData.size(); i++) {
                    String data = drillDownQuryListElements.get(i).getAttribute("name");
                    if (dataT.equals(data)) {
                        drillDownQuryListElements.get(i).click();
                        break;
                    }
                }
            }
            logger.info("Drill Down on selecting single element completed successfully");
        }  catch (Exception e) {               
            logger.info("Element is not visible. Hence, clicking on the down arrow button.");
            action.moveToElement(driver.findElement(By.xpath("//span[text()='Distinct']"))).click().build().perform();  
            for(int i=0;i<5;i++) {
            	action.sendKeys(Keys.ARROW_DOWN).build().perform();
        }
            drillDownSelectSingleElement(drillDownQuryListElements, drillDownQueryInputs,drillDownQuryListElementsData);   
    }finally {
        if (!System.getProperty("exec.args").contains("QAPOD")) {
            driver.manage().timeouts().implicitlyWait(300, TimeUnit.SECONDS);
        } else {
            driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
        }
    }
    }

    public void drillDownSelectSingleElement(List<WebElement> drillDownQuryListElements, String drillDownQueryInputs,
                                             List<WebElement> drillDownQuryListElementsData, String isPatterns) {
        logger.info("Drill Down Started on selecting single element along with patterns");
        Actions action = new Actions(driver);
        try {
        	driver.manage().timeouts().implicitlyWait(5, TimeUnit.SECONDS);
            if (drillDownQueryInputs != null) {
                String[] dTypes = drillDownQueryInputs.split(";");
                String dataT = dTypes[0];
                for (int i = 0; i < drillDownQuryListElementsData.size(); i++) {
                    String data = getPatternsData().get(i).getText().trim();
                    if (dataT.equals(data)) {
                        drillDownQuryListElements.get(i).click();
                        break;
                    }
                }
            }
            logger.info("Drill Down completed successfully on selecting single element along with patterns");
        } catch (Exception e) {               
            logger.info("Element is not visible. Hence, clicking on the down arrow button.");
            action.moveToElement(driver.findElement(By.xpath("//span[text()='Distinct']"))).click().build().perform();  
            for(int i=0;i<5;i++) {
            	action.sendKeys(Keys.ARROW_DOWN).build().perform();
        }
            drillDownSelectSingleElement(drillDownQuryListElements, drillDownQueryInputs,drillDownQuryListElementsData,isPatterns);   
    }finally {
        if (!System.getProperty("exec.args").contains("QAPOD")) {
            driver.manage().timeouts().implicitlyWait(300, TimeUnit.SECONDS);
        } else {
            driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
        }
    }
    }

    private void createDrillDownResultsAsMap() {
        try {
            logger.info("Create drill down results as a map started");
            Actions actions = new Actions(driver);
            String key = null;
            System.out.println("Creating Drill Down Results from UI as MAP");
            //Map<String, List<String>>drillDownDataUI = new HashMap<String, List<String>>();
            ArrayList<String> rowNumbers = new ArrayList<>();
            List<WebElement> l1 = driver.findElements(By.xpath("//table[contains(@class,'cp-query-data-table')]//td[2]/span/span"));
            if (l1.size() > 1) {
                for (WebElement ele : l1) {
                    rowNumbers.add(ele.getText());
                }
            } else {
                rowNumbers.add(l1.get(0).getText());
            }
            drillDownDataUI.put("SQN", rowNumbers);
            List<WebElement> columnHeaders = driver.findElements(By.xpath("//div[@data-section='queries']//table[contains(@class,'cp-query-data-table')]//th/span/span"));
            for (int i = 0; i < columnHeaders.size(); i++) {
                List<String> dDataRecords = new ArrayList<String>();
                key = columnHeaders.get(i).getText();
                System.out.println(key);
                int j = i + 3;
                List<WebElement> ele = new ArrayList<>();
                ele = driver.findElements(By.xpath(
                        "//table[contains(@class,'cp-query-data-table')]//td[contains(@class,'body__cell')][" + j + "]//span/span"));
                for (WebElement dData : ele) {
                    String data = dData.getText();
                    if (data.isEmpty())
                        data = "NULL";
                    dDataRecords.add(data.trim());
                }
                drillDownDataUI.put(key, dDataRecords);
                System.out.println(drillDownDataUI);
            }
            logger.info("Create drill down results as a map completed successfully");
        } catch (Exception e) {
            e.printStackTrace();
            logger.error("Create drill down results as a map failed with error " + e.getMessage());
            Assert.fail("Create drill down results as a map failed with error " + e.getMessage());
        }
    }

    private void createDrillDownBaseLineTextFileToMap(String baseLineLoc) {
        try {
            logger.info("Create drill down baseline text file as map started");
            System.out.println("Creating Drill Down Base Line MAP");
            String headerLine;
            @SuppressWarnings("unused")
            String lineCountt;
            String line;
            int linecount = 0;
            @SuppressWarnings("resource")
            BufferedReader readerCount = new BufferedReader(new FileReader(baseLineLoc));
            @SuppressWarnings("resource")
            BufferedReader readerDataHeader = new BufferedReader(new FileReader(baseLineLoc));
            // Line Count
            while ((lineCountt = readerCount.readLine()) != null)
                linecount++;
            headerLine = readerDataHeader.readLine();
            String keys[] = headerLine.split(",");
            for (int i = 0; i < keys.length; i++) {
                @SuppressWarnings("resource")
                BufferedReader readerData = new BufferedReader(new FileReader(baseLineLoc));
                String key = keys[i];
                String fData = null;
                line = readerData.readLine();
                List<String> keyData = new ArrayList<String>();
                for (int j = 1; j < linecount; j++) {
                    if ((line = readerData.readLine()) != null) {
                        if (line.contains(",,"))
                            line = line.replaceAll(",,", ",NULL,");
                        if (line.contains("NULL,,"))
                            line = line.replaceAll("NULL,,", "NULL,NULL,");
                        if (line.endsWith(","))
                            line = line.substring(0, line.length()) + "NULL";
                        String dataD[] = line.split(",");
                        fData = dataD[i];
                        keyData.add(fData.trim().replace("\"", ""));
                    }
                }
                drillDownBaselineMap.put(key.replace("\"", ""), keyData);
                System.out.println(drillDownBaselineMap);
                logger.info("Create drill down baseline text file as map failed");
            }
        } catch (Exception e) {
            e.printStackTrace();
            /*
             * logger.error("Create drill down baseline text file as map failed");
             * Assert.fail("Create drill down baseline text file as map failed");
             */
        }

    }

    public ProfileResultsPage createDrillDownBaselineAsMapAndValidate(String baseLineLoc, String tc_id)
            throws SQLException {
        try {
            logger.info("Create drill down baseline text file as map and validation started");
            String baselinePath = System.getProperty("user.dir") + "/src/test/resources/BaselineTxtFiles/"
                    + System.getProperty("agentOS").toLowerCase() + "/" + System.getProperty("sourceType").toLowerCase()
                    + "/" + baseLineLoc;
            createDrillDownBaseLineTextFileToMap(baselinePath);
            Assert.assertEquals(drillDownDataUI, drillDownBaselineMap);
            logger.info("Create drill down baseline text file as map and validation completed successfully");
        } catch (Exception e) {
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            e.printStackTrace();
            logger.error("Create drill down baseline text file as map and validation failed");
            Assert.fail("Create drill down baseline text file as map and validation failed", e);
        }
        return this;
    }

    public ProfileResultsPage performDrillDownActionOn(String drilldownColName, String drillDownDataType,
                                                       String drillDownPattern, String drillDownValueFrequencies, String tc_id) throws SQLException {
        logger.info("Perform drill down Action started");
        invisibilityOfLoaderImageWithTimeout(60);
        clickOnResizingButtons(tc_id, "MINIMIZE");
        if (drilldownColName != null) {
            if (drillDownValueFrequencies != null) {
                clickOnParticularResultsCol(drilldownColName, tc_id);
            } else {
                selectParticularResultsCol(drilldownColName, tc_id);
            }
            waitForResultPageToLoad(tc_id);
            if (drillDownDataType != null) {
                drillDownSelect(getInferredDataTypesCheckboxes(), drillDownDataType);
            }
            if (drillDownPattern != null) {
                drillDownSelect(getPatternsCheckboxes(), drillDownPattern, "true");
            }
            if (drillDownValueFrequencies != null) {
                drillDownSelect(getvalueFrequencyCheckboxes(), drillDownValueFrequencies);
            }

            // waitForElementToBeclickable(getDrillDownButtons().get(2));
/*				funcWait(10000);
				waitForElementToBeInvisible("div[class*=loader__spinner]");
				WaitForObjectToVanish(".blockUI img");*/
            invisibilityOfLoaderImageWithTimeout(5);
            getThreeDotsButtonOnResultsPage().click();
            clickOnDrillDownButtons("Apply");
            invisibilityOfElementOfGivenSelectorWithTimeout(30, "div[data-section='queries'] div[class*='loader__message']");
				/*funcWait(30000);
				waitForElementToBeInvisible("div[class*=loader__spinner]");*/

            try {
                invisibilityOfLoaderImage();
                selectNoOfItemsPerPage(tc_id, "100");
            } catch (NoSuchElementException e) {
            }
            WaitForObjectToVanish(".blockUI img");
            driver.findElement(By.xpath("//li[contains(@class,'breadcrumbs__breadcrumb')]")).click();
            createDrillDownResultsAsMap();
            logger.info("Perform drill down Action completed successfully");
        }
        return this;

    }

    public ProfileResultsPage performDrillDownActionOnMultiCol(String drilldownColName, String drillDownDataType,
                                                               String drillDownPattern, String drillDownValueFrequencies, String tc_id) throws SQLException {
        logger.info("Perform drill down Action started");
        
        invisibilityOfLoaderImageWithTimeout(60);
        clickOnResizingButtons(tc_id, "MINIMIZE");
        waitForElementToBeVisible(getRowDetailsSection());
        Actions action=new Actions(driver);
        JavascriptExecutor js = (JavascriptExecutor) driver;
        if (drilldownColName != null) {
            String[] colNames = drilldownColName.split(",");
            for (int i = 0; i < colNames.length; i++) {
                clickOnParticularResultsCol(colNames[i], tc_id);
                if (drillDownDataType != null) {
                    if (drillDownDataType.split(",", -1)[i] != "" && !drillDownDataType.split(",", -1)[i].isEmpty()) {
                        drillDownSelect(getInferredDataTypesCheckboxes(), drillDownDataType.split(",", -1)[i]);
                    }
                }
                if (drillDownPattern != null) {
                    if (drillDownPattern.split(",", -1)[i] != "" && !drillDownPattern.split(",", -1)[i].isEmpty()) {
                        drillDownSelect(getPatternsCheckboxes(), drillDownPattern.split(",", -1)[i], "true");
                    }
                }

                if (drillDownValueFrequencies != null) {
                    if (drillDownValueFrequencies.split(",", -1)[i] != "" && !drillDownValueFrequencies.split(",", -1)[i].isEmpty()) {
                        drillDownSelect(getvalueFrequencyCheckboxes(), drillDownValueFrequencies.split(",", -1)[i]);
                    }
                }

                clickOnGetBackToSummaryButton(tc_id);
            }
        }
        invisibilityOfLoaderImageWithTimeout(5);
        getThreeDotsButtonOnResultsPage().click();
        clickOnDrillDownButtons("Apply");
        invisibilityOfElementOfGivenSelectorWithTimeout(30, "div[data-section='queries'] div[class*='loader__message']");
        try {
            invisibilityOfLoaderImage();
            selectNoOfItemsPerPage(tc_id, "100");
        } catch (NoSuchElementException e) {
        }
        WaitForObjectToVanish(".blockUI img");
        driver.findElement(By.xpath("(//li[contains(@class,'breadcrumbs')]/span)[1]")).click();
        for (int i = 0; i < 100; i++) {
            new Actions(driver).sendKeys(Keys.LEFT).build().perform();
        }
        createDrillDownResultsAsMap();
        logger.info("Perform drill down Action completed successfully");
        return this;

    }

    public ProfileResultsPage performDrillDownActionOnAndGetErrorMessage(String drilldownColName, String drillDownDataType,
                                                                         String drillDownPattern, String drillDownValueFrequencies, String tc_id) throws SQLException {
        logger.info("Perform drill down Action started");
        waitForElementToBeInvisible("div[class*=loader__spinner]");
        waitForElementToBeInvisible(".blockUI img");
        WaitForObjectToVanish(".blockUI img");
        waitForElementToBeVisible(getRowDetailsSection());
        if (drilldownColName != null) {
            if (drillDownValueFrequencies != null) {
                clickOnParticularResultsCol(drilldownColName, tc_id);
            } else {
                selectParticularResultsCol(drilldownColName, tc_id);
            }
            funcWait(8000);
            if (drillDownDataType != "") {
                drillDownSelect(getInferredDataTypesCheckboxes(), drillDownDataType);
            }
            if (drillDownPattern != "") {
                drillDownSelect(getPatternsCheckboxes(), drillDownPattern, "true");
            }
            if (drillDownValueFrequencies != "") {
                drillDownSelect(getvalueFrequencyCheckboxes(), drillDownValueFrequencies);
            }

            // waitForElementToBeclickable(getDrillDownButtons().get(2));
            funcWait(10000);
            waitForElementToBeInvisible("div[class*=loader__spinner]");
            WaitForObjectToVanish(".blockUI img");
            clickOnDrillDownButtons("Apply");
        }
        return this;

    }

    private void clickOnDrillDownButtons(String btnName) {
        try {
            logger.info("Click on drill down button started");
            if (btnName.equalsIgnoreCase("Apply"))
                drillDownApplyButton.click();
            if (btnName.equalsIgnoreCase("Clear"))
                drillDownClearButton.click();
            if (btnName.equalsIgnoreCase("TableSettings"))
                drillDownTableSettingsButton.click();
            logger.info("Click on drill down button completed successfully");
        } catch (Exception e) {
            e.printStackTrace();
            logger.error("Click on drill down button failed");
            Assert.fail("Click on drill down button failed", e);
        }
    }

    public ProfileResultsPage performDrillDownActionUsingDropDown(String drilldownColName, String drillDownDataType,
                                                                  String drillDownPattern, String drillDownValueFrequencies, String action, String tc_id) throws SQLException {
        try {
            logger.info("Perform Drill Down Action using drop down started");
            WaitForObjectToVanish(".blockUI img");
            waitForPreLoadImageDisappear();
            waitForElementToBeInvisible("div[class*=loader__spinner]");
            waitForElementToBeVisible(getRowDetailsSection());
            if (action.equalsIgnoreCase("DESELECT")) {
                drillDownDropDownActions(getDrillDownDropDownsList(), getDrillDownDropDown(),
                        getDrillDownDropDownLabels(), getDrillDownDropDownCheckboxes(), drillDownDataType, "Data Type");
                drillDownDropDownActions(getDrillDownDropDownsList(), getDrillDownDropDown(),
                        getDrillDownDropDownLabels(), getDrillDownDropDownCheckboxes(), drillDownPattern, "Pattern");
                drillDownDropDownActions(getDrillDownDropDownsList(), getDrillDownDropDown(),
                        getDrillDownDropDownLabels(), getDrillDownDropDownCheckboxes(), drillDownValueFrequencies,
                        "Value");
            }
            clickOnDrillDownButtons("Apply");
            try {
                invisibilityOfLoaderImage();
                selectNoOfItemsPerPage(tc_id, "100");
            } catch (NoSuchElementException e) {
            }
            createDrillDownResultsAsMap();
            logger.info("Perform Drill Down Action using drop down completed successfully");
        } catch (Exception e) {
            setLogMessage("Drill Down Filter is Failed with error....\n" + e.getMessage().toString());
            logger.error("Drill Down Filter Apply Failed....");
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            e.printStackTrace();
            Assert.fail("Perform Drill Down Action using drop down failed", e);
        }
        return this;
    }

    private ProfileResultsPage drillDownDropDownActions(List<WebElement> drillDownDropDownsList,
                                                        List<WebElement> drillDownDropDown, List<WebElement> drillDownDropDownLabels,
                                                        List<WebElement> drillDownDropDownCheckboxes, String drillDownData, String drillDownType) {
        try {
            logger.info("Drill down drop down actions started");
            WaitForObjectToVanish(".blockUI img");
            for (int i = 0; i < drillDownDropDownsList.size(); i++) {
                String titleData = drillDownDropDownsList.get(i).getAttribute("title");
                if (titleData.contains(drillDownType)) {
                    drillDownDropDown.get(i).click();
                    break;
                }
            }
            String selectData[] = drillDownData.split(";");
            for (String data : selectData) {
                for (int i = 0; i < drillDownDropDownLabels.size(); i++) {
                    String lableData = drillDownDropDownLabels.get(i).getText();
                    if (lableData.equalsIgnoreCase(data)) {
                        drillDownDropDownCheckboxes.get(i).click();
                        break;
                    }
                }
            }
            WaitForObjectToVanish(".blockUI img");

            for (int i = 0; i < drillDownDropDownsList.size(); i++) {
                String titleData = drillDownDropDownsList.get(i).getAttribute("title");
                if (titleData.contains(drillDownType)) {
                    drillDownDropDown.get(i).click();
                    break;
                }
            }
        } catch (Exception e) {
            e.printStackTrace();
            logger.error("Drill down drop down actions Failed....");
            Assert.fail("Drill down drop down actions failed", e);
        }
        logger.info("Drill down drop down actions completed successfully");
        return this;
    }

    public ProfileResultsPage verifyClearActions(String drilldownColName, String drillDownDataType,
                                                 String drillDownPattern, String drillDownValueFrequencies, String tc_id) throws SQLException {
        try {
            logger.info("Verify clear action on drill down started");
            WaitForObjectToVanish(".blockUI img");
            funcWait(5000);
//			waitForElementToBeInvisible(getLoaderSpinner());
            if (drilldownColName != null) {
                if (drillDownValueFrequencies != null) {
                    clickOnParticularResultsCol(drilldownColName, tc_id);
                } else {
                    selectParticularResultsCol(drilldownColName, tc_id);
                }
                if (drillDownDataType != null) {
                    drillDownSelectSingleElement(getInferredDataTypesCheckboxes(), drillDownDataType,
                            getInferredDataTypesData());
                    Assert.assertTrue(drillDownApplyButton.isEnabled());
                    drillDownSelectSingleElement(getInferredDataTypesCheckboxes(), drillDownDataType,
                            getInferredDataTypesData());
                    String isDisabled = drillDownApplyButton.getAttribute("aria-disabled");
                    Assert.assertEquals(isDisabled, "true");
                }
                if (drillDownPattern != null) {
                    drillDownSelectSingleElement(getPatternsCheckboxes(), drillDownPattern, getPatternsDataS(), "true");
                    Assert.assertTrue(drillDownApplyButton.isEnabled());
                    drillDownSelectSingleElement(getPatternsCheckboxes(), drillDownPattern, getPatternsDataS(), "true");
                    String isDisabled = drillDownApplyButton.getAttribute("aria-disabled");
                    Assert.assertEquals(isDisabled, "true");
                }
                if (drillDownValueFrequencies != null) {
                    drillDownSelectSingleElement(getvalueFrequencyCheckboxes(), drillDownValueFrequencies,
                            getValueFrequencyData());
                    Assert.assertTrue(drillDownApplyButton.isEnabled());
                    drillDownSelectSingleElement(getvalueFrequencyCheckboxes(), drillDownValueFrequencies,
                            getValueFrequencyData());
                    String isDisabled = drillDownApplyButton.getAttribute("aria-disabled");
                    Assert.assertEquals(isDisabled, "true");
                }
                if (drillDownDataType != null) {
                    drillDownSelectSingleElement(getInferredDataTypesCheckboxes(), drillDownDataType,
                            getInferredDataTypesData());
                    clickOnDrillDownButtons("Clear");
                    WaitForObjectToVanish(".blockUI img");
                    Assert.assertTrue(getDrillDownButtons().size() <= 6);
                }
            }
            WaitForObjectToVanish(".blockUI img");
            logger.info("Verify clear action on drill down completed successfully");
        } catch (Exception e) {
            setLogMessage("Drill Down Filter is Failed with error....\n" + e.getMessage().toString());
            logger.error("Drill Down Filter Apply Failed....");
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            e.printStackTrace();
            Assert.fail("Drill Down Filter Apply Failed....", e);
        }
        return this;
    }

    public ProfileResultsPage verifyDrillDownResultsColSelected(String drilldownColName, String tc_id)
            throws SQLException {
        try {
            logger.info("Verify Drill Down Results on Selected Col started");
            String attributeValues = null;
            String columnName = "th[data-id='#columnName#']".replace("#columnName#", drilldownColName);
            attributeValues = driver.findElement(By.cssSelector(columnName)).getAttribute("class");
			/*for (WebElement ele : getDrillDownResultsHeader()) {
				String colName = ele.getText();
				if (colName.equals(drilldownColName)) {

					attributeValues = ele.getAttribute("class");
					break;
				}
			}*/
            if (!attributeValues.contains("cp-selected-col")) {
                Assert.fail("Drilldown column is not selected.");
            }
//			assertEquals(attributeValues, "d-r35-table__header__cell cp-selected-col");
            logger.info("Verify Drill Down Results on Selected Col Completed Successfully ");

        } catch (Exception e) {
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            e.printStackTrace();
            logger.error("Verify Drill Down Results on Selected Col Failed....");
            Assert.fail("Verify Drill Down Results on Selected Col Failed....", e);
        }
        return this;
    }

    public ProfileResultsPage chooseProfileRun(String runKey) {
        try {
            logger.info("Choose profile run started");
            WaitForObjectToVanish(".blockUI img");
            waitForPreLoadImageDisappear();
            funcWait(2000);
            waitForAllElementsToPresent(".cp-run-chooser table tr[class*='table__body__row']");
            List<WebElement> profileRuns = getListOfProfileRuns();
            for (int i = 0; i < profileRuns.size(); i++) {
                String profileRunNumber = ".cp-run-chooser table tbody>tr:nth-of-type(rowNumber)>td:nth-of-type(2)>span";
                profileRunNumber = profileRunNumber.replace("rowNumber", String.valueOf(i + 1));
                if (getElementFromCssString(profileRunNumber).getText().contains(runKey)) {
                    performClickOn(getElementFromCssString(profileRunNumber));
                    break;
                }
            }
            logger.info("Choose profile run completed successfully");
            WaitForObjectToVanish(".blockUI img");
        } catch (Exception e) {
            e.printStackTrace();
            logger.error("Choose profile run Failed....");
            Assert.fail("Choose profile run Failed....", e);
        }
        return this;
    }

    public ProfileResultsPage clickOnSelectOrCancelButton(String buttonName) {
        try {
            logger.info("Click on Select or Cancel button started");
            WaitForObjectToVanish(".blockUI img");
            if (buttonName.equalsIgnoreCase("select"))
                performClickOn(getChooseRunSelectButton());
            else if (buttonName.equalsIgnoreCase("cancel"))
                performClickOn(getChooseProfileCancelButton());
            WaitForObjectToVanish(".blockUI img");
            logger.info("Click on Select or Cancel button completed successfully");
        } catch (Exception e) {
            e.printStackTrace();
            logger.error("Click on Select or Cancel button Failed....");
            Assert.fail("Click on Select or Cancel button Failed....", e);
        }
        return this;
    }

    public ProfileResultsPage selectOptionFromMenuInResultsPage(String option, String tc_id) throws SQLException {
        try {
            logger.info("Select option from menu started");
            WaitForObjectToVanish(".blockUI img");
            waitForElementToBeVisible(getOptionsButton());
            performClickOn(getOptionsButton());
            waitForAllElementsToPresent("ul[class*='menu'] li");
            List<WebElement> list = getOptionsMenu();
            for (int i = 0; i < list.size(); i++) {
                if (list.get(i).getText().equalsIgnoreCase(option)) {
                    performClickOn(list.get(i));
                    break;
                }
            }
            WaitForObjectToVanish(".blockUI img");
            logger.info("Select option from menu ended successfully for Option:" + option);
        } catch (Exception e) {
            setLogMessage("Select option from menu Failed with error....\n" + e.getMessage().toString());
            logger.error("Select option from menu Failed....");
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            e.printStackTrace();
            Assert.fail("Select option from menu Failed....", e);
        }

        return this;
    }

    public ProfileResultsPage isDrillDownScrollBarsExists(String tc_id) throws SQLException {
        try {
            logger.info("Verify if drill down scroll bar exists or not started");
            int scrollHeight = Integer.parseInt(getTableDetailsGrid().getAttribute("scrollHeight"));
            int offsetHeight = Integer.parseInt(getTableDetailsGrid().getAttribute("offsetHeight"));
            Assert.assertTrue(scrollHeight >= offsetHeight);
            logger.info("Verify if drill down scroll bar exists or not completed successfully");
        } catch (Exception e) {
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            e.printStackTrace();
            logger.error("Verify if drill down scroll bar exists or not Failed....");
            Assert.fail("Verify if drill down scroll bar exists or not Failed....", e);
        }
        return this;
    }

    public ProfileResultsPage isCheckboxDisplayedForDatesDataType(String drillDownDataType) {
        logger.info("Verify if Check box is displayed for Date DataType started");
        drillDownSelect(getInferredDataTypesCheckboxes(), drillDownDataType);
        boolean flag = true;
        String data[] = drillDownDataType.split(";");
        for (String dataT : data) {
            for (WebElement ele : getInferredDataTypesCheckboxes()) {
                String dataUI = ele.getAttribute("name");
                if (dataT.equals(dataUI))
                    flag = false;
            }
        }
        Assert.assertTrue(flag);
        logger.info("Verify if Check box is displayed for Date DataType completed successfully");
        return this;
    }

    public ProfileResultsPage clickSortColumnsButton() {
        try {
            logger.info("Clicking on sort columns button started");
            WaitForObjectToVanish(".blockUI img");
            if (!(driver.findElement(By.xpath("(//div[@data-grid-col-name='columnName']//a)[1]")).getText().equalsIgnoreCase("BINARY_DOUBLE_COL"))) {
                WaitForObjectToVanish(".blockUI img");
                getColumnNameHeader().click();
            }
            invisibilityOfElementLocated(By.cssSelector("div[class*='loader__message']"));
            logger.info("Clicking on sort columns button completed successfully");
        } catch (Exception e) {
            e.printStackTrace();
            logger.error("Clicking on sort columns button failed");
            Assert.fail("Clicking on sort columns button failed", e);
        }
        return this;
    }


    public boolean checAlertstabPresentOrNot(String tc_id) throws SQLException {
        boolean flag = false;
        try {
            logger.info("Starting validation for Alerts sub tab is present in results tab or not");
            for (WebElement ele : getRowDetailsTabs()) {
                if (ele.getText().equals("Alerts")) {
                    logger.error("Alerts sub tab is present is results tab");
                    flag = true;
                    break;
                }
            }

        } catch (Exception e) {
            logger.error(
                    "Validation failed to check whether Alerts tab is present or not with error " + e.getMessage());
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            Assert.fail("Validation failed to check whether Alerts tab is present or not with error " + e.getMessage());
        }
        return flag;
    }

    @FindBy(css = "div[data-section='grid-results'] i[class*='filter__icon']")
    private WebElement filterResult;

    @FindBy(css = "button[class*='filter__icon__button']")
    private WebElement AddField;

    @FindAll(@FindBy(css = ".jqx-popover-content"))
    private List<WebElement> PopOvers;

    @FindAll(@FindBy(css = "div[id*='innerListBox'] span.jqx-listitem-state-normal"))
    private List<WebElement> options;

    @FindBy(css = "header[class*=shell__page__title] button:nth-of-type(3)>i")
    private WebElement multipleOptions;

    @FindBy(css = "button[data-button-name='select']")
    private WebElement runSelect;

    public WebElement getRunSelect() {
        return runSelect;
    }

    public void setRunSelect(WebElement runSelect) {
        this.runSelect = runSelect;
    }

    @FindAll(@FindBy(css = "li[role='menuitem']"))
    private List<WebElement> runOptions;

    @FindAll(@FindBy(css = "td[data-id='displayRunKey'] span"))
    private List<WebElement> runDetails;

    public List<WebElement> getRunDetails() {
        return runDetails;
    }

    public void setRunDetails(List<WebElement> runDetails) {
        this.runDetails = runDetails;
    }

    public List<WebElement> getRunOptions() {
        return runOptions;
    }

    public void setRunOptions(List<WebElement> runOptions) {
        this.runOptions = runOptions;
    }

    public WebElement getMultipleOptions() {
        return multipleOptions;
    }

    public void setMultipleOptions(WebElement multipleOptions) {
        this.multipleOptions = multipleOptions;
    }

    public List<WebElement> getOptions() {
        return options;
    }

    public void setOptions(List<WebElement> options) {
        this.options = options;
    }

    public List<WebElement> getPopOvers() {
        return PopOvers;
    }

    public void setPopOvers(List<WebElement> popOvers) {
        PopOvers = popOvers;
    }

    public WebElement getAddField() {
        return AddField;
    }

    public void setAddField(WebElement addField) {
        AddField = addField;
    }

    public WebElement getFilterResult() {
        return filterResult;
    }

    public void setFilterResult(WebElement filterResult) {
        this.filterResult = filterResult;
    }

    public WebElement getNotificationMessage() {
        return notificationMessage;
    }

    public void setNotificationMessage(WebElement notificationMessage) {
        this.notificationMessage = notificationMessage;
    }

    public ProfileResultsPage clickOnFilter() {
        try {
        	invisibilityOfElementOfGivenSelectorWithTimeout(20, "div[class*='shell__page__content'] >div[class*='loader']:nth-of-type(2) div[class*='loader__message']");
            invisibilityOfElementOfGivenSelectorWithTimeout(20, "div[data-section='grid-results'] div[class*='loader__message']");
            performClickOn(getFilterResult());
        } catch (Exception e) {
            Assert.fail("Click on filter failed.", e);
        }
        return new ProfileResultsPage(driver);
    }

    public ProfileResultsPage selectRunKey(String RunKey) {
        funcWait(2000);
        waitForPreLoadImageDisappear();
        WaitForObjectToVanish(".blockUI img");
        try {
            logger.info("Select Run key Started");
            for (WebElement runKey : getRunDetails()) {
                if (runKey.getText().contains(RunKey)) {
                    runKey.click();
                    clickrunslect();
                    break;
                }
            }
        } catch (Exception e) {
            e.printStackTrace();
            logger.error("Select Run key failed");
            Assert.fail("Select Run key failed", e);
        }
        WaitForObjectToVanish(".blockUI img");
        logger.info("Select Run key Completed successfully");
        return new ProfileResultsPage(driver);
    }

    private ProfileResultsPage clickrunslect() {
        // TODO Auto-generated method stub
        performClickOn(getRunSelect());
        return new ProfileResultsPage(driver);

    }

    public ProfileResultsPage clickOnMultipleOptions() {
        try {
            WaitForObjectToVanish(".blockUI img");
            waitForElementToBeVisible(getMultipleOptions());
            WaitForObjectToVanish(".blockUI img");
            getMultipleOptions().click();
        } catch (Exception e) {
            logger.error("click on multiple options failed with error ", e);
            Assert.fail("click on multiple options failed with error ", e);
        }
        return new ProfileResultsPage(driver);
    }

    public ProfileResultsPage clickOnChooseProfile(String Run) {
        logger.info("Click on Choose Profile Started");
        WaitForObjectToVanish(".blockUI img");
        for (WebElement runoption : this.getRunOptions()) {
            try {

                if (!runoption.getAttribute("innerText").equalsIgnoreCase(Run)) {
                    continue;
                }

                runoption.click();
                break;

            } catch (Exception e) {
                continue;
            }
        }
        logger.info("Click on Choose Profile Completed successfully");
        return new ProfileResultsPage(driver);

    }

    public ProfileResultsPage clickOnOption(String Option) {
        logger.info("Click on " + Option + " Started");
        for (WebElement runoption : this.getRunOptions()) {
            try {

                if (!runoption.getAttribute("innerText").equalsIgnoreCase(Option)) {
                    continue;
                }
                runoption.click();
                break;

            } catch (Exception e) {
                continue;
            }
        }
        logger.info("Click on " + Option + " Completed successfully");
        return new ProfileResultsPage(driver);

    }

    public boolean validateExportProfileResultFileName(String fileName) {
        logger.info("Validation of export profile result file name Started");
        boolean isSuccess = false;
        try {
            waitForElement(getExportProfileResultFileName(), "Export profileResult file Name");
            isSuccess = getExportProfileResultFileName().getAttribute("value").equals(fileName);
        } catch (Exception e) {
            e.printStackTrace();
            logger.error("Export profile result file name validation failed");
            Assert.fail("ERROR", e);
        }

        logger.info("Validation of export profile result file name Completed successfully");
        return isSuccess;

    }

    public ProfileResultsPage enterExportProfileResultFileName(String fileName) {
        logger.info("Enter export profile result file name Started");
        try {
            waitForElement(getExportProfileResultFileName(), "Export profileResult file Name");
            enterValueInto(getExportProfileResultFileName(), fileName);
        } catch (Exception e) {
            e.printStackTrace();
            logger.error("Export profile result file name validation failed");
            Assert.fail("ERROR", e);
        }

        logger.info("Validation of export profile result file name Completed successfully");
        return new ProfileResultsPage(driver);

    }

    public ProfileResultsPage selectExportProfileResultRange(String range) {
        logger.info("Select export profile result range Started");
        try {
            if (range.equalsIgnoreCase("Selected Columns")) {
                waitForElement(getExportProfileResultSelectedColRange(), "Export profileResult range");
                performClickOn(getExportProfileResultSelectedColRange());
            } else if (range.equalsIgnoreCase("All Columns")) {
                waitForElement(getExportProfileResultAllColRange(), "Export profileResult range");
                performClickOn(getExportProfileResultAllColRange());
            }

        } catch (Exception e) {
            e.printStackTrace();
            logger.error("Export profile result range validation failed");
            Assert.fail("ERROR", e);
        }

        logger.info("Validation of export profile result range Completed successfully");
        return new ProfileResultsPage(driver);

    }

    /*
     * public ProfileResultsPage clearExportProfileResultFileName(){
     * logger.info("clear export profile result file name Started"); try{
     * waitForElement(getExportProfileResultFileName(),
     * "Export profileResult file Name"); getExportProfileResultFileName().clear();
     * }catch (Exception e) { e.printStackTrace();
     * logger.error("clear export profile result file name failed"); Assert.fail();
     * }
     *
     * logger.info("clear export profile result file name Completed successfully");
     * return new ProfileResultsPage(driver);
     *
     * }
     */

    public List<String> validateErrorMessageExportProfileResult() {
        logger.info("Validate error message export profile result file name Started");
        List<String> errorMessage = new ArrayList<>();
        try {
            for (WebElement i : getErrorMessageExportProfileResult()) {
                waitForElementToBeVisible(i);
                errorMessage.add(i.getText());
            }
        } catch (Exception e) {
            e.printStackTrace();
            logger.error("Validate error message export profile result file name failed");
            Assert.fail("Error", e);
        }

        logger.info("Validation of error message export profile result file name Completed successfully");
        return errorMessage;

    }

    public ProfileResultsPage deselectExportProfileResultScope() {
        logger.info("Deselect all Scope for profile result export Started");
        try {
/*			for (WebElement ele : getExportProfileResultScope()) {
				ele.click();
				funcWait(1000);
			}*/
            for (int i = 1; i < 6; i++) {
                WebElement ele = driver.findElement(By.cssSelector(".cp-profile-export-dialog div[class*='form__control']:nth-child(#index#) input[type='checkbox']".replace("#index#", String.valueOf(i))));
                ele.click();
                funcWait(1000);
            }

        } catch (Exception e) {
            e.printStackTrace();
            logger.error("Deselect all Scope for profile result export failed");
            Assert.fail("ERROR", e);
        }

        logger.info("Deselect all Scope for profile result export Completed successfully");
        return new ProfileResultsPage(driver);
    }

    public ProfileResultsPage clickOnCancelExportProfileResult() {
        logger.info("Click on Cancel export profile result started");

        try {
            waitForElementToBeclickable(getCancelExportProfileResult());
            performClickOn(getCancelExportProfileResult());
        } catch (Exception e) {
            e.printStackTrace();
            logger.error("Click on Cancel export profile result failed");
            Assert.fail("ERROR", e);
        }
        logger.info("Click on Cancel export profile result Completed successfully");
        return new ProfileResultsPage(driver);

    }
    
    public ProfileResultsPage clickOnExportButtonOfExportProfileResultsDialogBox() {
        logger.info("Click on Export button in Export Profile Results Dialog Box started");
        try {
            waitForElementToBeclickable(getExportProfileResult());
            performClickOn(getExportProfileResult());
            funcWait(20000);
        } catch (Exception e) {
            e.printStackTrace();
            logger.error("Click on Export button in Export Profile Results Dialog Box failed");
            Assert.fail("ERROR", e);
        }
        logger.info("Click on Export button in Export Profile Results Dialog Box Completed successfully");
        return new ProfileResultsPage(driver);

    }

    
    public String getErrorOrSuccessMessage() {
        String notificationMsg = null;
        try {
            waitForElement(getNotificationMessage(), "Success message");
            notificationMsg = getNotificationMessage().getText();
            System.out.println(notificationMsg);
            waitForPreLoadImageDisappear();
            WaitForObjectToVanish(".blockUI img");
            WaitForObjectToVanish(".blockUI img");
        } catch (Exception e) {
            e.printStackTrace();
            setLogMessage(e.getMessage());
            new PageObjectBase(driver, By.tagName("body")).takeSnapShot(sourceMethod);
            logger.error("Failed to get error or success message after saving the profile");
            Assert.fail("Failed to get error or success message after saving the profile", e);
        }
        return notificationMsg;
    }

    public void FilterByText(String text) {
        System.out.println();
        logger.info("Filter by Text Started");
        WebElement findTextBox = driver.findElement(By.cssSelector("div[class*='bubble--none'] input[placeholder='Find']"));
        findTextBox.clear();
        findTextBox.sendKeys(text);
        List<WebElement> l1 = driver.findElements(By.cssSelector("ul[class*='filter__field-list'] li"));
        for (WebElement ele : l1) {
            if (ele.getAttribute("aria-label").equalsIgnoreCase(text)) {
                ele.click();
                break;
            }
        }
        invisibilityOfElementLocated(By.cssSelector("div[data-section='grid-results' div[class*='loader__message']"));
        logger.info("Filter by Text Completed");
		/*for (WebElement popOver : this.getPopOvers()) {
			try {
				if (!popOver.isDisplayed()) {
					continue;
				}

				WebElement textBox = popOver.findElement(By.cssSelector("input[placeholder='Find']"));
				if (textBox.isDisplayed()) {
					textBox.clear();
					textBox.sendKeys(text);
					funcWait(1000);
					WebElement filterOption = popOver
							.findElement(By.cssSelector(".listbox div[role='option']:nth-of-type(1)"));
					filterOption.click();
					break;
				} else {
					List<WebElement> filterOption = popOver.findElements(By.cssSelector(".listbox div[role='option']"));
					Iterator<WebElement> filterOptionIterator = filterOption.iterator();
					while (filterOptionIterator.hasNext()) {
						WebElement filterOptionIt = filterOptionIterator.next();
						logger.info("Filter option: " + filterOptionIt.getText());
						if (filterOptionIt.getText().equals(text)) {
							filterOptionIt.click();
							break;
						}
					}

				}
				logger.info("Filter by Text Completed Successfully");
			} catch (Exception e) {
				e.printStackTrace();
				// swallow exception
				// no unique selector is available. Try all input[placeholder='Find']
				continue;
			}
		}*/
        funcWait(1000);
    }


    public CreateAndEditProfilePage clickOnDefinitionTab() {
        try {
            WaitForObjectToVanish(".blockUI blockOverlay");
            logger.info("Navigate to Definition Tab Started");
            waitForElementToBeVisible(getDefinitionTab());
            funcWait(2000);
            waitForElementToBeclickable(getDefinitionTab());
            performClickOn(getDefinitionTab());
            funcWait(1000);
            WaitForObjectToVanish(".blockUI img");
            logger.info("Navigate to Definition Tab Ended Successfully");
        } catch (Exception e) {
            setLogMessage("Navigate to Definition Tab Started failed with error " + e.getMessage().toString());
            logger.error("Navigate to Definition Tab Started failed");
            System.out.println(e.toString());
            Assert.fail("Navigate to Definition Tab Started failed with error", e);
        }
        return new CreateAndEditProfilePage(driver);
    }

    public ProfileResultsPage waitForProfileRunMonitorLinkToDisapper() {
        try {
            waitForElementToBeInvisible(".blockUI img");
            waitForElement(getProfileRunMonitorLink(), "Profile Run Monitor link navigation is not displayed");
            while (getProfileRunMonitorLink().isDisplayed()) {
                WebDriverWait wait = new WebDriverWait(driver, 120);
                wait.until(ExpectedConditions.invisibilityOf(getProfileRunMonitorLink()));
                break;
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
        return this;
    }

    //Added for https://infajira.informatica.com/browse/CP-1822
    public ProfileResultsPage validateIfOutputPortNamesOrIdsAreAppearing(String portName) {
        try {
            logger.info("Validation of output port name to appear started");
            if (portName.contains(";")) {
                String[] portNamesToBeValidated = portName.split(";");
                for (int i = 0; i < portNamesToBeValidated.length; i++) {
                    highlightElement(driver.findElement(By.xpath("//span/a[text()='#PORTNAME#']".replace("#PORTNAME#", portNamesToBeValidated[i]))));
                }
            } else {
                highlightElement(driver.findElement(By.xpath("//span/a[text()='#PORTNAME#']".replace("#PORTNAME#", portName))));
            }
            logger.info("Validation of output port name to appear completed successfully");
        } catch (Exception e) {
            e.printStackTrace();
            logger.info("Validation of output port name to appear failed");
            Assert.fail("ERROR", e);
        }
        return this;
    }

    public void highlightElement(WebElement element) throws InterruptedException {
        JavascriptExecutor js = (JavascriptExecutor) driver;
        js.executeScript("arguments[0].setAttribute('style', 'background: yellow; border: 2px solid red;');", element);
    }

    public ProfileResultsPage selectDrillDownActionsAndClickApply(String drilldownColName, String drillDownDataType,
                                                                  String drillDownPattern, String drillDownValueFrequencies, String tc_id) throws SQLException {
        try {
            logger.info("Perform drill down Action started");
            WaitForObjectToVanish(".blockUI img");
            waitForElementToBeVisible(getRowDetailsSection());
            if (drilldownColName != null) {
                if (drillDownValueFrequencies != null) {
                    clickOnParticularResultsCol(drilldownColName, tc_id);
                } else {
                    selectParticularResultsCol(drilldownColName, tc_id);
                }
                funcWait(1000);
                drillDownSelect(getInferredDataTypesCheckboxes(), drillDownDataType);
                drillDownSelect(getPatternsCheckboxes(), drillDownPattern, "true");
                drillDownSelect(getvalueFrequencyCheckboxes(), drillDownValueFrequencies);
                WaitForObjectToVanish(".blockUI img");
                clickOnDrillDownButtons("Apply");
                funcWait(500);
                WebDriverWait wait = new WebDriverWait(driver, 250);
                wait.until(ExpectedConditions.invisibilityOf(driver.findElement(By.cssSelector(".sk-fading-circle"))));
                logger.info("Perform drill down Action completed successfully");
            }

        } catch (Exception e) {
            setLogMessage("Drill Down Filter is Failed with error....\n" + e.getMessage().toString());
            logger.info("Drill Down Filter Apply Failed....");
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            e.printStackTrace();
            logger.error("Create drill down baseline text file as map and validation failed");
            Assert.fail("Create drill down baseline text file as map and validation failed", e);
        }
        return this;
    }

    public ProfileResultsPage selectPredefinedFilterAsValueFrequencyOutlier(String tc_id) throws SQLException {
        try {
            logger.info("Select Predefined Filter As Value Frequency Outlier ");
            invisibilityOfElementOfGivenSelectorWithTimeout(25, "div[data-section='grid-results'] div[class*='loader__message']");
            WebElement dropdownButton = driver.findElement(By.xpath(dropdownButtonForWith));
            dropdownButton.click();
            for (WebElement ele : getListOfOptionsInTheDropdown()) {
                if (ele.getText().contains("Value Frequency Outliers")) {
                    ele.click();
                    break;
                }
            }
            invisibilityOfElementLocated(By.cssSelector("div[class*='loader__message']"));
            logger.info("Select Predefined Filter As Value Frequency Outlier Done Successfully");
        } catch (Exception e) {
            setLogMessage("Select Predefined Filter As Value Frequency Outlier Failed with error....\n"
                    + e.getMessage().toString());
            logger.error("Select Predefined Filter As Value Frequency Outlier Failed....");
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            e.printStackTrace();
            Assert.fail("Select Predefined Filter As Value Frequency Outlier Failed....", e);
        }

        return this;
    }

    public ProfileResultsPage validateDetailstabRuleDetails(String ruleName, String ruleDesc, String inputCols,
                                                            String outputCols, String profCol, String tc_id) throws SQLException {
        try {
            logger.info("Validate Details Tab Rule Details Started");
            WaitForObjectToVanish(".blockUI img");
            // uncomment after bug is resolved
            selectParticularResultsCol(profCol, tc_id);
            WaitForObjectToVanish(".blockUI img");
            // uncomment after bug is resolved
            waitForElementToBeVisible(getBackToSummary());
            selectRowDetailsTabs("Rules");
            String headerAssociatedRules = "", headerRule = "";
            for (int i = 0; i < getRulesTabHeaders().size(); i++) {
                if (getRulesTabHeaders().get(i).getText().contains("Associated Rules")) {
                    headerAssociatedRules = getRulesTabHeaders().get(i).getText();
                } else if (getRulesTabHeaders().get(i).getText().contains(ruleName)) {
                    headerRule = getRulesTabHeaders().get(i).getText();
                }
            }
            Assert.assertEquals(headerAssociatedRules, "Associated Rules (1)");
            Assert.assertEquals(headerRule, ruleName);
            Map<String, String> baseline = new HashMap<>();
            baseline.put("Name", ruleName);
            baseline.put("Description", ruleDesc);
            baseline.put("Input Columns", inputCols);
            baseline.put("Output Columns", outputCols);

            Map<String, String> actual = new HashMap<>();
            for (int i = 0; i < 4; i++)
                actual.put(getRulesDetailsTabResultsLabel().get(i).getText(),
                        getRulesDetailsTabResultsData().get(i).getText().replace(", ", ","));
            System.out.println(baseline);
            System.out.println(actual);
            Assert.assertEquals(actual, baseline);
            getBackToSummary().click();
            funcWait(3000);
            selectParticularResultsCol(outputCols, tc_id);
            funcWait(3000);
            waitForElementToBeVisible(getBackToSummary());
            funcWait(2000);
            List<WebElement> detailsTabHeaders = getRowDetailsTabs();
            for (WebElement ele : detailsTabHeaders) {
                String tab = ele.getText();
                Assert.assertFalse(tab.contains("Rules"), "Rules tab is displayed which is not expected");
                break;
            }
            logger.info("Validate Details Tab Rule Details Completed successfully");
        } catch (Exception e) {
            setLogMessage(
                    "Profile result rule sub tab details validation failed with error " + e.getMessage().toString());
            logger.error("Profile result rule sub tab details validation failed");
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            System.out.println(e.toString());
            Assert.fail("Profile result rule sub tab details validation failed", e);
        }
        return new ProfileResultsPage(driver);
    }

    public ProfileResultsPage selectPredefinedFilterAsPatternOutlier(String tc_id) throws SQLException {
        try {
            logger.info("Select Predefined Filter As Value Frequency Outlier ");
            WebElement dropdownButton = driver.findElement(By.xpath(dropdownButtonForWith));
            dropdownButton.click();
            for (WebElement ele : getListOfOptionsInTheDropdown()) {
                if (ele.getText().equalsIgnoreCase("Pattern Outliers")) {
                    ele.click();
                    break;
                }
            }
            invisibilityOfElementLocated(By.cssSelector("div[class*='loader__message']"));
            logger.info("Select Predefined Filter As Value Frequency Outlier Done Successfully");
        } catch (Exception e) {
            setLogMessage("Select Predefined Filter As Value Frequency Outlier Failed with error....\n"
                    + e.getMessage().toString());
            logger.error("Select Predefined Filter As Value Frequency Outlier Failed....");
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            e.printStackTrace();
            Assert.fail("Select Predefined Filter As Value Frequency Outlier Failed....", e);
        }

        return this;
    }

    public void createProfileAndExecuteOutlier(String projectName, String folderName, String profileName,
                                               boolean isUnderProject, String connName, String source, String cols)
            throws InterruptedException, SQLException {
        exploreModuleApiUtils.deleteProject(projectName);
        exploreModuleApiUtils.createProject(projectName);
        exploreModuleApiUtils.createFolderUnder(projectName, folderName);
        if (cols.contains("ALL_COLS")) {
            exploreModuleApiUtils.createProfileUnderProjectOrFolderOutlier(projectName, folderName, profileName, false,
                    connName, source, cols);
        } else {
            exploreModuleApiUtils.createProfileUnderProjectOrFolderOutlier(projectName, folderName, profileName, false,
                    connName, source, cols);
        }
        exploreModuleApiUtils.waitForTheExecutionToComplete(
                exploreModuleApiUtils.getJobIdapiExecuteProfile(profileName), profileName);
    }

    public String getNoOfRulesInHeaderText() {
        WaitForObjectToVanish(".blockUI img");
        String text = "";
        text = getNoOfRulesInHeader().getText();
        return text;
    }

    public ProfileResultsPage clickOnResizingButtons(String tc_id, String option) throws SQLException {
        try {
            logger.info("Click on Resizing Buttons of Result page started");
            invisibilityOfElementOfGivenSelectorWithTimeout(30, "div[data-section='queries'] div[class*='loader__message']");
            switch (option.toUpperCase()) {
                case "MINIMIZE":
                    getDataPreviewMinimizeButton().click();
                    WaitForObjectToVanish(".blockUI img");
                    break;
                case "MAXIMIZE":
                    getDataPreviewMaximizeButton().click();
                    WaitForObjectToVanish(".blockUI img");
                    break;
                case "RESTORE":
                    getDataPreviewRestoreButton().click();
                    WaitForObjectToVanish(".blockUI img");
                    break;
            }
            logger.info("Click on Resizing Buttons of Result page ended successfully");
        } catch (Exception e) {
            logger.info("Click on Resizing Buttons of Result page failed with error....\n" + e.getMessage().toString());
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            e.printStackTrace();
            Assert.fail("Click on Resizing Buttons of Result page failed...", e);
        }
        return this;
    }

    public ProfileResultsPage selectNoOfItemsPerPage(String tc_id, String value) {
        try {
            logger.info("Started selecting no of items per page");
            driver.manage().timeouts().implicitlyWait(5, TimeUnit.SECONDS);
            WebElement e1 = driver.findElement(By.xpath(noOfItems));
            selectDropDownByValue(e1, value);
            logger.info("Selecting no of items per page completed successfully");
        } catch (Exception e) {
            logger.info("Selecting no of items per page is not visible. Hence, moving ahead");
        } finally {
            if (!(System.getProperty("exec.args").contains("QA") && !System.getProperty("exec.args").contains("DEV"))) {
                driver.manage().timeouts().implicitlyWait(300, TimeUnit.SECONDS);
            } else {
                driver.manage().timeouts().implicitlyWait(120, TimeUnit.SECONDS);
            }
        }

        return this;

    }

    public ArrayList<String> getCleanseOrRuleDetailsOnValueFrequencyPage(String tc_id) throws SQLException {
        ArrayList<String> actualDetails = new ArrayList<>();
        try {
            logger.info("Validate rule or cleanse input port name on value freq page started");
            waitForElementToBeVisible(getBackToSummary());
            actualDetails.add(columnDetail1OnValueFrequencyPage.getText());
            actualDetails.add(columnDetail2OnValueFrequencyPage.getText());
            actualDetails.add(columnDetail3OnValueFrequencyPage.getText());
            logger.info("Validate rule or cleanse input port name on value freq page completed successfully");
        } catch (Exception e) {
            logger.info("Validate rule or cleanse input port name on value freq page Failed....");
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            e.printStackTrace();
            Assert.fail("Validate rule or cleanse input port name on value freq page Failed....", e);
        }
        return actualDetails;
    }

    public void clickOnCleanseOrRuleAssetNameFromValueFrequencyPage(String tc_id) throws SQLException {
        try {
            logger.info("Clicking on cleanse or rule or verifier name from value frequency page started");
            waitForElementToBeVisible(getBackToSummary());
            getColumnDetail2OnValueFrequencyPage().click();
            logger.info("Clicking on cleanse or rule or verifier name from value frequency page completed successfully");
        } catch (Exception e) {
            logger.info("Clicking on cleanse or rule or verifier name from value frequency page Failed....");
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            e.printStackTrace();
            Assert.fail("Clicking on cleanse or rule or verifier name from value frequency page Failed....", e);
        }
    }

    public ProfileResultsPage clickOnGetBackToSummaryButton(String tc_id) throws SQLException {
        try {
            logger.info("Clicking on Get Back To Summary Button started");
            waitForElementToBeVisible(getBackToSummary());
            getBackToSummary().click();
            logger.info("Clicking on Get Back To Summary Button completed successfully");
        } catch (Exception e) {
            logger.info("Clicking on Get Back To Summary Button Failed....");
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            e.printStackTrace();
            Assert.fail("Clicking on Get Back To Summary Button Failed....", e);
        }
        return this;
    }

    public ProfileResultsPage clickOnRuleOrCleanseOrVerifierOutputPortNameOnProfileResultsPage(String tc_id, String columnName) throws SQLException {
        try {
            logger.info("Clicking on Rule or cleanse or verifier name from profile results page started");
            logger.info("Changing the view to only rules");
            WaitForObjectToVanish(".blockUI img");
            WebElement dropdownButton = driver.findElement(By.xpath(dropdownButtonForView));
            dropdownButton.click();
            for (WebElement ele : getListOfOptionsInTheDropdown()) {
                if (ele.getText().equalsIgnoreCase("Rules")) {
                    ele.click();
                    break;
                }
            }
            invisibilityOfElementLocated(By.cssSelector("div[class*='loader__message']"));
            clickOnResizingButtons(tc_id, "MINIMIZE");
            WaitForObjectToVanish(".blockUI img");
            System.out.println(columnName);
            WebElement ele = driver.findElement(By.xpath("//div[@data-grid-col-name='columnName' and @data-column-name='#COLUMNNAME#']//span".replace("#COLUMNNAME#", columnName)));
            ele.click();
            WaitForObjectToVanish(".blockUI img");
            getThreeDotsButtonOnResultsPage().click();
            WaitForObjectToVanish(".blockUI img");
            logger.info("Clicking on Rule or cleanse or verifier name from profile results page completed successfully");
        } catch (Exception e) {
            logger.info("Clicking on Rule or cleanse or verifier name from profile results page Failed....");
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            e.printStackTrace();
            Assert.fail("Clicking on Rule or cleanse or verifier name from profile results page Failed....", e);
        }

        return this;
    }

    public ProfileResultsPage clickOnRuleOrCleanseOrVerifierNameOnProfileResultsPage(String tc_id, String inputColumn, String ruleName) throws SQLException {
        try {
            logger.info("Clicking on Rule or cleanse or verifier name from profile results page started");
            logger.info("Changing the view to only rules");
            WebElement dropdownButton = driver.findElement(By.xpath(dropdownButtonForView));
            dropdownButton.click();
            for (WebElement ele : getListOfOptionsInTheDropdown()) {
                if (ele.getText().equalsIgnoreCase("Rules")) {
                    ele.click();
                    break;
                }
            }
            invisibilityOfElementLocated(By.cssSelector("div[class*='loader__message']"));
            clickOnResizingButtons(tc_id, "MINIMIZE");
            WaitForObjectToVanish(".blockUI img");
            System.out.println(inputColumn);
            System.out.println(ruleName);
            WebElement ele = driver.findElement(By.xpath("//span[text()='Input(s): #COLUMNNAME#']//preceding-sibling::span//a[text()='#RULEORCLEANSENAME#']"
                    .replace("#COLUMNNAME#", inputColumn).replace("#RULEORCLEANSENAME#", ruleName)));
            ele.click();
            WaitForObjectToVanish(".blockUI img");
            getThreeDotsButtonOnResultsPage().click();
            WaitForObjectToVanish(".blockUI img");
            logger.info("Clicking on Rule or cleanse or verifier name from profile results page completed successfully");
        } catch (Exception e) {
            logger.info("Clicking on Rule or cleanse or verifier name from profile results page Failed....");
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            e.printStackTrace();
            Assert.fail("Clicking on Rule or cleanse or verifier name from profile results page Failed....", e);
        }

        return this;
    }

    public void verifyValidationText(String tObject, String checkStatus) {

        boolean flag = false;
        WebElement element = null;

        try {
            WaitForObjectToVanish(".blockUI img");
            try {
                if (driver.findElement(By.xpath(tObject)).isDisplayed()) {
                    flag = true;
                }
            } catch (NoSuchElementException e) {
                flag = false;
            }

            if (flag && checkStatus.toUpperCase().equals("1")) {
                element = driver.findElement(By.xpath(tObject));
                highlightElement(element);

            }
            if (flag && checkStatus.toUpperCase().equals("0")) {

                element = driver.findElement(By.xpath(tObject));
                highlightElement(element);
                Assert.fail("ERROR - validation Text   " + tObject + "  displayed when it should not be present");

            }
            if (!flag && checkStatus.toUpperCase().equals("1")) {
                Assert.fail("ERROR- Validation Text  " + tObject + "   not present when it should be present");
            }
            if (!flag && checkStatus.toUpperCase().equals("0")) {

            }
            // funcWait(1000);

        } catch (Exception e) {
            e.printStackTrace();

            Assert.fail("ERROR", e);
        }
    }

    public String getToolTipContentOfRuleIconOnProfileResultsPage(String tc_id, String columnName) throws SQLException {
        String tooltipContent = "";
        try {
            logger.info("Get tooltip content of a rule/cleanse/verifier icon on profile results page started");
            WaitForObjectToVanish(".blockUI img");
            WebElement ele = driver.findElement(By.xpath("//div[@data-column-name='#COLUMNNAME#']/span[@class='icon']".replace("#COLUMNNAME#", columnName)));
            tooltipContent = ele.getAttribute("data-tooltip-content").replaceAll("\\s+", "").trim();
            logger.info("Get tooltip content of a rule/cleanse/verifier icon on profile results page completed successfully");
        } catch (Exception e) {
            logger.info("Get tooltip content of a rule/cleanse/verifier icon on profile results page Failed....");
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            e.printStackTrace();
            Assert.fail("Get tooltip content of a rule/cleanse/verifier icon on profile results page Failed....", e);
        }
        return tooltipContent;
    }

    public boolean validateIconTypeOnAColumnName(String tc_id, String columnName, String iconType) throws SQLException {
        boolean flag = false;
        try {
            logger.info("Validate icon type on a particular column started");
            WaitForObjectToVanish(".blockUI img");
            WaitForObjectToVanish(".blockUI img");
            WaitForObjectToVanish("div[class*='loader']");
            if (getDataPreviewMinimizeButton().isDisplayed()) {
                getDataPreviewMinimizeButton().click();
            }

            WaitForObjectToVanish(".blockUI img");
            String iconLink = "";
            switch (iconType.toUpperCase()) {
                case "RULE":
                    iconLink = driver.findElement(By.xpath(ruleIcon.replace("#COLUMNNAME#", columnName))).getAttribute("src");
                    if (iconLink.contains("rulebuilder/ruleAsset.svg")) {
                        flag = true;
                    }
                    break;
                case "CLEANSE":
                    iconLink = driver.findElement(By.xpath(ruleIcon.replace("#COLUMNNAME#", columnName))).getAttribute("src");
                    if (iconLink.contains("cleanse/cleanse_asset.svg")) {
                        flag = true;
                    }
                    break;
                case "VERIFIER":
                    iconLink = driver.findElement(By.xpath(ruleIcon.replace("#COLUMNNAME#", columnName))).getAttribute("src");
                    if (iconLink.contains("verifier/verifier_asset.svg")) {
                        flag = true;
                    }
                    break;
                default:
                    iconLink = driver.findElement(By.xpath(ruleIcon.replace("#COLUMNNAME#", columnName))).getAttribute("src");
                    if (iconLink.contains("data:image/svg+xml")) {
                        flag = true;
                    }
            }
            getThreeDotsButtonOnResultsPage().click();
            getDataPreviewRestoreButton().click();
            logger.info("Validate icon type on a particular column completed successfully");
        } catch (Exception e) {
            logger.info("Validate icon type on a particular column Failed....");
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            e.printStackTrace();
            Assert.fail("Validate icon type on a particular column Failed....", e);
        }
        return flag;
    }

    public void createProfile(String projectName, String folderName, String profileName,
                              boolean isUnderProject, String connName, String source, String cols) throws InterruptedException, SQLException {
        exploreModuleApiUtils.deleteProject(projectName);
        exploreModuleApiUtils.createProject(projectName);
        exploreModuleApiUtils.createFolderUnder(projectName, folderName);
        if (cols.contains("ALL_COLS")) {
            exploreModuleApiUtils.createProfileUnderProjectOrFolder(projectName, folderName, profileName, false,
                    connName, source, cols);
        } else {
            exploreModuleApiUtils.createProfileUnderProjectOrFolder(projectName, folderName, profileName, false,
                    connName, source, cols);
        }

    }

    public ProfileResultsPage clickOnAddField() {
        WaitForObjectToVanish(".blockUI img");
        performClickOn(getAddField());
        return new ProfileResultsPage(driver);
    }

    public ProfileResultsPage applyFilter(String FilterName, String FilterRange, String Filtervalue, String tc_id) {
        try {
            logger.info("Applying Filters started");
            WaitForObjectToVanish(".blockUI img");
            funcWait(1000);
            clickOnAddField();
            this.FilterByText(FilterName);
            if (FilterName.equalsIgnoreCase("Columns") || FilterName.equalsIgnoreCase("Maximum value")
                    || FilterName.equalsIgnoreCase("Minimum value")) {
                this.applyValue(Filtervalue, tc_id);
            } else {
                this.applyRangeAndvalue(FilterRange, Filtervalue, tc_id);
            }
            if (!tc_id.equals("ProfileResultsTest_profileResultsInvalidFilterConditionValidation")) {
                WaitForObjectToVanish(".blockUI img");
            }
            logger.info("Applying filters completed successfully");
        } catch (Exception e) {
            e.printStackTrace();
            logger.error("Applying filters failed");
            Assert.fail("Applying filters failed", e);
        }

        return new ProfileResultsPage(driver);
    }


    public ProfileResultsPage applyFilterInBetween(String FilterName, String FilterRange, String Filtervalue1,
                                                   String Filtervalue2) {
        try {
            logger.info("Applying Filters In Between started");
            WaitForObjectToVanish(".blockUI img");
            funcWait(1000);
            clickOnAddField();
            this.FilterByText(FilterName);
            this.applyRangeAndvalueInBetween(FilterRange, Filtervalue1, Filtervalue2);
            // performClickOn(getAddField());
            logger.info("Applying Filters In Between completed successfully");
        } catch (Exception e) {
            e.printStackTrace();
            logger.error("Applying filters In Between failed");
            Assert.fail("Applying filters In Between failed", e);
        }
        return new ProfileResultsPage(driver);
    }

    public void applyValue(String text, String tc_id) {
        logger.info("Applying value started");
        WebElement valueTextBox = driver.findElement(By.cssSelector("div[class*='bubble'] input[type='text']"));
        Actions action = new Actions(driver);
        action.moveToElement(valueTextBox).click().sendKeys(text).sendKeys(Keys.ENTER).pause(1000).build().perform();
        WaitForObjectToVanish(".blockUI img");
        if (!tc_id.contains("profileResultsStringFilter") && !text.equals("Binary")) {
            JavascriptExecutor js = (JavascriptExecutor) driver;
            js.executeScript("arguments[0].setAttribute('value', " + text + ");", valueTextBox);
        }
        driver.findElement(By.xpath("//span[@class='page-title']")).click();
        funcWait(2000);
        logger.info("Applying value completed successfully");
    }

    public void applyRangeAndvalue(String range, String value, String tc_id) {
        try {
            logger.info("Applying value and range started");
            if (!range.equals("")) {
                WebElement operatorDropdownButton = driver.findElement(By.cssSelector("div[class*='bubble--none'] button i[class*='dropdown']"));
                operatorDropdownButton.click();
                List<WebElement> l1 = driver.findElements(By.cssSelector("div[class*='dropdown__item'] span"));
                for (WebElement ele : l1) {
                    if (ele.getText().equals(range)) {
                        ele.click();
                        break;
                    }
                }
            }
            WebElement valueTextBox = driver.findElement(By.cssSelector("div[class*='bubble'] input[type='text']"));
            Actions action = new Actions(driver);
            action.moveToElement(valueTextBox).click().sendKeys(value).sendKeys(Keys.ENTER).pause(1000).build().perform();
            invisibilityOfElementOfGivenSelectorWithTimeout(15, "div[data-section='grid-results'] div[class*='loader__message']");
            if (!tc_id.equals("ProfileResultsTest_profileResultsInvalidFilterConditionValidation")) {
                JavascriptExecutor js = (JavascriptExecutor) driver;
                js.executeScript("arguments[0].setAttribute('value', " + value + ");", valueTextBox);
                WaitForObjectToVanish(".blockUI img");
                driver.findElement(By.xpath("//span[@class='page-title']")).click();
                funcWait(2000);
                WaitForObjectToVanish(".blockUI img");
            }
            logger.info("Applying value and range completed");
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    public void applyRangeAndvalueInBetween(String range, String value1, String value2) {
        try {
            logger.info("Applying value and range started");
            if (!range.equals("")) {
                WebElement operatorDropdownButton = driver.findElement(By.cssSelector("div[class*='bubble--none'] button i[class*='dropdown']"));
                operatorDropdownButton.click();
                List<WebElement> l1 = driver.findElements(By.cssSelector("div[class*='dropdown__item'] span"));
                for (WebElement ele : l1) {
                    if (ele.getText().equals(range)) {
                        ele.click();
                        break;
                    }
                }
            }
            WebElement valueTextBox = driver.findElement(By.xpath("(//div[contains(@class,'bubble')]//input[@type='text'])[1]"));
            Actions action = new Actions(driver);
            action.moveToElement(valueTextBox).click().sendKeys(value1).sendKeys(Keys.ENTER).pause(1000).build().perform();
            WebElement valueTextBox2 = driver.findElement(By.xpath("(//div[contains(@class,'bubble')]//input[@type='text'])[2]"));
            action.moveToElement(valueTextBox2).click().sendKeys(value2).sendKeys(Keys.ENTER).pause(1000).build().perform();
            invisibilityOfElementOfGivenSelectorWithTimeout(15, "div[data-section='grid-results'] div[class*='loader__message']");
            driver.findElement(By.xpath("//span[@class='page-title']")).click();
            funcWait(2000);
            invisibilityOfElementOfGivenSelectorWithTimeout(15, "div[data-section='grid-results'] div[class*='loader__message']");
            logger.info("Applying value and range completed");
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    public ProfileResultsPage createDrillDownBaselineAsMapAndValidateForNewCases(String baseLineLoc, String tc_id)
            throws SQLException {
        try {
            logger.info("Create drill down baseline text file as map and validation started");
            String baselinePath = System.getProperty("user.dir") + "/src/test/resources/BaselineTxtFiles/"
                    + System.getProperty("agentOS").toLowerCase() + "/" + System.getProperty("sourceType").toLowerCase()
                    + "/" + baseLineLoc;
            if (new File(baselinePath).exists()) {
                String baselineData = convertDrilldownBaseLineTextFileToMap(baselinePath);
                String actualData = drillDownDataUI.toString();
                Assert.assertEquals(baselineData, actualData, "Expected was:" + baselineData + "But Actual Was:" + actualData);
                logger.info("Create drilldown UI results as map completed successfully");
            } else {
                exploreModuleApiUtils.createNewBaseLine(drillDownDataUI.toString(), baselinePath);
                Assert.fail("Kindly verify the baseline created and re run the query to verify the results");
            }
            logger.info("Create drill down baseline text file as map and validation completed successfully");
        } catch (Exception e) {
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            e.printStackTrace();
            logger.error("Create drill down baseline text file as map and validation failed");
            Assert.fail("Create drill down baseline text file as map and validation failed", e);
        }
        return this;
    }

    private String convertDrilldownBaseLineTextFileToMap(String baseLineLoc) {
        String baselineText = "";
        try {
            logger.info("Create query baseline text file as String started");
            System.out.println("Creating query Base Line MAP");
            String filePath = baseLineLoc;
            baselineText = new String(Files.readAllBytes(Paths.get(filePath)));
            System.out.println("Baseline Data Is:" + baselineText);
            logger.info("Create query baseline text file as string completed");
        } catch (Exception e) {
            e.printStackTrace();
        }
        return baselineText;
    }

    public ProfileResultsPage validateValueFrequencyDataUsingMapForRules(String valueFrequencyData, String profiledCols,
                                                                         String tc_id) throws SQLException {
        Map<String, List<String>> expectedValueFreqdata = new HashMap<>();
        Map<String, List<String>> expectedValueFreqdataSorted = new HashMap<>();
        Map<String, List<String>> actualValueFreqdataSorted = new HashMap<>();
        Map<String, List<String>> actualValueFreqdata = new HashMap<>();
        String[] cols = profiledCols.split(";");
        String[] colsData = valueFrequencyData.split(";");

        if ((cols.length) == (colsData.length)) {
            for (int i = 0; i < cols.length; i++) {
                expectedValueFreqdata.put(cols[i], Arrays.asList(colsData[i].split("#")));
            }

            System.out.println("Expected data:" + expectedValueFreqdata);
            for (int i = 0; i < cols.length; i++) {
                List<String> actual = new ArrayList<String>();
                System.out.println("Clicking on Profiled Column:" + cols[i]);
                funcWait(2000);
                clickOnRuleOrCleanseOrVerifierOutputPortNameOnProfileResultsPage(tc_id, cols[i]);
                funcWait(2000);
                waitForElementToBeVisible(getBackToSummary());
                for (WebElement ele : getValueFrequencyData()) {
                    if (!ele.getText().equals("") && !ele.getText().equals(" ")) {
                        actual.add(ele.getText().trim());
                        Actions action = new Actions(driver);

                    }

                }
                actualValueFreqdata.put(cols[i].trim(), actual);
                performClickOn(getBackToSummary());
                waitForElementToBeVisible(getResultsPageHeader());
            }
            for (Map.Entry<String, List<String>> entry : expectedValueFreqdata.entrySet()) {
                Collections.sort(entry.getValue());
                expectedValueFreqdataSorted.put(entry.getKey(), entry.getValue());
            }
            for (Map.Entry<String, List<String>> entry : actualValueFreqdata.entrySet()) {
                Collections.sort(entry.getValue());
                actualValueFreqdataSorted.put(entry.getKey(), entry.getValue());
            }
            System.out.println("After sorting expected data:" + expectedValueFreqdataSorted);
            System.out.println("After sorting actual data:" + actualValueFreqdataSorted);

        }
        Assert.assertTrue(expectedValueFreqdataSorted.equals(actualValueFreqdataSorted));
        return new ProfileResultsPage(driver);
    }
    
	public String getlatestRunNumberOfProfile(){
        String runText = getProfileSelectedRunText();
        String latestRunNumber = runText.substring(runText.lastIndexOf("of"),runText.length()).replace("of ","").trim();
        return latestRunNumber;
    }
    
	public boolean validateToolTipMessage(String message) {
		boolean found = false;
		try {
			Actions act = new Actions(driver);
			act.moveToElement(getDocumentedDataTypeToolTip()).clickAndHold().build().perform();
			String UI_Message = getToolTipMessage().getText();
			System.out.println("Tooltip Message Is:"+UI_Message);
			if (UI_Message.equalsIgnoreCase(message)) {
				found = true;
			}
		} catch (Exception e) {
		}
		return found;
	}

    public ProfileResultsPage vaidateColorBarsForUniqueAndNonUniqueValues(String tc_id) throws SQLException {
		try {
			logger.info("Validating the color bars for unique and non unique values started");	
			invisibilityOfElementOfGivenSelectorWithTimeout(30, "div[class*='frequency-analysis-container'] div[class*='loader__message']");
			String colorValueForUnique=getUniqueColor().getCssValue("color");
			String colorValueForNonUnique=getNonUniqueColor().getCssValue("color");	
			String backroundUrlForUnique=getUniqueColor().getCssValue("background");
			String backroundUrlForNonUnique=getNonUniqueColor().getCssValue("background");
			Assert.assertTrue(colorValueForNonUnique.equals("rgba(0, 0, 0, 1)"), "Color Value for Non Unique Block Is Not As Expected");
			Assert.assertTrue(colorValueForUnique.equals("rgba(0, 0, 0, 1)"), "Color Value for Unique Block Is Not As Expected");
			
			Assert.assertTrue(backroundUrlForUnique.contains("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCIKCSB2aWV3Qm94PSIwIDAgMjAgMjAiIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDIwIDIwIiB4bWw6c3BhY2U9InByZXNlcnZlIj4KICAgICAgICA8cmVjdCB4PSIwIiB5PSIwIiB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHJ4PSI1IiBmaWxsPSIjMzlmIiAvPgo8L3N2Zz4K"), "Background Value for Non Unique Block Is Not As Expected");
			Assert.assertTrue(backroundUrlForNonUnique.contains("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcv"), "Background Value for Non Unique Block Is Not As Expected");
			logger.info("Validating the color bars for unique and non unique values  ended successfully");

		} catch (Exception e) {
			logger.error("Validating the color bars for unique and non unique values failed...");
			testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
			testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
			e.printStackTrace();
			Assert.fail("Validating the color bars for unique and non unique values Failed", e);
		}

		return new ProfileResultsPage(driver);
	}
    
    public ProfileResultsPage validateResultsGridForFoldersAndTheirRespsectiveNodesInAvroParquetProfiles(String tc_id, String folderName, String baselineFileNames,String detailsTabHeaders, String profileName, String runKey ) throws SQLException {
		try {
			logger.info("Validating the result grid for folders in avro parquet profiles started");	
			List<String> folderNamesToBeClicked=Arrays.asList(folderName.split(";"));
			List<String> baselineFileNamesPerColumnInsideFolder=Arrays.asList(baselineFileNames.split(";"));
			for(int i=0;i<folderNamesToBeClicked.size();i++) {
				for(WebElement ele:getFolderNamesInResultsGrid()) {
					if(ele.getText().equalsIgnoreCase(folderNamesToBeClicked.get(i))) {
						ele.click();
						break;
					}
				}
				validateResultsGridData(detailsTabHeaders, baselineFileNamesPerColumnInsideFolder.get(i), tc_id, profileName, runKey);
			}
			logger.info("Validating the result grid for folders in avro parquet profiles ended successfully");

		} catch (Exception e) {
			logger.error("Validating the result grid for folders in avro parquet profiles failed...");
			testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
			testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
			e.printStackTrace();
			Assert.fail("Validating the result grid for folders in avro parquet profiles Failed", e);
		}

		return new ProfileResultsPage(driver);
    }
    
    public ProfileResultsPage clickOnAnyFolderNameOnResultsGrid(String tc_id, String folderName) throws SQLException {
		try {
			logger.info("Clicking on any folder name in results grid started");	
			for(WebElement ele:getFolderNamesInResultsGrid()) {
				if(ele.getText().equalsIgnoreCase(folderName)) {
					ele.click();
					break;
				}
			}
			invisibilityOfElementOfGivenSelectorWithTimeout(15, "div[data-section='grid-results'] div[class*='loader__message']");
			logger.info("Clicking on any folder name in results grid ended successfully");
		} catch (Exception e) {
			logger.error("Clicking on any folder name in results grid failed...");
			testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
			testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
			e.printStackTrace();
			Assert.fail("Clicking on any folder name in results grid failed", e);
		}

		return new ProfileResultsPage(driver);
    }
    
    public ProfileResultsPage clickOnAllSegmentsOrAnyNodeButton(String tc_id, String nodeName) throws SQLException {
		try {
			logger.info("Clicking on All Segments or any node button on results page started");	
			WebElement ele=driver.findElement(By.xpath(allSegmentsOrParticularNodeButton.replace("#NODENAME#", nodeName)));
			ele.click();
			invisibilityOfElementOfGivenSelectorWithTimeout(15, "div[data-section='grid-results'] div[class*='loader__message']");
			logger.info("Clicking on All Segments or any node button on results page ended successfully");
		} catch (Exception e) {
			logger.error("Clicking on All Segments or any node button on results page failed...");
			testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
			testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
			e.printStackTrace();
			Assert.fail("Clicking on All Segments or any node button on results page failed", e);
		}

		return new ProfileResultsPage(driver);
    }
    
    public ProfileResultsPage clickOnTreePreviewerIconOnResultsPage(String tc_id) throws SQLException {
		try {
			logger.info("Clicking on Tree Previewer Icon on results page started");	
			invisibilityOfElementOfGivenSelectorWithTimeout(20, "div[data-section='grid-results'] div[class*='loader__message']");
			waitForElementToBeclickable(getTreePreviewer());			
			getTreePreviewer().click();
			logger.info("Clicking on Tree Previewer Icon on results page ended successfully");
		} catch (Exception e) {
			logger.error("Clicking on Tree Previewer Icon on results page failed...");
			testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
			testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
			e.printStackTrace();
			Assert.fail("Clicking on Tree Previewer Icon on results page failed", e);
		}

		return new ProfileResultsPage(driver);
    }
    
    public ProfileResultsPage clickOnNodeNameInTreePreviewer(String tc_id, String nodeName) throws SQLException {
		try {
			logger.info("Clicking on node name in tree previewer started");	
			waitForElementToBeclickable(getExpandIconInTreePreviewer());
			getExpandIconInTreePreviewer().click();
			waitForAllElementsToPresent("div[class*='tree__node'] span[class*='tree__node__name']");
			for(WebElement ele:getNodeNamesInTreePreviewer()) {
				if(ele.getText().equals(nodeName)) {
					funcWait(3000);
					ele.click();
					break;
				}
			}
			logger.info("Clicking on node name in tree previewer ended successfully");
		} catch (Exception e) {
			logger.error("Clicking on Tree Previewer Icon on results page failed...");
			testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
			testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
			e.printStackTrace();
			Assert.fail("Clicking on Tree Previewer Icon on results page failed", e);
		}

		return new ProfileResultsPage(driver);
    }
    
    public ProfileResultsPage clickOnViewButtonInTreePreviewer(String tc_id) throws SQLException {
		try {
			logger.info("Clicking on view button in tree previewer started");	
			waitForElementToBeclickable(getViewButtonOfTreePreviewer());
			getViewButtonOfTreePreviewer().click();
			invisibilityOfElementOfGivenSelectorWithTimeout(15, "div[data-section='grid-results'] div[class*='loader__message']");
			waitForResultPageToLoad(tc_id);
			logger.info("Clicking on view button in tree previewer ended successfully");
		} catch (Exception e) {
			logger.error("Clicking on view button in tree previewer failed...");
			testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
			testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
			e.printStackTrace();
			Assert.fail("Clicking on view button in tree previewer failed", e);
		}

		return new ProfileResultsPage(driver);
    }
    
    public ProfileResultsPage validateThePathSelectorText(String tc_id, String expectedText) throws SQLException {
    	List<String> actualPathSelectorText=new ArrayList<String>();
    	List<String> expectedPathSelectorText=Arrays.asList(expectedText.split(";"));
		try {
			logger.info("Validation of path selector text started");	
			waitForResultPageToLoad(tc_id);
			for(WebElement ele:driver.findElements(By.cssSelector("span[class='cp-path-selector'] a"))) {
				actualPathSelectorText.add(ele.getText());
			}
			actualPathSelectorText.add(driver.findElement(By.xpath("(//span[@class='cp-path-selector']//li[contains(@class,'breadcrumbs__breadcrumb')]//div)[1]")).getText());
			System.out.println("Actual Path Selector Text Is:"+actualPathSelectorText);
			System.out.println("Expected Path Selector Text Is:"+expectedPathSelectorText);
			Assert.assertEquals(actualPathSelectorText, expectedPathSelectorText);
			logger.info("Validation of path selector text ended successfully");
		} catch (Exception e) {
			logger.error("Validation of path selector text failed...");
			testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
			testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
			e.printStackTrace();
			Assert.fail("Validation of path selector text failed", e);
		}

		return new ProfileResultsPage(driver);
    }
    
    public ProfileResultsPage enterSegmentNameInTreePreviewerAndSelectTheSame(String tc_id, String segmentName) throws SQLException {
		try {
			logger.info("Entering Segment Name In Tree Previewer and started  selecting the same ");	
			waitForElementToBeclickable(getFindTextAreaInTreePreviewer());
			getFindTextAreaInTreePreviewer().sendKeys(segmentName);
			for(WebElement ele:getNodeNamesInTreePreviewer()) {
				if(ele.getText().equals(segmentName)) {
					ele.click();
					break;
				}
			}
			logger.info("Entering Segment Name In Tree Previewer ended successfully");
		} catch (Exception e) {
			logger.error("Entering Segment Name In Tree Previewer failed...");
			testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
			testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
			e.printStackTrace();
			Assert.fail("Entering Segment Name In Tree Previewer failed", e);
		}

		return new ProfileResultsPage(driver);
    }
    
    public List<String> validateTheOptionsListedForExportProfileResultsDialogBox(String tc_id) throws SQLException {
    	List<String> actualOptions= new ArrayList<String>();
		try {
			logger.info("Validation of options getting listed for export profile results dialog box started");	
			for(WebElement ele: getOptionsAvailableInExportProfileResultsDialogBox()) {
				actualOptions.add(ele.getText());
			}
			logger.info("Validation of options getting listed for export profile results dialog box ended successfully");
		} catch (Exception e) {
			logger.error("Validation of options getting listed for export profile results dialog box failed...");
			testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
			testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
			e.printStackTrace();
			Assert.fail("Validation of options getting listed for export profile results dialog box failed", e);
		}

		return actualOptions;
    }
    
    public ProfileResultsPage validateTheIconAgainstAllFolderNames(String tc_id, String folderNames) throws SQLException {
		try {
			logger.info("Validation of icon against all folders started");	
			List<String> folderNamesToBeValidated=Arrays.asList(folderNames.split(";"));
			for(int i=0;i<folderNamesToBeValidated.size();i++) {
				WebElement ele=driver.findElement(By.xpath("//span[text()='#FOLDERNAME#']//parent::a//img[contains(@src,'data:image/svg+xml')]".replace("#FOLDERNAME#", folderNamesToBeValidated.get(i))));
				highlightElement(ele);
			}
			logger.info("Validation of icon against all folders ended successfully");
		} catch (Exception e) {
			logger.error("Entering Segment Name In Tree Previewer failed...");
			testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
			testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
			e.printStackTrace();
			Assert.fail("Entering Segment Name In Tree Previewer failed", e);
		}

		return new ProfileResultsPage(driver);
    }
    
    public ProfileResultsPage clickOnExpandOrCollapseIconOfTreePreviewer(String tc_id, String option) throws SQLException {   	
		try {
			logger.info("Clicking on expand or collapse icons of tree previewer started");	
			switch(option.toUpperCase()){
			case "EXPAND":
				getExpandIconInTreePreviewer().click();
				break;
				
			case "COLLAPSE":
				getCollapseIconInTreePreviewer().click();
				break;
			}
			
			logger.info("Clicking on expand or collapse icons of tree previewer ended successfully");
		} catch (Exception e) {
			logger.error("Clicking on expand or collapse icons of tree previewer failed...");
			testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
			testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
			e.printStackTrace();
			Assert.fail("Clicking on expand or collapse icons of tree previewer failed", e);
		}
		return new ProfileResultsPage(driver);
    }
    
    public ProfileResultsPage validateTheExpandAndCollapseActions(String tc_id, String option) throws SQLException {   	
		try {
			logger.info("Clicking on expand or collapse icons of tree previewer started");	
			switch(option.toUpperCase()){
			case "EXPAND":
				for(WebElement ele: driver.findElements(By.cssSelector("preview-tree__node__switcher--expanded"))) {
					highlightElement(ele);
				}
				break;
				
			case "COLLAPSE":
				WebElement ele1=driver.findElement(By.cssSelector("i[class*='preview-tree__node__switcher--collapsed']"));
				highlightElement(ele1);
				break;
			}
			
			logger.info("Clicking on expand or collapse icons of tree previewer ended successfully");
		} catch (Exception e) {
			logger.error("Clicking on expand or collapse icons of tree previewer failed...");
			testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
			testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
			e.printStackTrace();
			Assert.fail("Clicking on expand or collapse icons of tree previewer failed", e);
		}
		return new ProfileResultsPage(driver);
    }
    
    public ProfileResultsPage clickOnAnySegmentNameInNavigationToolbar(String tc_id, String segmentName) throws SQLException {   	
		try {
			logger.info("Clicking on any segment name in navigation toolbar started");	
			for(WebElement ele:getListOfSegmentsInTheBreadcrumbs()) {
				if(ele.getText().equalsIgnoreCase(segmentName)) {
					ele.click();
					break;
				}
			}
			logger.info("Clicking on any segment name in navigation toolbar ended successfully");
		} catch (Exception e) {
			logger.error("Clicking on any segment name in navigation toolbar failed...");
			testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
			testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
			e.printStackTrace();
			Assert.fail("Clicking on any segment name in navigation toolbar failed", e);
		}

		return new ProfileResultsPage(driver);
    }
    
    public ProfileResultsPage validateNoDataToDisplayTextInResultsGrid(String tc_id) throws SQLException {   	
		try {
			logger.info("Validating no data to display text started");	
			highlightElement(getResultsGridNoDataToDisplay());
			logger.info("Validating no data to display text ended successfully");
		} catch (Exception e) {
			logger.error("Validating no data to display text failed...");
			testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
			testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
			e.printStackTrace();
			Assert.fail("Validating no data to display text failed", e);
		}

		return new ProfileResultsPage(driver);
    }
    
    public ProfileResultsPage clickOnBackButtonInNavigationToolbarForSegments(String tc_id) throws SQLException {   	
		try {
			logger.info("Clicking on back button in navigation toolbar started");	
			getBackButtonInNavigationToolbar().click();
			invisibilityOfElementOfGivenSelectorWithTimeout(15, "div[data-section='grid-results'] div[class*='loader__message']");
			logger.info("Clicking on back button in navigation toolbar ended successfully");
		} catch (Exception e) {
			logger.error("Clicking on back button in navigation toolbar failed...");
			testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
			testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
			e.printStackTrace();
			Assert.fail("Clicking on back button in navigation toolbar failed", e);
		}

		return new ProfileResultsPage(driver);
    }
    
    public ProfileResultsPage validateResultsGridDataSEUser(String detailsTabHeaders, String baselineFileName,
			String tc_id, String profileName, String runKey)
			throws InvocationTargetException, InterruptedException, SQLException {
		ProfileResultsPage profileResultPage = validateResultsGridDataSEUser(detailsTabHeaders, baselineFileName, tc_id,
				profileName, runKey, 10);
		return profileResultPage;
	}

	public boolean columnNotClickable(String string) {
		
		WebElement span = driver.findElement(By.cssSelector("div[data-grid-col-name='columnName'] span"));

		
		try 
		{
			return span.findElement(By.tagName("a")).isDisplayed();
		}
		catch (org.openqa.selenium.NoSuchElementException e)
		{
			return false;
		}
	}

	public boolean datatypeAndPatternCheckboxesEnabledOrNot(){
        boolean flag = true;
        if (getPatternsCheckboxes().size()==0&&getInferredDataTypesCheckboxes().size()==0){
            flag = false;
        }else{
            flag = true;
        }
        return flag;
    }
    public boolean valueFrequenciesCheckboxesEnabledOrNot(){
        boolean flag = true;
        if (getvalueFrequencyCheckboxes().size()==0){
            flag = false;
        }else{
            flag = true;
        }
        return flag;
    }
    
    public boolean checkWarningMessage() {
    	boolean flag = false;
    
    	warningMessage = driver.findElements(By.xpath("//span[@data-run-info='execution-warning']//img"));
    	if(warningMessage.isEmpty())
    			flag = false;
    	else
    		flag = true;
    	
		return flag;
    }
    
    public void clickOnViewButtonNearWarning(String tc_id) throws SQLException {
    	try {
    		
    		WebElement element = driver.findElement(By.xpath("//span[@data-run-info='execution-warning']//img"));
    		WebElement viewLink = driver.findElement(By.xpath("//span[text()='Job executed with warnings.']/..//a[text()='View']"));
    		logger.info("Trying to click View link next to Warning message");

    		Actions action = new Actions(driver);
    		action.moveToElement(element).click();
    		action.click(viewLink);
    		logger.info("Clicked the View link successfully");
            waitForLoad(driver);
            boolean flag = waitForElementBy(By.cssSelector("div[class='infaPanelTitle-name page-title jobsTitle']"));
        	if (flag == true) {
        		logger.info("clicking on View link has directed to My Jobs successfully");
        	}
        	else
        		Assert.fail("View link hasn't redirected to My Jobs page");
    	}
    	catch (Exception e) {
       	 logger.info("View link is not present in the page"
                    + e.getMessage().toString());
            logger.error("Couldnt click View link");
            testDbDetailUtilities.updateEndTimeForTestCase(tc_id);
            testDbDetailUtilities.updateStatusForTestCase(tc_id, ProfilingConstants.FAILED);
            e.printStackTrace();
            Assert.fail("Couldnt click the View link"+e.getMessage());
        }
    	
    }
    
    public ProfileResultsPage selectViewAsColumns() {
        funcWait(2000);
        invisibilityOfLoaderImageWithTimeoutInDialog(15);
        WebElement dropdownButton = driver.findElement(By.xpath(dropdownButtonForView));
        dropdownButton.click();
        for (WebElement ele : getListOfOptionsInTheDropdown()) {
            if (ele.getText().equalsIgnoreCase("Columns")) {
                ele.click();
                break;
            }
        }
        invisibilityOfLoaderImageWithTimeoutInDialog(15);
        return this;
    }
    
	public boolean validateColumnFreValue() {
		logger.info("Fetch column frequency pair value");
		boolean flag = true;
		if (getColumnFreqPair().size() == 2) {
			flag = true;
		} else {
			flag = false;
		}
		return flag;
	}

}